---
layout: page
title: 10. Message Authentication Codes
nav_order: 1100
---

<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome file</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="message-authentication-codes">10. Message Authentication Codes</h1>
<p>The challenge of CCA-secure encryption is dealing with ciphertexts that were generated by an adversary. Imagine there was a way to “certify” that a ciphertext was not adversarially generated — <em>i.e.,</em> it was generated by someone who knows the secret key. We could include such a certification in the ciphertext, and the Dec algorithm could raise an error if it asked to decrypt something with invalid certification.</p>
<p>What we are asking for is not to <strong>hide</strong> the ciphertext but to <strong>authenticate</strong> it: to ensure that it was generated by someone who knows the secret key. The tool for the job is called a <strong>message authentication code</strong>. One of the most important applications of a message authentication code is to transform a CPA-secure encryption scheme into a CCA-secure one.</p>
<p>As you read this chapter, keep in mind that privacy and authentication are indeed different properties. It is possible to have one or the other or indeed both simultaneously. But one does not imply the other, and it is crucial to think about them separately.</p>
<h2 id="definition">10.1 Definition</h2>
<p>A MAC is like a signature that can be added to a piece of data, which certifies that someone who knows the secret key attests to this particular data. In cryptography, the term “signature” means something specific, and slightly different than a MAC. Instead of calling the output of a MAC algorithm a signature, we call it a “tag” (or, confusingly, just “a MAC”).</p>
<p>Our security requirement for a MAC scheme is that only someone with the secret key can generate a valid tag. To check whether a tag is valid, you just recompute the tag for a given message and see whether it matches the claimed tag. This implies that both generating and verifying a MAC tag requires the secret key.</p>
<p><strong>Definition 10.1 (MAC scheme)</strong></p>
<p><em>A <strong>message authentication code (MAC) scheme</strong> for message space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi></mrow><annotation encoding="application/x-tex">\mathcal{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span></span></span></span></span> consists of the following algorithms:</em></p>
<ul>
<li>KeyGen: <em>samples a key.</em></li>
<li>MAC: <em>takes a key k and message <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>∈</mo><mi mathvariant="script">M</mi></mrow><annotation encoding="application/x-tex">m \in \mathcal{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span></span></span></span></span> as input, and outputs a <strong>tag</strong> t . The MAC algorithm is deterministic.</em></li>
</ul>
<h3 id="how-to-think-about-authenticity-properties">How to Think About Authenticity Properties</h3>
<p>Every security definition we’ve seen so far is about hiding information, so how do we make a formal definition about authenticity?</p>
<p>Before we see the security definition for MACs, let’s start with a much simpler (potentially obvious?) statement: “an adversary should not be able to guess a uniformly chosen <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>-bit value.” We can formalize this idea with the following two libraries:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mtext>left</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>r</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="2em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mtext>right</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mtext mathvariant="monospace">fasle</mtext></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\qquad\mathcal{L}_{\text{left}} \\ \hline
r \leftarrow \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\lambda} \\
\underline{\text{GUESS}(g):} \\
\quad \text{return } g \overset{?}{=} r \\ \hline
\end{array}
\qquad
\begin{array}{|l|} \hline
\qquad\mathcal{L}_{\text{right}} \\ \hline
\underline{\text{GUESS}(g):} \\
\quad \text{return } \texttt{fasle} \\ \hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">left</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.99em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 4.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">right</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord text"><span class="mord texttt">fasle</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -6.1em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>The left library allows the calling program to attempt to guess a uniformly chosen “target” string. The right library doesn’t even bother to verify the calling program’s guess — in fact it doesn’t even bother to sample a random target string!</p>
<p>The GUESS subroutines of these libraries give the same output on nearly all inputs. There is only one input <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span></span></span> on which they disagree. If a calling program can manage to find the value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span></span></span>, then it can easily distinguish the libraries. Therefore, by saying that these libraries are indistinguishable, we are really saying that <strong>it’s hard for an adversary to find/generate this special value!</strong> That’s the kind of property we want to express.</p>
<p>Indeed, in this case, an adversary who makes <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span> queries to the GUESS subroutine achieves an advantage of at most <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">q/2^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span>. For polynomial-time adversaries, this is a negligible advantage (since <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span> is a polynomial function of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>).</p>
<p>More generally, suppose we have two libraries, and a subroutine in one library checks some condition (and could return either <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">true</mtext></mrow><annotation encoding="application/x-tex">\texttt{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.55358em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">true</span></span></span></span></span></span> or <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">false</mtext></mrow><annotation encoding="application/x-tex">\texttt{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">false</span></span></span></span></span></span>), while in the other library this subroutine always returns <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">false</mtext></mrow><annotation encoding="application/x-tex">\texttt{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">false</span></span></span></span></span></span>. If the two libraries are indistinguishable, the calling program can’t tell whether the library is actually checking the condition or always saying <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">false</mtext></mrow><annotation encoding="application/x-tex">\texttt{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">false</span></span></span></span></span></span>. This means it must be very hard to find an input for which the “correct” answer is <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">true</mtext></mrow><annotation encoding="application/x-tex">\texttt{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.55358em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">true</span></span></span></span></span></span>.</p>
<h3 id="the-mac-security-definition">The MAC Security Definition</h3>
<p>We want to say that only someone who knows the secret key can come up with valid MAC tags. In other words, the adversary cannot come up with valid MAC tags.</p>
<p>Actually, that property is not quite enough to be useful. A more useful property is: <em>even if the adversary knows valid MAC tags</em> corresponding to various messages, she cannot produce a valid MAC tag for a <em>different</em> message. We call it a <strong>forgery</strong> if the adversary can produce a “new” valid MAC tag.</p>
<p>To translate this security property to a formal definition, we define two libraries that allow the adversary to request MAC tags on chosen messages. The libraries also provide a mechanism to let the adversary <em>check</em> whether it has successfully found a forgery (since there is no way of checking this property without the secret key). One library will actually perform the check, and the other library will simply assume that forgeries are impossible.<br>
The two libraries are different only in how they behave when the adversary calls this verification subroutine on a forgery. By demanding that the two libraries be indistinguishable, we are actually demanding that it is difficult for the calling program to generate a forgery.</p>
<p><strong>Definition 10.2 (MAC security)</strong></p>
<p><em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Σ</span></span></span></span></span> be a MAC scheme. We say that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Σ</span></span></span></span></span> is a</em> <strong>secure MAC</strong> <em>if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>mac-real</mtext><mi mathvariant="normal">Σ</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>mac-fake</mtext><mi mathvariant="normal">Σ</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}^{\Sigma}_{\text{mac-real}} \approx \mathcal{L}^{\Sigma}_{\text{mac-fake}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Σ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Σ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, where:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>mac-real</mtext><mi mathvariant="normal">Σ</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>∈</mo><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>∈</mo><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="2em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>mac-fake</mtext><mi mathvariant="normal">Σ</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>∈</mo><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="script">T</mi><mtext>&nbsp;</mtext><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>∈</mo><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>∈</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi mathvariant="script">T</mi></mstyle><mtext>&nbsp;</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\qquad\qquad\mathcal{L}^{\Sigma}_{\text{mac-real}} \\ \hline
k \leftarrow \Sigma.\text{KeyGen} \\
\underline{\text{GETTAG}(m \in \Sigma.\mathcal{M}):} \\
\quad \text{return } \Sigma.\text{MAC}(k,m) \\ 
\underline{\text{CHECKTAG}(m \in \Sigma.\mathcal{M},t):} \\
\quad \text{return } t \overset{?}{=} \Sigma.\text{MAC}(k,m) \\ \hline
\end{array}
\qquad
\begin{array}{|l|} \hline
\qquad\qquad\mathcal{L}^{\Sigma}_{\text{mac-fake}} \\ \hline
k \leftarrow \Sigma.\text{KeyGen} \\
\colorbox{Yellow}{$\mathcal{T} := \empty$} \\
\underline{\text{GETTAG}(m \in \Sigma.\mathcal{M}):} \\
\quad t := \Sigma.\text{MAC}(k,m) \\ 
\quad \colorbox{Yellow}{$\mathcal{T} :=  \mathcal{T} \ \cup \{(m,t)\}$}    \\
\quad \text{return } t \\
\underline{\text{CHECKTAG}(m \in \Sigma.\mathcal{M},t):} \\
\quad \text{return } \colorbox{Yellow}{$(m,t) \overset{?}{\in}\mathcal{T} $ }\\ \hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 16.6252em; vertical-align: -8.0426em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.69em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Σ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Σ.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Σ.</span><span class="mord mathcal">M</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord">Σ.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Σ.</span><span class="mord mathcal">M</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Σ.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.5826em;"><span class="" style="top: -10.5426em;"><span class="pstrut" style="height: 10.5426em;"></span><span class="mtable"><span class="vertical-separator" style="height: 16.5852em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.0426em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.5426em;"><span class="" style="top: -10.9078em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Σ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -9.10781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Σ.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -7.30781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.40556em;"></span><span class="stretchy colorbox" style="height: 1.40556em; background-color: yellow;"></span></span><span class="" style="top: -3.40556em;"><span class="pstrut" style="height: 3.40556em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35556em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.50781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Σ.</span><span class="mord mathcal">M</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.70781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Σ.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -1.90781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace">&nbsp;</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.097812em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal">t</span></span></span><span class="" style="top: 1.70219em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Σ.</span><span class="mord mathcal">M</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 3.8674em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.62521em;"><span class="" style="top: -3.62521em;"><span class="pstrut" style="height: 4.17521em;"></span><span class="stretchy colorbox" style="height: 2.17521em; background-color: yellow;"></span></span><span class="" style="top: -4.17521em;"><span class="pstrut" style="height: 4.17521em;"></span><span class="mord boxpad"><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32521em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">∈</span></span></span><span class="" style="top: -3.7391em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.0391em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mord">&nbsp;</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.0426em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 16.5852em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.0426em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 10.5426em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -17.2852em;"><span class="pstrut" style="height: 10.5426em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -19.0852em;"><span class="pstrut" style="height: 10.5426em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.0426em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Discussion:</p>
<ul>
<li>
<p>The adversary can see valid tags of chosen messages, from the GETTAG subroutine. However, these tags shouldn’t count as a successful forgery. The way this is enforced is in the CHECKTAG subroutine of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>mac-fake</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{mac-fake}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> — instead of always responding <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">false</mtext></mrow><annotation encoding="application/x-tex">\texttt{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">false</span></span></span></span></span></span>, it gives the correct answer (<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">true</mtext></mrow><annotation encoding="application/x-tex">\texttt{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.55358em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">true</span></span></span></span></span></span>) for any tags generated by GETTAG.</p>
<p>In order for the two libraries to behave differently, the adversary must call CHECKTAG on input <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m, t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> such that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">m</span></span></span></span></span> was never used as an argument to GETTAG (so that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>mac-fake</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{mac-fake}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> responds <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">false</mtext></mrow><annotation encoding="application/x-tex">\texttt{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">false</span></span></span></span></span></span>) but where the tag is actually correct (so that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>mac-real</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{mac-real}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> responds <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">true</mtext></mrow><annotation encoding="application/x-tex">\texttt{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.55358em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">true</span></span></span></span></span></span>).</p>
</li>
<li>
<p>The adversary can successfully distinguish if it finds <em>any</em> forgery — a valid MAC tag of <em>any</em> “fresh” message. The definition doesn’t care whether it’s the tag of any particular <em>meaningful</em> message.</p>
</li>
</ul>
<h3 id="mac-applications">MAC Applications</h3>
<p>Although MACs are less embedded in public awareness than encryption, they are extremely useful. A frequent application of MACs is to store some information in an untrusted place, where we don’t intend to <em>hide</em> the data, only ensure that the data is not changed.</p>
<ul>
<li>A <strong>browser cookie</strong> is a small piece of data that a webserver stores in a user’s web browser. The browser presents the cookie data to the server upon each request.<br>
Imagine a webserver that stores a cookie when a user logs in, containing that user’s account name. What stops an attacker from modifying their cookie to contain a different user’s account name? Adding a MAC tag of the cookie data (using a key known only to the server) ensures that such an attack will not succeed. The server can trust any cookie data whose MAC tag is correct.</li>
<li>When Alice initiates a network connection to Bob, they must perform a <strong>TCP handshake:</strong></li>
</ul>
<ol>
<li>Alice sends a special SYN packet containing her initial sequence number <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">A</span></span></span></span></span>. In TCP, all packets from Alice to Bob include a sequence number, which helps the parties detect when packets are missing or out of order. It is important that the initial sequence number be random, to prevent other parties from injecting false packets.</li>
<li>Bob sends a special SYN+ACK packet containing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">A+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> (to acknowledge Alice’s <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">A</span></span></span></span></span> value) and the initial sequence number <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span></span></span></span></span> for his packets.</li>
<li>Alice sends a special ACK packet containing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">B + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>, and then the connection is established.</li>
</ol>
<p>When Bob is waiting for step 3, the connection is considered “half-open.” While waiting, Bob must remember <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span></span></span></span></span> so that he can compare to the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">B + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> that Alice is supposed to send in her final ACK. Typically the operating system allocates only a very limited amount of resources for these half-open connections.</p>
<p>In the past, it was possible to perform a denial of service attack by starting a huge number of TCP connections with a server, but never sending the final ACK packet. The server’s queue for half-open connections fills up, which prevents other legitimate connections from starting.</p>
<p>A clever backwards-compatible solution to this problem is called <strong>SYN cookies</strong>. The idea is to let Bob choose his initial sequence number <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05017em;">B</span></span></span></span></span> to be a MAC of the client’s IP address, port number, and some other values. Now there is nothing to store for half-open connections. When Alice sends the final ACK of the handshake, Bob can recompute the initial sequence number from his MAC key.</p>
<p>These are all cases where the person who <em>generates</em> the MAC is the same person who later <em>verifies</em> the MAC. You can think of this person as choosing not to store some information, but rather leaving the information with someone else as a “note to self.”</p>
<p>There are other useful settings where one party generates a MAC while the other verifies.</p>
<ul>
<li>
<p>In <strong>two-factor authentication</strong>, a user logs into a service using <em>something they know (e.g.,</em> a password) and <em>something they have (e.g.,</em> a mobile phone). The most common two-factor authentication mechanism is called <em>timed one-time passwords (TOTP).</em> When you (as a user) enable two-factor authentication, you generate a secret key <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> and store it both on your phone and with the service provider. When you wish to log in, you open a simple app on your phone which computes <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">p =</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span></span></span> MAC<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k,T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mclose">)</span></span></span></span></span>, where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> is the current date <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>+</mo></mrow><annotation encoding="application/x-tex">+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">+</span></span></span></span></span> time (usually rounded to the nearest 30 seconds). The value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span></span> is the “timed one-time password.” You then log into the service using your usual (long-term) password and the one-time password <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span></span>. The service provider has <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> and also knows the current time, so can verify the MAC <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span></span>.</p>
<p>From the service provider’s point of view, the only other place <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> exists is in the phone of this particular user. Intuitively, the only way to generate a valid one-time password at time <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> is to be in posession of this phone at time <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> . Even if an attacker sees both your long-term and one-time password over your shoulder, this does not help him gain access to your account in the future (well, not after 30 seconds in the future).</p>
</li>
</ul>
<h2 id="star-10.2-a-prf-is-a-mac"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋆</mo></mrow><annotation encoding="application/x-tex">\star</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord">⋆</span></span></span></span></span> 10.2 A PRF is a MAC</h2>
<p>The definition of a PRF says (more or less) that even if you’ve seen the output of the PRF on several chosen inputs, all other outputs look independently &amp; uniformly random. Furthermore, uniformly chosen values are hard to guess, as long as they are sufficiently long (e.g., <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> bits).</p>
<p>In other words, after seeing some outputs of a PRF, any other PRF output will be hard to guess. This is exactly the intuitive property we require from a MAC. And indeed, we will prove in this section that a PRF is a secure MAC. While the claim makes intuitive sense, proving it formally is a little tedious. This is due to the fact that that in the MAC security game, the adversary can make many verification queries CHECKTAG<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m, t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> <em>before</em> asking to see the correct MAC of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">m</span></span></span></span></span>. Dealing with this event is the source of all the technical difficulty in the proof.</p>
<p>We start with a technical claim that captures the idea that “if you can blindly guess at uniformly chosen values and can also ask to see the values, then it is hard to guess a random value before you have seen it.”</p>
<p><strong>Claim 10.3</strong><br>
<em>The following two libraries are indistinguishable:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mtext>guess-L</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>i</mi><mi>n</mi></mrow></msup><mo separator="true">,</mo><mi>g</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>i</mi><mi>n</mi></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="2em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mtext>guess-R</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>i</mi><mi>n</mi></mrow></msup><mo separator="true">,</mo><mi>g</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mtext>&nbsp;</mtext><mrow><mtext mathvariant="italic">returns</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">false</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">if</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">T</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">[</mo></mstyle><mtext mathvariant="italic">m</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">]</mo></mstyle><mtext>&nbsp;</mtext><mtext mathvariant="italic">undefined</mtext></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>i</mi><mi>n</mi></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\qquad\qquad\qquad\mathcal{L}_{\text{guess-L}} \\ \hline
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m \in \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{in}, g \in \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} ):} \\
\quad \text{if } T[m] \text{ undefined:} \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\quad \text{return } g \overset{?}{=} T[m] \\
\underline{\text{REVEAL}(m \in \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{in}):} \\
\quad \text{if } T[m] \text{ undefined:} \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\quad \text{return }  T[m] \\ \hline
\end{array}
\qquad
\begin{array}{|l|} \hline
\qquad\qquad\qquad\mathcal{L}_{\text{guess-R}} \\ \hline
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m \in \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{in}, g \in \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} ):} \\
//\ \textit{returns false if T$[$m$]$ undefined} \\ \\
\quad \text{return } g \overset{?}{=} T[m] \\
\underline{\text{REVEAL}(m \in \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{in}):} \\
\quad \text{if } T[m] \text{ undefined:} \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\quad \text{return }  T[m] \\ \hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 18.04em; vertical-align: -8.75em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.29em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 11.25em;"></span><span class="mtable"><span class="vertical-separator" style="height: 18em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.75em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined:</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined:</span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 18em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.75em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -18.7em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -20.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.29em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 11.25em;"></span><span class="mtable"><span class="vertical-separator" style="height: 18em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.75em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord">//</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord textit">returns&nbsp;false&nbsp;if&nbsp;T</span><span class="mopen">[</span><span class="mord textit">m</span><span class="mclose">]</span><span class="mord textit">&nbsp;undefined</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined:</span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 18em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.75em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -18.7em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -20.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Both libraries maintain an associative array <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> whose values are sampled uniformly the first time they are needed. Calling programs can try to guess these values via the GUESS subroutine, or simply learn them via REVEAL. Note that the calling program can call GUESS<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m, \cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> both <em>before and after</em> calling REVEAL<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>.</p>
<p>Intuitively, since the values in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> are <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> bits long, it should be hard to guess <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> before calling REVEAL<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>. That is exactly what we formalize in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-R</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{guess-R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. In fact, this library doesn’t bother to even choose <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> until REVEAL<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span> is called. All calls to GUESS<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m, \cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> made before the first call to REVEAL<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span> will return <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="monospace">false</mtext></mrow><annotation encoding="application/x-tex">\texttt{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord text"><span class="mord texttt">false</span></span></span></span></span></span>.</p>
<p><strong>Proof</strong><br>
Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span> be the number of queries that the calling program makes to GUESS. We will show that the libraries are indistinguishable with a hybrid sequence of the form:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-L</mtext></msub><mo>≡</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mn>0</mn></mrow></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mn>1</mn></mrow></msub><mo>≈</mo><mo>⋯</mo><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mi>q</mi></mrow></msub><mo>≡</mo><msub><mi mathvariant="script">L</mi><mtext>guess-R</mtext></msub></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text {guess-L}} \equiv \mathcal{L}_{\text {hyb-} 0} \approx \mathcal{L}_{\text {hyb-} 1} \approx \cdots \approx \mathcal{L}_{\text {hyb-} q} \equiv \mathcal{L}_{\text {guess-R}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.48312em; vertical-align: 0em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></p>
<p>The <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">h</span></span></span></span></span>th hybrid library in the sequence is defined as:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mrow><mtext>hyp-</mtext><mi>h</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined&nbsp;and&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&gt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Lightgray"><mstyle scriptlevel="0" displaystyle="false"><mi>h</mi></mstyle></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mtext>&nbsp;</mtext><mrow><mtext mathvariant="italic">returns</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">false</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">if</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">T</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">[</mo></mstyle><mtext mathvariant="italic">m</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">]</mo></mstyle><mtext>&nbsp;</mtext><mtext mathvariant="italic">undefined</mtext></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\qquad\qquad\qquad\mathcal{L}_{\text{hyp-}h} \\ \hline
count := 0 \\
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m , g):} \\
\quad count := count + 1 \\
\quad \text{if } T[m] \text{ undefined and } count &gt; \colorbox{Lightgray}{$h$} : \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\quad \text{return } g \overset{?}{=} T[m] \\
\quad //\ \textit{returns\ false\ if\ T$[$m$]$\ undefined} \\
\underline{\text{REVEAL}(m):} \\
\quad \text{if } T[m] \text{ undefined:} \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\quad \text{return }  T[m] \\ \hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 23.44em; vertical-align: -11.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.99em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 13.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 23.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -11.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.95em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyp-</span></span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined&nbsp;and&nbsp;</span></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: lightgray;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord">//</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord textit">returns&nbsp;false&nbsp;if&nbsp;T</span><span class="mopen">[</span><span class="mord textit">m</span><span class="mclose">]</span><span class="mord textit">&nbsp;undefined</span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined:</span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 23.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -11.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -24.1em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -25.9em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>This hybrid library behaves like <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-R&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {guess-R }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for the first <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">h</span></span></span></span></span> queries to GUESS, in the sense that it will always just return false when <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> is undefined. After <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">h</span></span></span></span></span> queries, it will behave like <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-L&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {guess-L }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-L&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> by actually sampling <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> in these cases.</p>
<p>In <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb-} 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, the clause "<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&gt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="lightgrey"><mtext>0</mtext></mpadded></mrow><annotation encoding="application/x-tex">count &gt; \colorbox{lightgrey}0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65418em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.24444em; vertical-align: -0.3em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94444em;"><span class="" style="top: -2.94444em;"><span class="pstrut" style="height: 3.24444em;"></span><span class="stretchy colorbox" style="height: 1.24444em; background-color: lightgrey;"></span></span><span class="" style="top: -3.24444em;"><span class="pstrut" style="height: 3.24444em;"></span><span class="mord boxpad"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span></span></span> " is always true so this clause can be removed from the if-condition. This modification results in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-L&nbsp;</mtext></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {guess-L }},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-L&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> so we have <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-L</mtext></msub><mo>≡</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {guess-L}} \equiv \mathcal{L}_{\text {hyb-} 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p>
<p>In <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb-} q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, the clause "<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&gt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="lightgrey"><mtext mathvariant="italic">q</mtext></mpadded></mrow><annotation encoding="application/x-tex">count &gt;\colorbox{lightgrey}{\textit{q}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65418em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.225em; vertical-align: -0.49444em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.73056em;"><span class="" style="top: -2.73056em;"><span class="pstrut" style="height: 3.225em;"></span><span class="stretchy colorbox" style="height: 1.225em; background-color: lightgrey;"></span></span><span class="" style="top: -3.225em;"><span class="pstrut" style="height: 3.225em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.49444em;"><span class=""></span></span></span></span></span></span></span></span></span> "in the if-statement is always false since the calling program makes only <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span> queries. Removing the unreachable if-statement it results in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-R&nbsp;</mtext></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {guess-R }},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> so we have <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-R</mtext></msub><mo>≡</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {guess-R}} \equiv \mathcal{L}_{\text {hyb- } q}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>It remains to show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>h</mi></mrow></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- } h} \approx \mathcal{L}_{\text {hyb- }(h+1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for all <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">h</span></span></span></span></span>. We can do so by rewriting these two libraries as follows:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mrow><mtext>hyp-</mtext><mi>h</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined&nbsp;and&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&gt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="lightgrey"><mrow><mstyle scriptlevel="0" displaystyle="false"><mi>h</mi></mstyle><mtext>&nbsp;</mtext></mrow></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>if&nbsp;</mtext><mrow><mtext mathvariant="italic">g</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">=</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">T</mtext></mrow><mtext>[m]&nbsp;and&nbsp;</mtext><mrow><mtext mathvariant="italic">count</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">=</mtext><mtext>&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Lightgrey"><mtext mathvariant="italic">h</mtext></mpadded></mrow><mtext>&nbsp;+&nbsp;1:</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mtext>bad&nbsp;:=&nbsp;1</mtext></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mtext>&nbsp;</mtext><mrow><mtext mathvariant="italic">returns</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">false</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">if</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">T</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">[</mo></mstyle><mtext mathvariant="italic">m</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">]</mo></mstyle><mtext>&nbsp;</mtext><mtext mathvariant="italic">undefined</mtext></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="2em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mrow><mtext>hyp-</mtext><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined&nbsp;and&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&gt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="lightgrey"><mstyle scriptlevel="0" displaystyle="false"><mi>h</mi></mstyle></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>if&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>g</mi><mo>=</mo><mi>T</mi></mstyle><mtext>[m]&nbsp;and&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="lightgrey"><mstyle scriptlevel="0" displaystyle="false"><mi>h</mi></mstyle></mpadded></mstyle><mtext>&nbsp;+&nbsp;1:&nbsp;</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext>bad</mtext><mo>:</mo><mo>=</mo><mn>1</mn><mo separator="true">;</mo><mtext>&nbsp;return&nbsp;</mtext><mtext mathvariant="monospace">false</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mtext>&nbsp;</mtext><mrow><mtext mathvariant="italic">returns</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">false</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">if</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">T[m]</mtext><mtext>&nbsp;</mtext><mtext mathvariant="italic">undefined</mtext><mtext>&nbsp;</mtext></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\qquad\qquad\qquad\mathcal{L}_{\text{hyp-}h} \\ \hline
count := 0 \\
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m , g):} \\
\quad count := count + 1 \\
\quad \text{if } T[m] \text{ undefined and } count &gt; \colorbox{lightgrey}{$h$
} : \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\qquad \colorbox{Yellow} {if \textit{g = T}[m] and \textit{count = \colorbox{Lightgrey}h} + 1:} \\
\qquad\quad \colorbox{Yellow}{\text{bad} := 1} \\
\quad \text{return } g \overset{?}{=} T[m] \\
\quad //\ \textit{returns\ false\ if\ T$[$m$]$\ undefined} \\
\underline{\text{REVEAL}(m):} \\
\quad \text{if } T[m] \text{ undefined:} \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\quad \text{return }  T[m] \\ \hline
\end{array}
\qquad
\begin{array}{|l|} \hline
\qquad\qquad\qquad\mathcal{L}_{\text{hyp-}(h+1)} \\ \hline
count := 0 \\
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m , g):} \\
\quad count := count + 1 \\
\quad \text{if } T[m] \text{ undefined and } count &gt; \colorbox{lightgrey}{$h$} : \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\qquad  \colorbox{Yellow}{if  $g = T$[m] and $count = \colorbox{lightgrey}{$h$}$ + 1: }\\
\qquad\quad \text{bad} := 1; \text{ return } \texttt{false} \\
\quad \text{return } g \overset{?}{=} T[m] \\
\quad //\ \textit{returns\ false\ if\ T[m]\ undefined }\\
\underline{\text{REVEAL}(m):} \\
\quad \text{if } T[m] \text{ undefined:} \\ 
\qquad T[m] \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \\
\quad \text{return }  T[m] \\ \hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 27.1344em; vertical-align: -13.2972em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.8372em;"><span class="" style="top: -15.7972em;"><span class="pstrut" style="height: 15.7972em;"></span><span class="mtable"><span class="vertical-separator" style="height: 27.0944em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -13.2972em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.7972em;"><span class="" style="top: -15.8317em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyp-</span></span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -14.0317em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -12.2317em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -10.4317em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -8.63166em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -6.83166em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined&nbsp;and&nbsp;</span></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: lightgrey;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal">h</span><span class="mord">&nbsp;</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -5.03166em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.19722em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.29444em;"><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.89444em;"></span><span class="stretchy colorbox" style="height: 1.89444em; background-color: yellow;"></span></span><span class="" style="top: -3.89444em;"><span class="pstrut" style="height: 3.89444em;"></span><span class="mord boxpad"><span class="mord">if&nbsp;</span><span class="mord text"><span class="mord textit">g&nbsp;=&nbsp;T</span></span><span class="mord">[m]&nbsp;and&nbsp;</span><span class="mord text"><span class="mord textit">count&nbsp;=&nbsp;</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: lightgrey;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord textit">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;+&nbsp;1:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.6em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.33722em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord">bad</span></span><span class="mord">&nbsp;:=&nbsp;1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 0.46278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: 2.26278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord">//</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord textit">returns&nbsp;false&nbsp;if&nbsp;T</span><span class="mopen">[</span><span class="mord textit">m</span><span class="mclose">]</span><span class="mord textit">&nbsp;undefined</span></span></span></span><span class="" style="top: 4.06278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 5.86278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined:</span></span></span></span><span class="" style="top: 7.66278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 9.46278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 13.2972em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 27.0944em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -13.2972em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 15.7972em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -27.7944em;"><span class="pstrut" style="height: 15.7972em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -29.5944em;"><span class="pstrut" style="height: 15.7972em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 13.2972em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.8372em;"><span class="" style="top: -15.7972em;"><span class="pstrut" style="height: 15.7972em;"></span><span class="mtable"><span class="vertical-separator" style="height: 27.0944em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -13.2972em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.7972em;"><span class="" style="top: -15.8317em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyp-</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -14.0317em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -12.2317em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -10.4317em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -8.63166em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -6.83166em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined&nbsp;and&nbsp;</span></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: lightgrey;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -5.03166em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.19722em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.29444em;"><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.89444em;"></span><span class="stretchy colorbox" style="height: 1.89444em; background-color: yellow;"></span></span><span class="" style="top: -3.89444em;"><span class="pstrut" style="height: 3.89444em;"></span><span class="mord boxpad"><span class="mord">if&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mord">[m]&nbsp;and&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: lightgrey;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mord">&nbsp;+&nbsp;1:&nbsp;</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.6em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.33722em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">bad</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord text"><span class="mord texttt">false</span></span></span></span><span class="" style="top: 0.46278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: 2.26278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord">//</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord textit">returns&nbsp;false&nbsp;if&nbsp;T[m]&nbsp;undefined&nbsp;</span></span></span></span><span class="" style="top: 4.06278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 5.86278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined:</span></span></span></span><span class="" style="top: 7.66278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 9.46278em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 13.2972em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 27.0944em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -13.2972em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 15.7972em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -27.7944em;"><span class="pstrut" style="height: 15.7972em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -29.5944em;"><span class="pstrut" style="height: 15.7972em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 13.2972em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>The library on the left is equivalent to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb</mtext><mo>−</mo><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{hyb}-h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> since the only change is the highlighted lines, which don’t actually affect anything. In the library on the right, if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> is undefined during the first <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">h + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> calls to GUESS, the subroutine will return false (either by avoiding the if-statement altogether or by triggering the highlighted lines). This matches the behavior of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{hyb-}(h + 1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, except that the library shown above samples the value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> which in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{hyb-}(h + 1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span> would not be sampled until the next call of the form GUESS<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m, \cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> or REVEAL<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>. But the method of sampling is the same, only the timing is different. This difference has no effect on the calling program.</p>
<p>So the two libraries above are indeed equivalent to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{hyb-}h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{hyb-}(h + 1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. They differ only in code that is reachable when bad <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">= 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>. From Lemma 4.8, we know that these two libraries are indistinguishable if Pr[bad <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">= 1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span> is negligible. In these libraries there is only one chance to set bad <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">= 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span>, and that is by guessing/predicting uniform <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> on the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(h+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span>th call to GUESS. This happens with probability <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">1/2^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span>, which is indeed negligible.</p>
<p>This shows that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mi>h</mi></mrow></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mo stretchy="false">(</mo><mi>h</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{hyb-}h} \approx \mathcal{L}_{\text{hyb-}(h + 1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">h</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, and completes the proof. <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&nbsp;</mtext><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\ \blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.675em; vertical-align: 0em;"></span><span class="mspace">&nbsp;</span><span class="mord amsrm">■</span></span></span></span></span></p>
<p>We now return to the problem of proving that a PRF is a MAC.</p>
<p><strong>Claim 10.4</strong><br>
<em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRF with input length in and output length out <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">= \lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>. Then the scheme MAC<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k,m) = F (k,m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span> is a secure MAC for message space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>i</mi><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{in}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span></span></span></span></span></span></span></span></span>.</em></p>
<p><strong>Proof</strong><br>
We show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>mac-real&nbsp;</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>mac-fake&nbsp;</mtext><mi>F</mi></msubsup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {mac-real }}^{F} \approx \mathcal{L}_{\text {mac-fake }}^{F},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> using a standard sequence of hybrids.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>mac-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>The&nbsp;starting&nbsp;point&nbsp;is&nbsp;the</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>mac-real</mtext></msub></mstyle><mtext>&nbsp;library,&nbsp;with&nbsp;the</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>details&nbsp;of&nbsp;this&nbsp;MAC&nbsp;scheme</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>filled&nbsp;in</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}^{F}_{\text{mac-real}} \\ \hline
k \leftarrow \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\lambda} \\
\underline{\text{GETTAG}(m):} \\
\quad \text{return } F(k,m) \\ 
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return } t \overset{?}{=} F(k,m) \\ \hline
\end{array}
\quad
\begin{array}{l}
\text{The starting point is the}\\
\text{$\mathcal{L}_{\text{mac-real}}$ library, with the}\\
\text{details of this MAC scheme}\\
\text{filled in}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 10.84em; vertical-align: -5.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.69em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">The&nbsp;starting&nbsp;point&nbsp;is&nbsp;the</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;library,&nbsp;with&nbsp;the</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">details&nbsp;of&nbsp;this&nbsp;MAC&nbsp;scheme</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">filled&nbsp;in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>LOOKUP(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle><mtext>)</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>LOOKUP(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle><mtext>)</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;factored&nbsp;out&nbsp;the&nbsp;PRF</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>operations&nbsp;in&nbsp;terms&nbsp;of&nbsp;the&nbsp;library</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>prf-real</mtext></msub></mstyle><mtext>&nbsp;from&nbsp;the&nbsp;PRF</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>security&nbsp;definition.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\underline{\text{GETTAG}(m):} \\
\quad \text{return} \colorbox{Yellow}{LOOKUP($m$)} \\ 
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return } t \overset{?}{=} \colorbox{Yellow}{LOOKUP($m$)} \\ \hline
\end{array}
\diamond
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}^{F}_{\text{prf-real}} \\ \hline
k \leftarrow \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\lambda} \\
\underline{\text{LOOKUP}(x):} \\
\quad \text{return } F(k,x) \\ \hline
\end{array}
\quad
\begin{array}{l}
\text{We have factored out the PRF}\\
\text{operations in terms of the library} \\
\text{$\mathcal{L}_{\text{prf-real}}$ from the PRF}\\
\text{security definition.}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.26em; vertical-align: -3.36em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.9em;"><span class="" style="top: -5.86em;"><span class="pstrut" style="height: 5.86em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.22em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.36em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.86em;"><span class="" style="top: -5.86em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.06em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord">LOOKUP(</span><span class="mord mathnormal">m</span><span class="mord">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord">LOOKUP(</span><span class="mord mathnormal">m</span><span class="mord">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.36em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.22em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.36em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.86em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.72em;"><span class="pstrut" style="height: 5.86em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.36em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;factored&nbsp;out&nbsp;the&nbsp;PRF</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">operations&nbsp;in&nbsp;terms&nbsp;of&nbsp;the&nbsp;library</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;from&nbsp;the&nbsp;PRF</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">security&nbsp;definition.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;LOOKUP</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;applied&nbsp;the&nbsp;PRF-</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>security&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi></mstyle><mtext>&nbsp;and&nbsp;replaced</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>prf-real</mtext></msub></mstyle><mtext>&nbsp;with&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>prf-rand</mtext></msub></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\underline{\text{GETTAG}(m):} \\
\quad \text{return LOOKUP} (m) \\ 
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return } t \overset{?}{=} \text{LOOKUP}(m) \\ \hline
\end{array}
\diamond
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}^{F}_{\text{prf-rand}} \\ \hline
T := \text{empty assoc. array} \\
\underline{\text{LOOKUP}(x):} \\
\quad \text{if } T[x] \text{ undefined:} \\
\qquad T[x]\leftarrow \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{out} \\
\quad \text{return } T(x) \\ \hline
\end{array}
\quad
\begin{array}{l}
\text{We have applied the PRF-}\\
\text{security of $F$ and replaced} \\
\text{$\mathcal{L}_{\text{prf-real}}$ with $\mathcal{L}_{\text{prf-rand}}$.}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 10.84em; vertical-align: -5.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.69em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined:</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;applied&nbsp;the&nbsp;PRF-</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">security&nbsp;of&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mord">&nbsp;and&nbsp;replaced</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;with&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>REVEAL(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle><mtext>)&nbsp;</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>GUESS(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi><mo separator="true">,</mo><mi>t</mi></mstyle><mtext>)</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mtext>guess-L</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;can&nbsp;express&nbsp;the&nbsp;previous</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>hybrid&nbsp;in&nbsp;terms&nbsp;of&nbsp;the&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>guess-L</mtext></msub></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>library&nbsp;from&nbsp;Claim&nbsp;10.3.&nbsp;The</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>change&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>calling&nbsp;program.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\underline{\text{GETTAG}(m):} \\
\quad \text{return }\colorbox{Yellow}{REVEAL($m$) } \\ 
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return }  \colorbox{Yellow}{GUESS($m,t$)} \\ \hline
\end{array}
\diamond
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}_{\text{guess-L}} \\ \hline
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m,g):} \\
\quad \text{if } T[m] \text{ undefined:} \\
\qquad T[m]\leftarrow \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^\lambda \\
\quad \text{return } g\stackrel{?}{=}T[m]\\ 
\underline{\text{REVEAL}(m):}\\
\quad \text{if}\ T[m]\ \text{undefined:}\\
\qquad T[m]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad \text{return}\ T[m]\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We can express the previous}\\
\text{hybrid in terms of the $\mathcal{L}_{\text{guess-L}}$} \\
\text{library from Claim 10.3. The}\\
\text{change has no effect on the}\\
\text{calling program.} \\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.26em; vertical-align: -3.36em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.9em;"><span class="" style="top: -5.86em;"><span class="pstrut" style="height: 5.86em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.22em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.36em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.86em;"><span class="" style="top: -5.86em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.06em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord">REVEAL(</span><span class="mord mathnormal">m</span><span class="mord">)&nbsp;</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord">GUESS(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mord">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.36em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.22em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.36em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.86em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.72em;"><span class="pstrut" style="height: 5.86em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.36em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 18.04em; vertical-align: -8.75em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.29em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 11.25em;"></span><span class="mtable"><span class="vertical-separator" style="height: 18em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.75em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord text"><span class="mord">&nbsp;undefined:</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 18em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.75em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -18.7em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -20.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;can&nbsp;express&nbsp;the&nbsp;previous</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">hybrid&nbsp;in&nbsp;terms&nbsp;of&nbsp;the&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">library&nbsp;from&nbsp;Claim&nbsp;10.3.&nbsp;The</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">change&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">calling&nbsp;program.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mtext>guess-R</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;applied&nbsp;Claim&nbsp;10.3&nbsp;to</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;replace&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>guess-L</mtext><mi>F</mi></msubsup></mstyle><mtext>&nbsp;with&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>guess-R</mtext><mi>F</mi></msubsup></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>This&nbsp;involves&nbsp;simply&nbsp;removing</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>the&nbsp;if-statement&nbsp;from&nbsp;GUESS.&nbsp;</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>As&nbsp;a&nbsp;result,&nbsp;GUESS</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo></mstyle><mtext>&nbsp;will&nbsp;return</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="monospace">f</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">l</mi><mi mathvariant="monospace">s</mi><mi mathvariant="monospace">e</mi></mrow></mstyle><mtext>&nbsp;if&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mstyle><mtext>&nbsp;is&nbsp;undefined.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\underline{\text{GETTAG}(m):} \\
\quad \text{return REVEAL} (m) \\ 
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return }  \text{GUESS}(m,t) \\ \hline
\end{array}
\diamond
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}_{\text{guess-R}} \\ \hline
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m,g):} \\
\quad \text{return } g\stackrel{?}{=}T[m]\\ 
\underline{\text{REVEAL}(m):}\\
\quad \text{if}\ T[m]\ \text{undefined:}\\
\qquad T[m]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad \text{return}\ T[m]\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have applied Claim 10.3 to}\\
\text{ replace $\mathcal{L}^{F}_{\text{guess-L}}$ with $\mathcal{L}^{F}_{\text{guess-R}}$.} \\
\text{This involves simply removing}\\
\text{the if-statement from GUESS. }\\
\text{As a result, GUESS$(m,g)$ will return} \\
\text{$\mathtt{false}$ if $T[m]$ is undefined.} \\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 14.44em; vertical-align: -6.95em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.49em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 9.45em;"></span><span class="mtable"><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.45em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -16.9em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;applied&nbsp;Claim&nbsp;10.3&nbsp;to</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;replace&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-L</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.411439em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;with&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.411439em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">This&nbsp;involves&nbsp;simply&nbsp;removing</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;if-statement&nbsp;from&nbsp;GUESS.&nbsp;</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">As&nbsp;a&nbsp;result,&nbsp;GUESS</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mord">&nbsp;will&nbsp;return</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord mathtt">false</span></span><span class="mord">&nbsp;if&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mord">&nbsp;is&nbsp;undefined.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>t:=REVEAL&nbsp;(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle><mtext>)</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="script">T</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>guess-R</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>Extra&nbsp;bookkeeping&nbsp;information</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>is&nbsp;added,&nbsp;but&nbsp;not&nbsp;used</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>anywhere.&nbsp;There&nbsp;is&nbsp;no&nbsp;effect</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>on&nbsp;the&nbsp;calling&nbsp;program.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\colorbox{Yellow}{$\mathcal{T}:=\emptyset$} \\
\underline{\text{GETTAG}(m):} \\
\quad \colorbox{Yellow}{t:=\text{REVEAL} ($m$)} \\ 
\quad \colorbox{Yellow}{$\mathcal{T}:=\mathcal{T}\cup \{(m,t)\}$}\\
\quad \text{return}\ t\\
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return }  \text{GUESS}(m,t) \\ \hline
\end{array}
\diamond
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}^{F}_{\text{guess-R}} \\ \hline
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m,g):} \\
\quad \text{return } g\stackrel{?}{=}T[m]\\ 
\underline{\text{REVEAL}(m):}\\
\quad \text{if}\ T[m]\ \text{undefined:}\\
\qquad T[m]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad \text{return}\ T[m]\\\hline
\end{array}
\begin{array}{l}
\text{Extra bookkeeping information}\\
\text{is added, but not used} \\
\text{anywhere. There is no effect}\\
\text{on the calling program.}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.66em; vertical-align: -6.06em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.6em;"><span class="" style="top: -8.56em;"><span class="pstrut" style="height: 8.56em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.62em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.06em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.56em;"><span class="" style="top: -8.56em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.40556em;"></span><span class="stretchy colorbox" style="height: 1.40556em; background-color: yellow;"></span></span><span class="" style="top: -3.40556em;"><span class="pstrut" style="height: 3.40556em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35556em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -6.76em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.96em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord">t:=</span><span class="mord text"><span class="mord">REVEAL</span></span><span class="mord">&nbsp;(</span><span class="mord mathnormal">m</span><span class="mord">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.34em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span></span></span><span class="" style="top: 0.46em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 2.26em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.06em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.62em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.06em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.56em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.12em;"><span class="pstrut" style="height: 8.56em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.06em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 14.44em; vertical-align: -6.95em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.49em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 9.45em;"></span><span class="mtable"><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.45em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.411439em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -16.9em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">Extra&nbsp;bookkeeping&nbsp;information</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">is&nbsp;added,&nbsp;but&nbsp;not&nbsp;used</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">anywhere.&nbsp;There&nbsp;is&nbsp;no&nbsp;effect</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">on&nbsp;the&nbsp;calling&nbsp;program.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p>Consider the hybrid experiment above, and suppose the calling program makes a call to CHECKTAG <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m, t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span>. There are two cases:</p>
<ul>
<li>
<p>Case 1 : there was a previous call to GETTAG <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>. In this case, the value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> is defined in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-R&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {guess-R }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m, T[m])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">])</span></span></span></span></span> already exists in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span></span>. In this case, the result of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">GUESS</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{GUESS}(m, t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> (and hence, of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">CHECKTAG</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{CHECKTAG}(m, t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">))</span></span></span></span></span> will be <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t \stackrel{?}{=} T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.15298em; vertical-align: 0em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span>.</p>
</li>
<li>
<p>Case 2: there was no previous call to GETTAG <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>. Then there is no value of the form <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mo>⋆</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m,\star)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋆</span><span class="mclose">)</span></span></span></span></span> in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span></span>.  Furthermore, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[m]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span></span> is undefined in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>guess-R</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{guess-R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. The call to GUESS <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> will return <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="monospace">f</mi><mi mathvariant="monospace">a</mi><mi mathvariant="monospace">l</mi><mi mathvariant="monospace">s</mi><mi mathvariant="monospace">e</mi></mrow><annotation encoding="application/x-tex">\mathtt{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61111em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathtt">false</span></span></span></span></span></span>, and so will the call to CHECKTAG <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> that we consider.</p>
</li>
</ul>
<p>In both cases, the result of CHECKTAG <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(m,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span> is true <strong>if and only if</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">(m,t)\in\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span></span>.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="script">T</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>∈</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi mathvariant="script">T</mi></mstyle></mpadded></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mtext>guess-R</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GUESS</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>g</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>g</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>REVEAL</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>m</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;modified&nbsp;CHECKTAG</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>according&nbsp;to&nbsp;the&nbsp;discussion&nbsp;above.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\mathcal{T}:=\emptyset\\
\underline{\text{GETTAG}(m):} \\
\quad t:=\text{REVEAL} (m) \\ 
\quad \mathcal{T}:=\mathcal{T}\cup \{(m,t)\}\\
\quad \text{return}\ t\\
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return }  \colorbox{Yellow}{$(m,t)\stackrel{?}{\in}\mathcal{T}$} \\ \hline
\end{array}
\diamond
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}_{\text{guess-R}} \\ \hline
T := \text{empty assoc. array} \\
\underline{\text{GUESS}(m,g):} \\
\quad \text{return } g\stackrel{?}{=}T[m]\\ 
\underline{\text{REVEAL}(m):}\\
\quad \text{if}\ T[m]\ \text{undefined:}\\
\qquad T[m]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad \text{return}\ T[m]\\\hline
\end{array}
\begin{array}{l}
\text{We have modified CHECKTAG}\\
\text{according to the discussion above.} \\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 13.0152em; vertical-align: -6.2376em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.7776em;"><span class="" style="top: -8.7376em;"><span class="pstrut" style="height: 8.7376em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.9752em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.2376em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.7376em;"><span class="" style="top: -9.10281em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -7.30281em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.50281em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -3.70281em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span><span class="" style="top: -1.90281em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span></span></span><span class="" style="top: -0.102812em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 2.0624em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.62521em;"><span class="" style="top: -3.62521em;"><span class="pstrut" style="height: 4.17521em;"></span><span class="stretchy colorbox" style="height: 2.17521em; background-color: yellow;"></span></span><span class="" style="top: -4.17521em;"><span class="pstrut" style="height: 4.17521em;"></span><span class="mord boxpad"><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32521em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">∈</span></span></span><span class="" style="top: -3.7391em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.0391em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.2376em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.9752em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.2376em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.7376em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.4752em;"><span class="pstrut" style="height: 8.7376em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.2376em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 14.44em; vertical-align: -6.95em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.49em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 9.45em;"></span><span class="mtable"><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.45em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">guess-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GUESS</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -16.9em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;modified&nbsp;CHECKTAG</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">according&nbsp;to&nbsp;the&nbsp;discussion&nbsp;above.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mstyle scriptlevel="0" displaystyle="false"><mtext>LOOKUP</mtext><mo stretchy="false">(</mo></mstyle><mtext>m</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">)</mo></mstyle></mrow></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="script">T</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>∈</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi mathvariant="script">T</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>In&nbsp;the&nbsp;previous&nbsp;hybrid,&nbsp;the&nbsp;GUESS</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>subroutine&nbsp;is&nbsp;never&nbsp;called.&nbsp;Removing</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>that&nbsp;unused&nbsp;subroutine&nbsp;and&nbsp;renaming</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>REVEAL&nbsp;to&nbsp;LOOKUP&nbsp;results&nbsp;in</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>the&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>prf-ideal</mtext></msub></mstyle><mtext>&nbsp;library&nbsp;from&nbsp;the&nbsp;PRF</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>security&nbsp;definition.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\mathcal{T}:=\emptyset\\
\underline{\text{GETTAG}(m):} \\
\quad t:= \colorbox{Yellow}{$\text{LOOKUP} ($m$)$} \\ 
\quad \mathcal{T}:=\mathcal{T}\cup \{(m,t)\}\\
\quad \text{return}\ t\\
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return }  (m,t)\stackrel{?}{\in}\mathcal{T} \\ \hline
\end{array}
\diamond
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}^{F}_{\text{prf-rand}} \\ \hline
T := \text{empty assoc. array} \\
\underline{\text{LOOKUP}(x):} \\
\quad \text{if}\ T[x]\ \text{undefined:}\\
\qquad T[x]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}\\
\quad \text{return}\ T[x]\\\hline
\end{array}
\begin{array}{l}
\text{In the previous hybrid, the GUESS}\\
\text{subroutine is never called. Removing} \\
\text{that unused subroutine and renaming} \\
\text{REVEAL to LOOKUP results in} \\
\text{the $\mathcal{L}_{\text{prf-ideal}}$ library from the PRF} \\
\text{security definition.} \\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.7152em; vertical-align: -6.0876em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.6276em;"><span class="" style="top: -8.5876em;"><span class="pstrut" style="height: 8.5876em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6752em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.0876em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.5876em;"><span class="" style="top: -8.65281em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -6.85281em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.05281em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord">m</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.24281em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span><span class="" style="top: -1.44281em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span></span></span><span class="" style="top: 0.357188em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 2.2224em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32521em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">∈</span></span></span><span class="" style="top: -3.7391em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.0391em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.0876em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6752em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.0876em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.5876em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1752em;"><span class="pstrut" style="height: 8.5876em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.0876em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 10.84em; vertical-align: -5.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.69em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">In&nbsp;the&nbsp;previous&nbsp;hybrid,&nbsp;the&nbsp;GUESS</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">subroutine&nbsp;is&nbsp;never&nbsp;called.&nbsp;Removing</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">that&nbsp;unused&nbsp;subroutine&nbsp;and&nbsp;renaming</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">REVEAL&nbsp;to&nbsp;LOOKUP&nbsp;results&nbsp;in</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-ideal</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;library&nbsp;from&nbsp;the&nbsp;PRF</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">security&nbsp;definition.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="script">T</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>m</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>∈</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi mathvariant="script">T</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;applied&nbsp;the&nbsp;PRF&nbsp;security</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi></mstyle><mtext>&nbsp;again,&nbsp;replacing&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>prf-ideal</mtext></msub></mstyle><mtext>&nbsp;with</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>prf-real</mtext></msub></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\mathcal{T}:=\emptyset\\
\underline{\text{GETTAG}(m):} \\
\quad t:=\text{LOOKUP} (m) \\ 
\quad \mathcal{T}:=\mathcal{T}\cup \{(m,t)\}\\
\quad \text{return}\ t\\
\underline{\text{CHECKTAG}(m,t):} \\
\quad \text{return }  (m,t)\stackrel{?}{\in}\mathcal{T} \\ \hline
\end{array}
\diamond
\begin{array}{|l|} \hline
\quad\qquad\mathcal{L}^{F}_{\text{prf-real}} \\ \hline
k\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\underline{\text{LOOKUP}(x):} \\
\quad \text{return}\ F(k,x)\\\hline
\end{array}
\begin{array}{l}
\text{We have applied the PRF security}\\
\text{of $F$ again, replacing $\mathcal{L}_{\text{prf-ideal}}$ with} \\
\text{$\mathcal{L}_{\text{prf-real}}$.}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.7052em; vertical-align: -6.0826em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.6226em;"><span class="" style="top: -8.5826em;"><span class="pstrut" style="height: 8.5826em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6652em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.0826em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.5826em;"><span class="" style="top: -8.64781em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -6.84781em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.04781em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -3.24781em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span><span class="" style="top: -1.44781em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span></span></span><span class="" style="top: 0.352188em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 2.2174em;"><span class="pstrut" style="height: 3.32521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32521em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">∈</span></span></span><span class="" style="top: -3.7391em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.0391em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.0826em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6652em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.0826em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.5826em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1652em;"><span class="pstrut" style="height: 8.5826em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.0826em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;applied&nbsp;the&nbsp;PRF&nbsp;security</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">of&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mord">&nbsp;again,&nbsp;replacing&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-ideal</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;with</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p>Inlining <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> in the final hybrid, we see that the result is exactly <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>mac-fake&nbsp;</mtext><mi>F</mi></msubsup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {mac-fake }}^{F} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> Hence, we have shown that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>mac-real&nbsp;</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>mac-fake&nbsp;</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {mac-real }}^{F} \approx \mathcal{L}_{\text {mac-fake }}^{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, which completes the proof.</p>
<h3 id="discussion">Discussion</h3>
<p><strong>If PRFs are MACs, why do we even need a definition for MACs?</strong> The simplest answer to this question is that the concepts of PRF and MAC are indeed different:</p>
<ul>
<li>Not every PRF is a MAC. <strong>Only sufficiently long random values are hard to guess</strong>, so only PRFs with long outputs (out <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩾</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\geqslant \lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77334em; vertical-align: -0.13667em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span></span></span></span></span> are MACs. It is perfectly reasonable to consider a PRF with short outputs.</li>
<li>Not every MAC is a PRF. Just like not every encryption scheme has pseudorandom ciphertexts, not every MAC scheme has pseudorandom tags. Imagine taking a secure MAC scheme and modifying it as <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mi mathvariant="normal">MAC</mi><mo>⁡</mo></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">MAC</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><msup><mstyle mathcolor="Red"><mn>0</mn></mstyle><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">\operatorname{MAC}^{\prime}(k, m)=\operatorname{MAC}(k, m) \|  \textcolor{Red}0^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07512em; vertical-align: -0.25em;"></span><span class="mop"><span class="mop"><span class="mord mathrm">MAC</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.825122em;"><span class="" style="top: -3.13623em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord">∥</span><span class="mord"><span class="mord" style="color: red;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span>. Adding <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="Red"><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{Red}{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: red;">0</span></span></span></span></span>s to every tag prevents the tags from looking pseudorandom, but does not make the tags any easier to guess. <strong>Something doesn’t have to be uniformly random in order to be hard to guess.</strong></li>
</ul>
<p>It is true that in the vast majority of cases we will encounter MAC schemes with random tags, and PRFs with long outputs (out <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩾</mo><mi>λ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\geqslant \lambda)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77334em; vertical-align: -0.13667em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">λ</span><span class="mclose">)</span></span></span></span></span>. But it is good practice to know whether you really need something that is <em>pseudorandom or hard to guess</em>.</p>
<h2 id="macs-for-long-messages">10.3 MACs for Long Messages</h2>
<p>Using a PRF as a MAC is useful only for short, fixed-length messages, since most PRFs that exist in practice are limited to such inputs. Can we somehow extend a PRF to construct a MAC scheme for long messages, similar to how we used block cipher modes to construct encryption for long messages?</p>
<h3 id="how-not-to-do-it">How NOT to do it</h3>
<p>To understand the challenges of constructing a MAC for long messages, we first explore some approaches that <em>don’t</em> work. The things that can go wrong in an insecure MAC are quite different in character to the things that can go wrong in a block cipher mode, so pay attention closely!</p>
<p><em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a PRF with <em>in</em> = <em>out</em> = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>. Below is a MAC approach for messages of length <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>λ</mi></mrow><annotation encoding="application/x-tex">2\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mord mathnormal">λ</span></span></span></span></span>. It is inspired by ECB mode, so you know it’s going to be a disaster:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>ECBMAC</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>t</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>t</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>t</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\underline{\text{ECBMAC}(k,m_1\|m_2):} \\
\quad t_1:=F(k,m_1) \\ 
\quad t_2:=F(k,m_2) \\ 
\quad \text{return}\ t_1\|t_2\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">ECBMAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><em>One problem with this approach is that, although the PRF authenticates each block <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_1,m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> individually, it does nothing to authenticate that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is the first block but <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is the second one. Translating this observation into an attack, an adversary can ask for the MAC tag of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_1\|m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and then predict/forge the tag for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_2\|m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mi mathvariant="script">A</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>t</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mtext>GETTAG</mtext><mo stretchy="false">(</mo><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>λ</mi></msup><mi mathvariant="normal">∥</mi><msup><mstyle mathcolor="brown"><mn>1</mn></mstyle><mi>λ</mi></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>return&nbsp;CHECKTAG</mtext><mo stretchy="false">(</mo><msup><mstyle mathcolor="brown"><mn>1</mn></mstyle><mi>λ</mi></msup><mi mathvariant="normal">∥</mi><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>λ</mi></msup><mo separator="true">,</mo><msub><mi>t</mi><mn>2</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>t</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\qquad \qquad \qquad \quad\mathcal{A}:\\\hline
t_1\|t_2:=\text{GETTAG}(\textcolor{brown}{0}^\lambda\|\textcolor{brown}{1}^\lambda)\\
\text{return CHECKTAG}(\textcolor{brown}{1}^\lambda\|\textcolor{brown}{0}^\lambda,t_2\|t_1)\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 5.44em; vertical-align: -2.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.99em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 4.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathcal">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord" style="color: brown;">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">return&nbsp;CHECKTAG</span></span><span class="mopen">(</span><span class="mord"><span class="mord" style="color: brown;">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -6.1em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><em>When <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> is linked to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>mac-real</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{mac-real}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, it always return  <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mi>r</mi><mi>u</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">\mathit{true}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.61508em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">true</span></span></span></span></span></span>, since we can tell that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>2</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">t_2\|t_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is indeed the valid tag for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mstyle mathcolor="brown"><mn>1</mn></mstyle><mi>λ</mi></msup><mi mathvariant="normal">∥</mi><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">\textcolor{brown}{1}^\lambda\|\textcolor{brown}{0}^\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord" style="color: brown;">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span>. When <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> is linked to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>mac-fake</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{mac-fake}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, it always return  <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>a</mi><mi>l</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">\mathit{false}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathit">false</span></span></span></span></span></span>, since the calling program never called GETTAG with input <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mstyle mathcolor="brown"><mn>1</mn></mstyle><mi>λ</mi></msup><mi mathvariant="normal">∥</mi><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">\textcolor{brown}{1}^\lambda\|\textcolor{brown}{0}^\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord" style="color: brown;">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span>. Hence, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> distinguishes the libraries with advantage 1.</em></p>
<p>This silly MAC construction treats both <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> identically, and an obvious way to try to fix the problem is to treat the different blocks differently somehow:</p>
<p><strong>Example</strong><br>
<em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a PRF with in = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda + 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> and out = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>. Below is another MAC approach for messages of length 2<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>ECB++MAC</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>t</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>t</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>t</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\underline{\text{ECB++MAC}(k,m_1\|m_2):}\\
\quad t_1:=F(k,\textcolor{brown}{0}\|m_1)\\
\quad t_2:=F(k,\textcolor{brown}{1}\|m_2)\\
\quad \text{return}\ t_1\|t_2\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">ECB++MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><em>This MAC construction does better, as it treats the two message blocks <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> differently. Certainly the previous attack of swapping the order of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> doesn’t work anymore. (Can you see why?)</em></p>
<p><em>The construction authenticates (in some sense) the fact that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is the first message block, and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is the second block. However, this construction doesn’t authenticate <strong>the fact that this particular <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">m_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">m_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> belong together</strong>. More concretely, we can “mix and match” blocks of the tag corresponding to different messages:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mi mathvariant="script">A</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><msub><mi>t</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mtext>GETTAG</mtext><mo stretchy="false">(</mo><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mrow><mn>2</mn><mi>λ</mi></mrow></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msubsup><mi>t</mi><mn>1</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mi mathvariant="normal">∥</mi><msubsup><mi>t</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo>:</mo><mo>=</mo><mtext>GETTAG</mtext><mo stretchy="false">(</mo><msup><mstyle mathcolor="brown"><mn>1</mn></mstyle><mrow><mn>2</mn><mi>λ</mi></mrow></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;CHECKTAG</mtext><mo stretchy="false">(</mo><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>λ</mi></msup><mi mathvariant="normal">∥</mi><msup><mstyle mathcolor="brown"><mn>1</mn></mstyle><mi>λ</mi></msup><mo separator="true">,</mo><msub><mi>t</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><msubsup><mi>t</mi><mn>2</mn><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|} \hline
\qquad \qquad \qquad \mathcal{A}:\\\hline
\quad t_1\|t_2:=\text{GETTAG}(\textcolor{brown}{0}^{2\lambda})\\
\quad t'_1\|t'_2:=\text{GETTAG}(\textcolor{brown}{1}^{2\lambda})\\
\quad \text{return CHECKTAG}(\textcolor{brown}{0}^{\lambda}\|\textcolor{brown}{1}^{\lambda},t_1\|t'_2)\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathcal">A</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.45189em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.45189em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord"><span class="mord" style="color: brown;">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;CHECKTAG</span></span><span class="mopen">(</span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord" style="color: brown;">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.45189em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.248108em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br>
<em>In this attack, we combine the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">t_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76508em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> block from the First tag and the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">t_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76508em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> block from the second tag.</em></p>
<p>We are starting to see the challenges involved in constructing a MAC scheme for long messages. A secure MAC should authenticate each message block, the order of the message blocks, and the fact that these <em>particular message blocks are appearing in a single message</em>. In short, it must authenticate the <em>entirety</em> of the message.</p>
<p>Think about how authentication is significantly different than privacy/hiding in this respect. At least for CPA security, we can hide an entire plaintext by hiding each individual piece of the plaintext separately (encrypting it with a CPA-secure encryption). Authentication is fundamentally different.</p>
<h3 id="how-to-do-it-cbc-mac">How to do it: CBC-MAC</h3>
<p>We have seen some insecure ways to construct a MAC for longer messages. Now let’s see a secure way. A common approach to constructing a MAC for long messages involves the CBC block cipher mode.</p>
<p><strong>Construction 10.5 (CBC-MAC)</strong><br>
<em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a PRF with <em>in</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> <em>out</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">=\lambda .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span><span class="mord">.</span></span></span></span></span> CBC-MAC refers to the following MAC scheme:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="red"><mtext>Image&nbsp;screenshot&nbsp;here</mtext></mstyle></mrow><annotation encoding="application/x-tex">
\textcolor{red}{{\text{Image screenshot here}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord" style="color: red;"><span class="mord text" style="color: red;"><span class="mord" style="color: red;">Image&nbsp;screenshot&nbsp;here</span></span></span></span></span></span></span></span></p>
<p>Unlike CBC encryption, CBC-MAC uses no initialization vector (or, you can think of it as using the all-zeroes IV), and it outputs only the last block.</p>
<p><strong>Theorem 10.6</strong></p>
<p><em>If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF with in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> out <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">=\lambda,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">λ</span><span class="mpunct">,</span></span></span></span></span> then for any fixed <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi><mo separator="true">,</mo><mi>C</mi><mi>B</mi><mi>C</mi><mo>−</mo><mi>M</mi><mi>A</mi><mi>C</mi></mrow><annotation encoding="application/x-tex">\ell, C B C-M A C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">ℓ</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">CBC</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span></span></span></span></span> is a secure MAC when used with message space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi><mo>=</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>λ</mi><mi mathvariant="normal">ℓ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{M}=\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda \ell}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span><span class="mord mtight">ℓ</span></span></span></span></span></span></span></span></span></span></span></span></span></em></p>
<p>Pay close attention to the security statement. It says that if you only ever authenticate 4-block messages, CBC-MAC is secure. If you only ever authenticate 24 -block messages, CBC-MAC is secure. However, if you want to authenticate both 4 -block and 24 -block messages (<em>i.e.</em>, under the same key), then CBC-MAC is not secure. In particular, seeing the CBC-MAC of several 4-block messages allows an attacker to generate a forgery of a 24-block message. The exercises explore this property.</p>
<h3 id="more-robust-cbc-mac">More Robust CBC-MAC</h3>
<p>If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">B</mi><mi mathvariant="normal">C</mi></mrow><mo>−</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">C</mi></mrow></mrow><annotation encoding="application/x-tex">\mathrm{CBC}-\mathrm{MAC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathrm">CBC</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathrm">MAC</span></span></span></span></span></span> is so fragile, is there a way to extend it to work for messages of mixed lengths? One approach is called <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">C</mi><mi mathvariant="normal">B</mi><mi mathvariant="normal">C</mi></mrow><mo>−</mo><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">C</mi></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathrm{ECBC}-\mathrm{MAC},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.76666em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathrm">ECBC</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathrm">MAC</span></span><span class="mpunct">,</span></span></span></span></span> and is shown below. It works by treating the last block differently - specifically, it uses an independent PRF key for the last block in the CBC chain.</p>
<p><strong>Construction 10.7 (ECBC-MAC)</strong><br>
<em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a PRF with in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> out <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">=\lambda .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span><span class="mord">.</span></span></span></span></span> ECBC-MAC refers to the following scheme:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mstyle mathcolor="red"><mtext>Image&nbsp;screenshot&nbsp;here</mtext></mstyle></mrow><annotation encoding="application/x-tex">
\textcolor{red}{{\text{Image screenshot here}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord" style="color: red;"><span class="mord text" style="color: red;"><span class="mord" style="color: red;">Image&nbsp;screenshot&nbsp;here</span></span></span></span></span></span></span></span></p>
<p><strong>Theorem 10.8</strong><br>
<em>If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF with <em>in</em> = <em>out</em> = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>, then ECBC-MAC is a secure MAC for message space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><msup><mo stretchy="false">)</mo><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal{M}=(\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda})^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">({</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>.</em></p>
<p>In other words, ECBC-MAC is safe to use with messages of any length (that is a multiple of the block length).</p>
<p>To extend ECBC-MAC to messages of <em>any</em> length (not necessarily a multiple of the block length), one can use a padding scheme as in the case of encryption.<sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup></p>
<h2 id="encrypt-then-mac">10.4 Encrypt-Then-MAC</h2>
<p>Our motivation for studying MACs is that they seem useful in constructing a CCA-secure encryption scheme. The idea is to add a MAC to a CPA-secure encryption scheme. The decryption algorithm can raise an error if the MAC is invalid, thereby ensuring that adversarially-generated (or adversarially-modified) ciphertexts are not accepted. There are several natural ways to combine a MAC and encryption scheme, but <em>not all are secure!</em> (See the exercises.) The safest way is known as encrypt-then-MAC:</p>
<p><strong>Construction 10.9 (Enc-then-MAC)</strong><br>
<em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span> denote an encryption scheme, and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span></span></span></span></span> denote a MAC scheme where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>⊆</mo><mi>M</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi></mrow><annotation encoding="application/x-tex">E . C \subseteq M . \mathcal{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.8193em; vertical-align: -0.13597em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord mathcal">M</span></span></span></span></span> (i.e., the MAC scheme is capable of generating MACs of ciphertexts in the E scheme). Then let EtM denote the <strong>encrypt-then-MAC</strong> construction given below:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Enc</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="script">K</mi><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">K</mi><mo>×</mo><mi>M</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">K</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mtext>.Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="script">M</mi><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>C</mi><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo>×</mo><mi>M</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">T</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>KeyGen:</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mtext>E.KeyGen</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>t</mi><mo mathvariant="normal">≠</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|ll|}\hline
&amp;\underline{\text{Enc}((k_e,k_m),m):}\\
\mathcal{K}=E.\mathcal{K}\times M.\mathcal{K} &amp; \quad c:=E\text{.Enc}(k_e,m)\\
\mathcal{M}=E.\mathcal{M} &amp; \quad t:=M.\text{MAC}(k_m,c)\\
C=E.C\times M.\mathcal{T} &amp; \quad \text{return}\ (c,t)\\
\underline{\text{KeyGen:}} &amp;\underline{\text{Dec}((k_e,k_m),(c,t)):}\\
\quad k_e\leftarrow \text{E.KeyGen} &amp; \quad \text{if}\ t\neq M.\text{MAC}(k_m,c):\\
\quad k_m\leftarrow M.\text{KeyGen} &amp; \qquad \text{return \textcolor{brown}{\texttt{err}}}\\
\quad \text{return}\ (k_e,k_m) &amp; \quad \text{return}\ E.\text{Dec}(k_e,c)\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 14.44em; vertical-align: -6.95em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.49em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 9.45em;"></span><span class="mtable"><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.45em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.01445em;">K</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord mathcal" style="margin-right: 0.01445em;">K</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord mathcal" style="margin-right: 0.01445em;">K</span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathcal">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord mathcal">M</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">KeyGen:</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">E.KeyGen</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.45em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord text"><span class="mord">.Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -16.9em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Importantly, the scheme computes a MAC of the CPA ciphertext, and not of the plaintext! The result is a CCA-secure encryption scheme:</p>
<p><strong>Claim 10.10</strong><br>
<em>If E has CPA security and M is a secure MAC, then EtM (Construction 10.9) has CCA security.</em></p>
<p><strong>Proof</strong><br>
As usual, we prove the claim with a sequence of hybrid libraries:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>cca-L</mtext><mrow><mi>E</mi><mi>t</mi><mi>M</mi></mrow></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>EAVESDROP</mtext><mo stretchy="false">(</mo><msub><mi>m</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>R</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>L</mi></msub><mi mathvariant="normal">∣</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>R</mi></msub><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>t</mi><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>S</mi><mo>:</mo><mo>=</mo><mi>S</mi><mo>∪</mo><mo stretchy="false">{</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mo separator="true">,</mo><mi>t</mi></mstyle><mtext>)</mtext></mrow></mpadded><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mrow><mtext>(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mo separator="true">,</mo><mi>t</mi></mstyle><mtext>)</mtext></mrow></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>S</mi><mtext>&nbsp;return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>t</mi><mo mathvariant="normal">≠</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext>err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle><mtext>.Dec</mtext></mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>The&nbsp;starting&nbsp;point&nbsp;is&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>cca-L</mtext><mrow><mi>E</mi><mi>t</mi><mi>M</mi></mrow></msubsup></mstyle><mtext>,&nbsp;shown&nbsp;here&nbsp;with&nbsp;the&nbsp;details&nbsp;of</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>the&nbsp;encrypt-then-MAC&nbsp;construction&nbsp;highlighted.&nbsp;Our&nbsp;goal&nbsp;is</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>to&nbsp;eventually&nbsp;swap&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mi>L</mi></msub></mstyle><mtext>&nbsp;with&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mi>R</mi></msub></mstyle><mtext>.&nbsp;But&nbsp;the&nbsp;CPA&nbsp;security&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>should&nbsp;allow&nbsp;us&nbsp;to&nbsp;do&nbsp;just&nbsp;that,&nbsp;so&nbsp;what’s&nbsp;the&nbsp;catch?</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>To&nbsp;apply&nbsp;the&nbsp;CPA-security&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle><mtext>,&nbsp;we&nbsp;must&nbsp;factor&nbsp;out&nbsp;the&nbsp;relevant</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>call&nbsp;to&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi><mi mathvariant="normal">.</mi></mstyle><mtext>Enc&nbsp;in&nbsp;terms&nbsp;of&nbsp;the&nbsp;CPA&nbsp;library&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>cpa-L</mtext><mi>E</mi></msubsup></mstyle><mtext>.&nbsp;This</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>means&nbsp;that&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>e</mi></msub></mstyle><mtext>&nbsp;becomes&nbsp;private&nbsp;to&nbsp;the&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>cpa-L</mtext></msub></mstyle><mtext>&nbsp;library.&nbsp;But&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>e</mi></msub></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>is&nbsp;also&nbsp;used&nbsp;in&nbsp;the&nbsp;last&nbsp;line&nbsp;of&nbsp;the&nbsp;library&nbsp;as&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle><mtext>.Dec</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mstyle><mtext>.&nbsp;The</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><mi>C</mi><mi>P</mi><mi>A</mi></mstyle><mtext>&nbsp;security&nbsp;library&nbsp;for&nbsp;E&nbsp;provides&nbsp;no&nbsp;way&nbsp;to&nbsp;carry&nbsp;out&nbsp;such</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle><mtext>:Dec&nbsp;statements!</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{cca-L}}^{EtM}\\\hline
\colorbox{Yellow}{$k_e\leftarrow E.\text{KeyGen}$} \\
\colorbox{Yellow}{$k_m\leftarrow M.\text{KeyGen}$}\\
S:=\emptyset\\
\underline{\text{EAVESDROP}(m_L,m_R):}\\
\quad \text{if}\ |m_L|\neq |m_R|\\
\qquad\text{return null}\\
\quad \colorbox{Yellow}{$c:=E.\text{Enc}(k_e,m_L)$}\\
\quad \colorbox{Yellow}{$t\leftarrow M.\text{MAC}(k_m,c)$}\\
\quad S:=S\cup\{\colorbox{Yellow}{($c,t$)}\}\\
\quad \text{return}\ \colorbox{Yellow}{($c,t$)}\\
\underline{\text{Dec}(c,t):}\\
\quad \text{if}\ (c,t)\in S\ \text{return null}\\
\quad \text{if}\ t\neq M.\text{MAC}(k_m,c):\\
\qquad \text{return \textcolor{brown}{err}}\\
\quad \text{return $E$.Dec}(k_e,c)\\\hline
\end{array}
\begin{array}{l}
\text{The starting point is $\mathcal{L}_{\text{cca-L}}^{EtM}$, shown here with the details of}\\
\text{the encrypt-then-MAC construction highlighted. Our goal is} \\
\text{to eventually swap $m_L$ with $m_R$. But the CPA security of $E$}\\
\text{should allow us to do just that, so what’s the catch?}\\
\\
\text{To apply the CPA-security of $E$, we must factor out the relevant} \\
\text{call to $E.$Enc in terms of the CPA library $\mathcal{L}_{\text{cpa-L}}^{E}$. This}\\
\text{means that $k_e$ becomes private to the $\mathcal{L}_{\text{cpa-L}}$ library. But $k_e$}\\
\text{is also used in the last line of the library as $E$.Dec$(k_e,c)$. The}\\
\text{$CPA$ security library for E provides no way to carry out such}\\
\text{$E$:Dec statements!}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 28.88em; vertical-align: -14.17em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.71em;"><span class="" style="top: -16.67em;"><span class="pstrut" style="height: 16.67em;"></span><span class="mtable"><span class="vertical-separator" style="height: 28.84em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.17em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.67em;"><span class="" style="top: -16.67em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cca-L</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">EtM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.275331em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -14.87em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.48888em;"></span><span class="stretchy colorbox" style="height: 1.48888em; background-color: yellow;"></span></span><span class="" style="top: -3.48888em;"><span class="pstrut" style="height: 3.48888em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.49444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -13.07em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.48888em;"></span><span class="stretchy colorbox" style="height: 1.48888em; background-color: yellow;"></span></span><span class="" style="top: -3.48888em;"><span class="pstrut" style="height: 3.48888em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.49444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -11.27em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -9.47em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">EAVESDROP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -7.67em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span><span class="" style="top: -5.87em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: -4.07em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.26em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mord">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span><span class="mclose">}</span></span></span><span class="" style="top: 1.36em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mord">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 3.17em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 4.97em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: 6.77em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 8.57em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord" style="color: brown;">err</span></span></span></span><span class="" style="top: 10.37em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.17em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 28.84em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.17em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 16.67em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -29.54em;"><span class="pstrut" style="height: 16.67em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -31.34em;"><span class="pstrut" style="height: 16.67em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.17em;"><span class=""></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 10.15em;"><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">The&nbsp;starting&nbsp;point&nbsp;is&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cca-L</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">EtM</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.275331em;"><span class=""></span></span></span></span></span></span><span class="mord">,&nbsp;shown&nbsp;here&nbsp;with&nbsp;the&nbsp;details&nbsp;of</span></span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;encrypt-then-MAC&nbsp;construction&nbsp;highlighted.&nbsp;Our&nbsp;goal&nbsp;is</span></span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">to&nbsp;eventually&nbsp;swap&nbsp;</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;with&nbsp;</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">.&nbsp;But&nbsp;the&nbsp;CPA&nbsp;security&nbsp;of&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">should&nbsp;allow&nbsp;us&nbsp;to&nbsp;do&nbsp;just&nbsp;that,&nbsp;so&nbsp;what’s&nbsp;the&nbsp;catch?</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">To&nbsp;apply&nbsp;the&nbsp;CPA-security&nbsp;of&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">,&nbsp;we&nbsp;must&nbsp;factor&nbsp;out&nbsp;the&nbsp;relevant</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">call&nbsp;to&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.Enc&nbsp;in&nbsp;terms&nbsp;of&nbsp;the&nbsp;CPA&nbsp;library&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cpa-L</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.411439em;"><span class=""></span></span></span></span></span></span><span class="mord">.&nbsp;This</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">means&nbsp;that&nbsp;</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;becomes&nbsp;private&nbsp;to&nbsp;the&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cpa-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;library.&nbsp;But&nbsp;</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">is&nbsp;also&nbsp;used&nbsp;in&nbsp;the&nbsp;last&nbsp;line&nbsp;of&nbsp;the&nbsp;library&nbsp;as&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.Dec</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mord">.&nbsp;The</span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord mathnormal" style="margin-right: 0.13889em;">CP</span><span class="mord mathnormal">A</span><span class="mord">&nbsp;security&nbsp;library&nbsp;for&nbsp;E&nbsp;provides&nbsp;no&nbsp;way&nbsp;to&nbsp;carry&nbsp;out&nbsp;such</span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">:Dec&nbsp;statements!</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 9.65em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>EAVESDROP</mtext><mo stretchy="false">(</mo><msub><mi>m</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>R</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>L</mi></msub><mi mathvariant="normal">∣</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>R</mi></msub><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>S</mi><mo>:</mo><mo>=</mo><mi>S</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mtext>not&nbsp;CHECKTAG</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext>err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;E.Dec</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>mac-real</mtext><mi>M</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>M</mi></mstyle><mtext>.MAC</mtext></mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mtext mathvariant="italic">M</mtext><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>The&nbsp;operations&nbsp;of&nbsp;the</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>MAC&nbsp;scheme&nbsp;have&nbsp;been</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>factored&nbsp;out&nbsp;in&nbsp;terms&nbsp;of</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>mac-real</mtext><mi>M</mi></msubsup></mstyle><mtext>.&nbsp;Notably,&nbsp;in&nbsp;the</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>DEC&nbsp;subroutine&nbsp;the&nbsp;condition</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>“</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>t</mi><mo mathvariant="normal">≠</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>M</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mstyle><mtext>”</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>has&nbsp;been&nbsp;replaced&nbsp;with</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>“not&nbsp;CHECKTAG</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mstyle><mtext>”</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
k_e\leftarrow E.\text{KeyGen}\\
S:=\emptyset\\
\underline{\text{EAVESDROP}(m_L,m_R):}\\
\quad \text{if}\ |m_L|\neq |m_R|\\
\qquad\text{return null}\\
\quad c:=E.\text{Enc}(k_e,m_L)\\
\quad t:=\colorbox{Yellow}{$\text{GETTAG}(c)$}\\
\quad S:=S\cup\{(c,t)\}\\
\quad \text{return}\ (c,t)\\
\underline{\text{Dec}(c,t):}\\
\quad \text{if}\ (c,t)\in S\\
\qquad \text{return null}\\
\quad \text{if}\ \colorbox{Yellow}{$\text{not CHECKTAG}(c,t)$}\\
\qquad \text{return \textcolor{brown}{err}}\\
\quad \text{return E.Dec}(k_e,c)\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{mac-real}}^M\\\hline
k_m\leftarrow E.\text{KeyGen}\\
\underline{\text{GETTAG}(c):}\\
\quad\text{return $M$.MAC}(k_m,c)\\
\underline{\text{CHECKTAG}(c,t):}\\
\quad \text{return}\ t\stackrel{?}{=}\textit{M}.\text{MAC}(k_m,c)\\\hline
\end{array}
\quad
\begin{array}{l}
\text{The operations of the}\\
\text{MAC scheme have been}\\
\text{factored out in terms of}\\
\text{$\mathcal{L}_{\text{mac-real}}^M$. Notably, in the}\\
\text{DEC subroutine the condition}\\
\text{“$t\neq M.\text{MAC}(k_M,c)$”}\\
\text{has been replaced with}\\
\text{“not CHECKTAG$(c,t)$”}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 27.06em; vertical-align: -13.26em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.8em;"><span class="" style="top: -15.76em;"><span class="pstrut" style="height: 15.76em;"></span><span class="mtable"><span class="vertical-separator" style="height: 27.02em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -13.26em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.76em;"><span class="" style="top: -15.76em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -13.96em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -12.16em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">EAVESDROP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -10.36em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span><span class="" style="top: -8.56em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: -6.76em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -4.96em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord">not&nbsp;CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 7.66em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord" style="color: brown;">err</span></span></span></span><span class="" style="top: 9.46em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;E.Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 13.26em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 27.02em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -13.26em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 15.76em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -29.52em;"><span class="pstrut" style="height: 15.76em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 13.26em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 14.4em; vertical-align: -6.95em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.69em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord textit">M</span></span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.45em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">The&nbsp;operations&nbsp;of&nbsp;the</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">MAC&nbsp;scheme&nbsp;have&nbsp;been</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">factored&nbsp;out&nbsp;in&nbsp;terms&nbsp;of</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mord">.&nbsp;Notably,&nbsp;in&nbsp;the</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">DEC&nbsp;subroutine&nbsp;the&nbsp;condition</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">“</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mord">”</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">has&nbsp;been&nbsp;replaced&nbsp;with</span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">“not&nbsp;CHECKTAG</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mord">”</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>EAVESDROP</mtext><mo stretchy="false">(</mo><msub><mi>m</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>R</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>L</mi></msub><mi mathvariant="normal">∣</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>R</mi></msub><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>S</mi><mo>:</mo><mo>=</mo><mi>S</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;not&nbsp;CHECKTAG</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext>err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle><mtext>.Dec</mtext></mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>mac-real</mtext><mi>M</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi><mo>=</mo><mi mathvariant="normal">∅</mi></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>GETTAG</mtext><mo stretchy="false">(</mo><mi>c</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="script">T</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CHECKTAG</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo><mover><mo><mo>∈</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><mi mathvariant="script">T</mi></mstyle></mpadded></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;applied&nbsp;the&nbsp;security&nbsp;of&nbsp;the</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>MAC&nbsp;scheme,&nbsp;and&nbsp;replaced&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>mac-real</mtext></msub></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>with&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>mac-fake</mtext></msub><mi mathvariant="normal">.</mi></mstyle></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
k_e\leftarrow E.\text{KeyGen}\\
S:=\emptyset\\
\underline{\text{EAVESDROP}(m_L,m_R):}\\
\quad \text{if}\ |m_L|\neq |m_R|\\
\qquad\text{return null}\\
\quad c:=E.\text{Enc}(k_e,m_L)\\
\quad t:=\text{GETTAG}(c)\\
\quad S:=S\cup\{(c,t)\}\\
\quad \text{return}\ (c,t)\\
\underline{\text{Dec}(c,t):}\\
\quad \text{if}\ (c,t)\in S\\
\qquad \text{return null}\\
\quad \text{if}\ \text{not CHECKTAG}(c,t)\\
\qquad \text{return \textcolor{brown}{err}}\\
\quad \text{return $E$.Dec}(k_e,c)\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{mac-real}}^M\\\hline
k_m\leftarrow M.\text{KeyGen}\\
\colorbox{Yellow}{$\mathcal{T}=\emptyset$}\\
\underline{\text{GETTAG}(c):}\\
\quad t:=M.\text{MAC}(k_m,c)\\
\quad \colorbox{Yellow}{$\mathcal{T}:=\mathcal{T}\cup\{(c,t)\}$}\\
\quad\text{return}\ t\\
\underline{\text{CHECKTAG}(c,t):}\\
\quad \text{return}\ \colorbox{Yellow}{$(c,t)\stackrel{?}{\in}\mathcal{T}$}\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have applied the security of the}\\
\text{MAC scheme, and replaced $\mathcal{L}_{\text{mac-real}}$}\\
\text{with $\mathcal{L}_{\text{mac-fake}}.$}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 27.04em; vertical-align: -13.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.79em;"><span class="" style="top: -15.75em;"><span class="pstrut" style="height: 15.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 27em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -13.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.75em;"><span class="" style="top: -15.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">EAVESDROP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">not&nbsp;CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord" style="color: brown;">err</span></span></span></span><span class="" style="top: 9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 13.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 27em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -13.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 15.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -29.5em;"><span class="pstrut" style="height: 15.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 13.25em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 16.6252em; vertical-align: -8.0426em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.5826em;"><span class="" style="top: -10.5426em;"><span class="pstrut" style="height: 10.5426em;"></span><span class="mtable"><span class="vertical-separator" style="height: 16.5852em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.0426em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.5426em;"><span class="" style="top: -10.9078em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.10903em;">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -9.10781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -7.30781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.40556em;"></span><span class="stretchy colorbox" style="height: 1.40556em; background-color: yellow;"></span></span><span class="" style="top: -3.40556em;"><span class="pstrut" style="height: 3.40556em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35556em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.50781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">GETTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.70781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -1.90781em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.097812em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span></span></span><span class="" style="top: 1.70219em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CHECKTAG</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 3.8674em;"><span class="pstrut" style="height: 3.62521em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.62521em;"><span class="" style="top: -3.62521em;"><span class="pstrut" style="height: 4.17521em;"></span><span class="stretchy colorbox" style="height: 2.17521em; background-color: yellow;"></span></span><span class="" style="top: -4.17521em;"><span class="pstrut" style="height: 4.17521em;"></span><span class="mord boxpad"><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.32521em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">∈</span></span></span><span class="" style="top: -3.7391em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.0391em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.0426em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 16.5852em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -8.0426em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 10.5426em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -17.2852em;"><span class="pstrut" style="height: 10.5426em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -19.0852em;"><span class="pstrut" style="height: 10.5426em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.0426em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;applied&nbsp;the&nbsp;security&nbsp;of&nbsp;the</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">MAC&nbsp;scheme,&nbsp;and&nbsp;replaced&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">with&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mstyle></mpadded></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>EAVESDROP</mtext><mo stretchy="false">(</mo><msub><mi>m</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>R</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>L</mi></msub><mi mathvariant="normal">∣</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>R</mi></msub><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi><mo>:</mo><mo>=</mo><mi mathvariant="script">T</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>S</mi><mo>:</mo><mo>=</mo><mi>S</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>DEC</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo mathvariant="normal">∉</mo><mi mathvariant="script">T</mi><mo>:</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext>err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle><mtext>.Dec</mtext></mrow><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>We&nbsp;have&nbsp;inlined&nbsp;the&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>mac-fake&nbsp;</mtext></msub></mstyle><mtext>&nbsp;library.&nbsp;This&nbsp;library&nbsp;keeps&nbsp;track</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>of&nbsp;a&nbsp;set&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">S</mi></mstyle><mtext>&nbsp;of&nbsp;values&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;CCA&nbsp;interface,&nbsp;but</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>also&nbsp;a&nbsp;set&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi></mstyle><mtext>&nbsp;of&nbsp;values&nbsp;for&nbsp;the&nbsp;purposes&nbsp;of&nbsp;the&nbsp;MAC.&nbsp;However,&nbsp;it</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>is&nbsp;clear&nbsp;from&nbsp;the&nbsp;code&nbsp;of&nbsp;this&nbsp;library&nbsp;that&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">S</mi></mstyle><mtext>&nbsp;and&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi></mstyle><mtext>&nbsp;always&nbsp;have</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>the&nbsp;same&nbsp;contents.</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Therefore,&nbsp;the&nbsp;two&nbsp;conditions&nbsp;"&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi mathvariant="script">S</mi></mstyle><mtext>&nbsp;"&nbsp;and&nbsp;"&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo mathvariant="normal">∉</mo><mi mathvariant="script">T</mi></mstyle><mtext>&nbsp;"&nbsp;in&nbsp;the</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>DEC&nbsp;subroutine&nbsp;are&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>e</mi><mi>x</mi><mi>h</mi><mi>a</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">!</mo></mstyle><mtext>&nbsp;The&nbsp;final&nbsp;line&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">C</mi></mrow></mstyle><mtext>&nbsp;is&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>u</mi><mi>n</mi><mi>r</mi><mi>e</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>a</mi><mi>b</mi><mi>l</mi><mi>e</mi></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>This&nbsp;hybrid&nbsp;highlights&nbsp;the&nbsp;intuitive&nbsp;idea&nbsp;that&nbsp;an&nbsp;adversary</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>can&nbsp;either&nbsp;query&nbsp;DEC&nbsp;with&nbsp;a&nbsp;ciphertext&nbsp;generated&nbsp;by&nbsp;EAVESDROP</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>(the&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi mathvariant="script">S</mi></mstyle><mtext>&nbsp;case&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mo stretchy="false">)</mo><mo>−</mo></mstyle><mtext>&nbsp;in&nbsp;which&nbsp;case&nbsp;the&nbsp;response&nbsp;is&nbsp;null&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mo>−</mo></mstyle><mtext>&nbsp;or</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>with&nbsp;a&nbsp;different&nbsp;ciphertext&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mo>−</mo></mstyle><mtext>&nbsp;in&nbsp;which&nbsp;case&nbsp;the&nbsp;response&nbsp;will&nbsp;be</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><mstyle mathcolor="brown"><mtext>err</mtext></mstyle></mstyle><mtext>&nbsp;since&nbsp;the&nbsp;MAC&nbsp;will&nbsp;not&nbsp;verify.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
k_e\leftarrow E.\text{KeyGen}\\
\colorbox{Yellow}{$k_m\leftarrow M.\text{KeyGen}$}\\
\colorbox{Yellow}{$\mathcal{T}:=\emptyset$}\\
S:=\emptyset\\
\underline{\text{EAVESDROP}(m_L,m_R):}\\
\quad \text{if}\ |m_L|\neq |m_R|\\
\qquad\text{return null}\\
\quad c:=E.\text{Enc}(k_e,m_L)\\
\quad t:=\colorbox{Yellow}{$M.\text{MAC}(k_m,c)$}\\
\quad \colorbox{Yellow}{$\mathcal{T}:=\mathcal{T}\cup\{(c,t)\}$}\\
\quad S:=S\cup\{(c,t)\}\\
\quad \text{return}\ (c,t)\\
\underline{\text{DEC}(c,t):}\\
\quad \text{if}\ (c,t)\in S\\
\qquad \text{return null}\\
\quad \text{if}\ \colorbox{Yellow}{$(c,t)\notin \mathcal{T}:$}\\
\qquad \text{return \textcolor{brown}{err}}\\
\quad \text{return $E$.Dec}(k_e,c)\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have inlined the $\mathcal{L}_{\text {mac-fake }}$ library. This library keeps track}\\
\text{of a set $\mathcal{S}$ of values for the purpose of the CCA interface, but}\\
\text{also a set $\mathcal{T}$ of values for the purposes of the MAC. However, it}\\
\text{is clear from the code of this library that $\mathcal{S}$ and $\mathcal{T}$ always have}\\
\text{the same contents.}\\
\\
\text{Therefore, the two conditions " $(c, t) \in \mathcal{S}$ " and " $(c, t) \notin \mathcal{T}$ " in the}\\
\text{DEC subroutine are $exhaustive!$ The final line of $\mathrm{DEC}$ is $unreachable$.}\\
\text{This hybrid highlights the intuitive idea that an adversary}\\
\text{can either query DEC with a ciphertext generated by EAVESDROP}\\
\text{(the $(c, t) \in \mathcal{S}$ case $)-$ in which case the response is null $-$ or}\\
\text{with a different ciphertext $-$ in which case the response will be}\\
\text{$\textcolor{brown}{\text{err}}$ since the MAC will not verify.}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 32.47em; vertical-align: -15.965em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 16.505em;"><span class="" style="top: -18.465em;"><span class="pstrut" style="height: 18.465em;"></span><span class="mtable"><span class="vertical-separator" style="height: 32.43em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -15.965em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 16.465em;"><span class="" style="top: -18.465em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -16.665em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.48888em;"></span><span class="stretchy colorbox" style="height: 1.48888em; background-color: yellow;"></span></span><span class="" style="top: -3.48888em;"><span class="pstrut" style="height: 3.48888em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.49444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -14.865em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.40556em;"></span><span class="stretchy colorbox" style="height: 1.40556em; background-color: yellow;"></span></span><span class="" style="top: -3.40556em;"><span class="pstrut" style="height: 3.40556em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.35556em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -13.065em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -11.265em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">EAVESDROP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -9.465em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span><span class="" style="top: -7.665em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: -5.865em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -4.065em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.255em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.445em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span><span class="" style="top: 1.355em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: 3.155em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">DEC</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 4.955em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: 6.755em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: 8.555em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right: 0.0555556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 10.365em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord" style="color: brown;">err</span></span></span></span><span class="" style="top: 12.165em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 15.965em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 32.43em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -15.965em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 18.465em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -34.93em;"><span class="pstrut" style="height: 18.465em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 15.965em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.95em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;inlined&nbsp;the&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;library.&nbsp;This&nbsp;library&nbsp;keeps&nbsp;track</span></span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">of&nbsp;a&nbsp;set&nbsp;</span><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mord">&nbsp;of&nbsp;values&nbsp;for&nbsp;the&nbsp;purpose&nbsp;of&nbsp;the&nbsp;CCA&nbsp;interface,&nbsp;but</span></span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">also&nbsp;a&nbsp;set&nbsp;</span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mord">&nbsp;of&nbsp;values&nbsp;for&nbsp;the&nbsp;purposes&nbsp;of&nbsp;the&nbsp;MAC.&nbsp;However,&nbsp;it</span></span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">is&nbsp;clear&nbsp;from&nbsp;the&nbsp;code&nbsp;of&nbsp;this&nbsp;library&nbsp;that&nbsp;</span><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mord">&nbsp;and&nbsp;</span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mord">&nbsp;always&nbsp;have</span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;same&nbsp;contents.</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">Therefore,&nbsp;the&nbsp;two&nbsp;conditions&nbsp;"&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mord">&nbsp;"&nbsp;and&nbsp;"&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right: 0.0555556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mord">&nbsp;"&nbsp;in&nbsp;the</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">DEC&nbsp;subroutine&nbsp;are&nbsp;</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">ha</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mclose">!</span><span class="mord">&nbsp;The&nbsp;final&nbsp;line&nbsp;of&nbsp;</span><span class="mord"><span class="mord mathrm">DEC</span></span><span class="mord">&nbsp;is&nbsp;</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">re</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">hab</span><span class="mord mathnormal" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord">.</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">This&nbsp;hybrid&nbsp;highlights&nbsp;the&nbsp;intuitive&nbsp;idea&nbsp;that&nbsp;an&nbsp;adversary</span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">can&nbsp;either&nbsp;query&nbsp;DEC&nbsp;with&nbsp;a&nbsp;ciphertext&nbsp;generated&nbsp;by&nbsp;EAVESDROP</span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">(the&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mord">&nbsp;case&nbsp;</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">&nbsp;in&nbsp;which&nbsp;case&nbsp;the&nbsp;response&nbsp;is&nbsp;null&nbsp;</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">&nbsp;or</span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">with&nbsp;a&nbsp;different&nbsp;ciphertext&nbsp;</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">&nbsp;in&nbsp;which&nbsp;case&nbsp;the&nbsp;response&nbsp;will&nbsp;be</span></span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord text" style="color: brown;"><span class="mord" style="color: brown;">err</span></span><span class="mord">&nbsp;since&nbsp;the&nbsp;MAC&nbsp;will&nbsp;not&nbsp;verify.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>EAVESDROP</mtext><mo stretchy="false">(</mo><msub><mi>m</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>R</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>L</mi></msub><mi mathvariant="normal">∣</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>R</mi></msub><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>S</mi><mo>:</mo><mo>=</mo><mi>S</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo mathvariant="normal">∉</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">S</mi><mo>:</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext>err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>//&nbsp;unreachable</mtext></mrow></mstyle></mtd></mtr></mtable></menclose><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>The&nbsp;unreachable&nbsp;statement&nbsp;has&nbsp;been&nbsp;removed&nbsp;and&nbsp;the&nbsp;redundant</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>variables&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>S</mi></mstyle><mtext>&nbsp;and&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi mathvariant="script">T</mi></mstyle><mtext>&nbsp;have&nbsp;been&nbsp;unified.&nbsp;Note&nbsp;that&nbsp;this&nbsp;hybrid&nbsp;library</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>never&nbsp;uses&nbsp;E.Dec,&nbsp;making&nbsp;it&nbsp;possible&nbsp;to&nbsp;express&nbsp;its&nbsp;use&nbsp;of</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>the&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle><mtext>&nbsp;encryption&nbsp;scheme&nbsp;in&nbsp;terms&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>cpa-L</mtext></msub></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
k_e\leftarrow E.\text{KeyGen}\\
k_m\leftarrow M.\text{KeyGen}\\
S:=\emptyset\\
\underline{\text{EAVESDROP}(m_L,m_R):}\\
\quad \text{if}\ |m_L|\neq |m_R|\\
\qquad\text{return null}\\
\quad c:=E.\text{Enc}(k_e,m_L)\\
\quad t:=M.\text{MAC}(k_m, c)\\
\quad S:=S\cup\{(c,t)\}\\
\quad \text{return}\ (c,t)\\
\underline{\text{Dec}(c,t):}\\
\quad \text{if}\ (c,t)\in S\\
\qquad \text{return null}\\
\quad \text{if}\ (c,t)\notin \colorbox{Yellow}{$\mathcal{S}:$}\\
\qquad \text{return \textcolor{brown}{err}}\\
\quad \text{// unreachable}\\\hline
\end{array}
\begin{array}{l}
\text{The unreachable statement has been removed and the redundant}\\
\text{variables $S$ and $\mathcal{T}$ have been unified. Note that this hybrid library}\\
\text{never uses E.Dec, making it possible to express its use of}\\
\text{the $E$ encryption scheme in terms of $\mathcal{L}_{\text{cpa-L}}$.}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 28.84em; vertical-align: -14.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.69em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 16.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.65em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -14.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">EAVESDROP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: 6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right: 0.0555556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.98333em;"><span class="" style="top: -2.98333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="stretchy colorbox" style="height: 1.28333em; background-color: yellow;"></span></span><span class="" style="top: -3.28333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="mord boxpad"><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord" style="color: brown;">err</span></span></span></span><span class="" style="top: 10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">//&nbsp;unreachable</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -31.3em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">The&nbsp;unreachable&nbsp;statement&nbsp;has&nbsp;been&nbsp;removed&nbsp;and&nbsp;the&nbsp;redundant</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">variables&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mord">&nbsp;and&nbsp;</span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span><span class="mord">&nbsp;have&nbsp;been&nbsp;unified.&nbsp;Note&nbsp;that&nbsp;this&nbsp;hybrid&nbsp;library</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">never&nbsp;uses&nbsp;E.Dec,&nbsp;making&nbsp;it&nbsp;possible&nbsp;to&nbsp;express&nbsp;its&nbsp;use&nbsp;of</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">&nbsp;encryption&nbsp;scheme&nbsp;in&nbsp;terms&nbsp;of&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cpa-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>EAVESDROP</mtext><mo stretchy="false">(</mo><msub><mi>m</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>R</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>L</mi></msub><mi mathvariant="normal">∣</mi><mo mathvariant="normal">≠</mo><mi mathvariant="normal">∣</mi><msub><mi>m</mi><mi>R</mi></msub><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mtext>CPA.EAVESDROP</mtext><mo stretchy="false">(</mo><msub><mi>m</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>R</mi></msub><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>S</mi><mo>:</mo><mo>=</mo><mi>S</mi><mo>∪</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>DEC</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>∈</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;null</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo mathvariant="normal">∉</mo><mi mathvariant="script">S</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext>err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>cpa-L</mtext><mi>E</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CPA.EAVESDROP</mtext><mo stretchy="false">(</mo><msub><mi>m</mi><mi>L</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>R</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>m</mi><mi>L</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>The&nbsp;statements&nbsp;involving</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>the&nbsp;encryption</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>scheme&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>E</mi></mstyle><mtext>&nbsp;have&nbsp;been</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>&nbsp;factored&nbsp;out&nbsp;in&nbsp;terms</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>cpa-L</mtext></msub></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
k_m\leftarrow M.\text{KeyGen}\\
S:=\emptyset\\
\underline{\text{EAVESDROP}(m_L,m_R):}\\
\quad \text{if}\ |m_L|\neq |m_R|\\
\qquad\text{return null}\\
\quad c:=\colorbox{Yellow}{$\text{CPA.EAVESDROP}(m_L,m_R)$}\\
\quad t:=M.\text{MAC}(k_m,c)\\
\quad S:=S\cup\{(c,t)\}\\
\quad \text{return}\ (c,t)\\
\underline{\text{DEC}(c,t):}\\
\quad \text{if}\ (c,t)\in S\\
\qquad \text{return null}\\
\quad \text{if}\ (c,t)\notin \mathcal{S}:\\
\qquad \text{return \textcolor{brown}{err}}\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\qquad \qquad \quad\mathcal{L}_{\text{cpa-L}}^E\\\hline
k_e\leftarrow E.\text{KeyGen}\\
\underline{\text{CPA.EAVESDROP}(m_L,m_R):}\\
\quad c:=E.\text{Enc}(k_e,m_L) \\
\quad \text{return}\ c\\\hline
\end{array}
\begin{array}{l}
\text{The statements involving}\\
\text{the encryption}\\
\text{scheme $E$ have been}\\
\text{ factored out in terms}\\
\text{of $\mathcal{L}_{\text{cpa-L}}$.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 25.25em; vertical-align: -12.355em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 12.895em;"><span class="" style="top: -14.855em;"><span class="pstrut" style="height: 14.855em;"></span><span class="mtable"><span class="vertical-separator" style="height: 25.21em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -12.355em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 12.855em;"><span class="" style="top: -14.855em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -13.055em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -11.255em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">EAVESDROP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -9.455em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∣</span></span></span><span class="" style="top: -7.655em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: -5.855em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord">CPA.EAVESDROP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.045em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -2.245em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)}</span></span></span><span class="" style="top: -0.445em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: 1.355em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">DEC</span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 3.155em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: 4.955em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;null</span></span></span></span><span class="" style="top: 6.755em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord vbox"><span class="thinbox"><span class="llap"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right: 0.0555556em;"></span></span></span><span class="fix"></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 8.555em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord" style="color: brown;">err</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 12.355em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 25.21em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -12.355em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 14.855em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -27.71em;"><span class="pstrut" style="height: 14.855em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 12.355em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.42467em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cpa-L</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.411439em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CPA.EAVESDROP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">The&nbsp;statements&nbsp;involving</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;encryption</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">scheme&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">&nbsp;have&nbsp;been</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;factored&nbsp;out&nbsp;in&nbsp;terms</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">of&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cpa-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p>We have now reached the half-way point of the proof. The proof proceeds by replacing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>cpa-L&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {cpa-L }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cpa-L&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>cpa-R&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {cpa-R }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cpa-R&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> (so that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">m_{R}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> rather than <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">m_{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is encrypted), applying the same modifications as before (but in reverse order), to finally arrive at <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>cca-R.&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {cca-R. }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">cca-R.&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> The repetitive details have been omitted, but we mention that when listing the same steps in reverse, the changes appear very bizarre indeed. For instance, we add an unreachable statement to the DEC subroutine; we create a redundant variable <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span></span> whose contents are the same as <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span></span></span></span></span>; we mysteriously change one instance of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">S</mi></mrow><annotation encoding="application/x-tex">\mathcal{S}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.075em;">S</span></span></span></span></span> (the condition of the second if-statement in DEC) to refer to the other variable <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span></span>. Of course, all of this is so that we can factor out the statements referring to the MAC scheme (along with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal" style="margin-right: 0.25417em;">T</span></span></span></span></span> ) in terms of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>mac-fake&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {mac-fake }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and finally  replace  <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>mac-fake&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {mac-fake }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-fake&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>mac-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {mac-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">mac-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.  <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&nbsp;&nbsp;</mtext><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\ \ \blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.675em; vertical-align: 0em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord amsrm">■</span></span></span></span></span></p>
<h3 id="exercises">Exercises</h3>
<p>10.1. Consider the following MAC scheme, where F is a secure PRF with <em>in</em> = <em>out</em> = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>KeyGen:</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><munder accentunder="true"><mrow><mtext>MAC</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><mo>⋯</mo><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mi mathvariant="normal">ℓ</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mrow><mtext mathvariant="italic">each</mtext><mtext>&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mi>i</mi></msub></mstyle><mtext>&nbsp;</mtext><mtext mathvariant="italic">is</mtext><mtext>&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>λ</mi></mstyle><mtext>&nbsp;</mtext><mtext mathvariant="italic">bits</mtext></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi mathvariant="normal">.</mi><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msup><mi>m</mi><mo>∗</mo></msup><mo>:</mo><mo>=</mo><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>k</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mn>1</mn><mtext>&nbsp;to&nbsp;</mtext><mi mathvariant="normal">ℓ</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msup><mi>m</mi><mo>∗</mo></msup><mo>:</mo><mo>=</mo><msup><mi>m</mi><mo>∗</mo></msup><mo>⊕</mo><msub><mi>m</mi><mi>i</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msup><mi>m</mi><mo>∗</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|ll|}\hline
\underline{\text{KeyGen:}} &amp; \underline{\text{MAC}(k,m_1\|\cdots\|m_\ell):}//\textit{each $m_i$ is $\lambda$ bits}\\
\quad k\leftarrow \{\textcolor{brown}{0}.\textcolor{brown}{1}\}^\lambda &amp; \quad m^*:=\textcolor{brown}{0}^\lambda\\
\quad \text{return}\ k &amp; \quad \text{for}\ i=1\ \text{to}\ \ell:\\
&amp; \qquad m^*:=m^*\oplus m_i\\
&amp; \quad \text{return}\ G(k,m^*)\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">KeyGen:</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mord">.</span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span><span class="mord">//</span><span class="mord text"><span class="mord textit">each&nbsp;</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord textit">&nbsp;is&nbsp;</span><span class="mord mathnormal">λ</span><span class="mord textit">&nbsp;bits</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord">ℓ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Show that the scheme is <strong>not</strong> a secure MAC. Describe a distinguisher and compute its advantage.</p>
<p>10.2. Consider the following MAC scheme, where $F $is a secure PRF with <em>in</em> = <em>out</em> = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>KeyGen:</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><munder accentunder="true"><mrow><mtext>MAC</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><mo>⋯</mo><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mi mathvariant="normal">ℓ</mi></msub><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mrow><mtext mathvariant="italic">each</mtext><mtext>&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi>m</mi><mi>i</mi></msub></mstyle><mtext>&nbsp;</mtext><mtext mathvariant="italic">is</mtext><mtext>&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>λ</mi></mstyle><mtext>&nbsp;</mtext><mtext mathvariant="italic">bits</mtext></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi mathvariant="normal">.</mi><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>k</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mn>1</mn><mtext>&nbsp;to&nbsp;</mtext><mi mathvariant="normal">ℓ</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>t</mi><mo>⊕</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>t</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|ll|}\hline
\underline{\text{KeyGen:}} &amp; \underline{\text{MAC}(k,m_1\|\cdots\|m_\ell):}//\textit{each $m_i$ is $\lambda$ bits}\\
\quad k\leftarrow \{\textcolor{brown}{0}.\textcolor{brown}{1}\}^\lambda &amp; \quad t:=\textcolor{brown}{0}^\lambda\\
\quad \text{return}\ k &amp; \quad \text{for}\ i=1\ \text{to}\ \ell:\\
&amp; \qquad t:=t\oplus F(k,m_i)\\
&amp; \quad \text{return}\ t\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">KeyGen:</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mord">.</span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span><span class="mord">//</span><span class="mord text"><span class="mord textit">each&nbsp;</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord textit">&nbsp;is&nbsp;</span><span class="mord mathnormal">λ</span><span class="mord textit">&nbsp;bits</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord">ℓ</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Show that the scheme is <strong>not</strong> a secure MAC. Describe a distinguisher and compute its advantage.</p>
<p>10.3. Suppose <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">C</mi></mrow><annotation encoding="application/x-tex">\mathrm{MAC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathrm">MAC</span></span></span></span></span></span> is a secure <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">C</mi></mrow><annotation encoding="application/x-tex">\mathrm{MAC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathrm">MAC</span></span></span></span></span></span> algorithm. Define a new algorithm <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">C</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">\mathrm{MAC}^{\prime}(k, m)=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07512em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">MAC</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.825122em;"><span class="" style="top: -3.13623em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">MAC</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><mi mathvariant="normal">MAC</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{MAC}(k, m) \| \operatorname{MAC}(k, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord">∥</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mop"><span class="mord mathrm">MAC</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>. Prove that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">C</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathrm{MAC}^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.825122em; vertical-align: 0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">MAC</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.825122em;"><span class="" style="top: -3.13623em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is also a secure MAC algorithm.</p>
<p><em>Note</em>: MAC’ cannot be a secure PRF. This shows that MAC security is different than PRF security.</p>
<p>10.4. Suppose <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">A</mi><mi mathvariant="normal">C</mi></mrow><annotation encoding="application/x-tex">\mathrm{MAC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathrm">MAC</span></span></span></span></span></span> is a secure MAC scheme, whose outputs are <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">ℓ</span></span></span></span></span> bits long. Show that there is an efficient adversary that breaks MAC security (i.e., distinguishes the relevant libraries) with advantage <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Θ</mi><mrow><mo fence="true">(</mo><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi mathvariant="normal">ℓ</mi></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Theta\left(1 / 2^{\ell}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.20001em; vertical-align: -0.35001em;"></span><span class="mord">Θ</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mord">1/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">ℓ</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span>. This implies that MAC tags must be reasonably long in order to be secure.</p>
<p>10.5. Suppose we use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">B</mi><mi mathvariant="normal">C</mi></mrow><annotation encoding="application/x-tex">\mathrm{CBC}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathrm">CBC</span></span></span></span></span></span> -MAC with message space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi><mo>=</mo><msup><mrow><mo fence="true">(</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi mathvariant="normal">.</mi><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo fence="true">)</mo></mrow><mo lspace="0em" rspace="0em">∗</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal{M}=\left(\{\textcolor{brown}{0}.\textcolor{brown}{1}\}^{\lambda}\right)^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.27861em; vertical-align: -0.35001em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">(</span></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mord">.</span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.928596em;"><span class="" style="top: -3.3029em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span>. In other words, a single MAC key will be used on messages of <em>any</em> length that is an exact multiple of the block length. Show that the result is <strong>not</strong> a secure MAC. Construct a distinguisher and compute its advantage.</p>
<blockquote>
<p>Hint: Request a MAC on two single-block messages, then use the result to forge the MAC of a two-block message.</p>
</blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋆</mo></mrow><annotation encoding="application/x-tex">\star</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord">⋆</span></span></span></span></span> 10.6. Here is a different way to extend CBC-MAC for mixed-length messages, when the length of each message is known in advance. Assume that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF with <em>in</em> = <em>out</em> = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><msup><mtext>NEWMAC</mtext><mi>F</mi></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><msub><mi>m</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><mo>⋯</mo><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mi mathvariant="normal">ℓ</mi></msub><mo stretchy="false">)</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msup><mi>k</mi><mo>∗</mo></msup><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi mathvariant="normal">ℓ</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mtext>return&nbsp;CBCMAC</mtext><mi>F</mi></msup><mo stretchy="false">(</mo><msup><mi>k</mi><mo>∗</mo></msup><mo separator="true">,</mo><msub><mi>m</mi><mn>1</mn></msub><mi mathvariant="normal">∥</mi><mo>⋯</mo><mi mathvariant="normal">∥</mi><msub><mi>m</mi><mi mathvariant="normal">ℓ</mi></msub></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\underline{\text{NEWMAC}^F(k,m_1\|\cdots\|m_\ell)}\\
\quad k^*:=F(k,\ell)\\
\text{return CBCMAC}^F(k^*,m_1\|\cdots \|m_\ell\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 5.44em; vertical-align: -2.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.99em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 4.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.914561em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">NEWMAC</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.914561em;"><span class="" style="top: -3.13623em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">ℓ</span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord text"><span class="mord">return&nbsp;CBCMAC</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.914561em;"><span class="" style="top: -3.13623em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">∥</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">ℓ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Prove that this scheme is a secure MAC for message space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><msup><mstyle mathcolor="brown"><mn>1</mn></mstyle><mi>λ</mi></msup><msup><mo stretchy="false">)</mo><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal{M}=(\{\textcolor{brown}{0},\textcolor{brown}{1}^\lambda)^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">M</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">({</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord" style="color: brown;">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>. You can use the fact that CBC-MAC is secure for messages of fixed-length.</p>
<p>10.7. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span> be a CPA-secure encryption scheme and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span></span></span></span></span> be a secure MAC. Show that the following encryption scheme (called encrypt &amp; MAC) is <strong>not</strong> CCA-secure:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi>E</mi><mi mathvariant="normal">&amp;</mi><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi>E</mi><mi mathvariant="normal">&amp;</mi><mi>M</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi>E</mi><mi mathvariant="normal">&amp;</mi><mi>M</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>m</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>t</mi><mo mathvariant="normal">≠</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>m</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|lll|}\hline
\underline{E\&amp;M.\text{KeyGen}:} &amp;  \underline{E\&amp;M.\text{Enc}((k_e,k_m),m):} &amp;  \underline{E\&amp;M.\text{Dec}((k_e,k_m),(c,t)):}\\
\quad k_e\leftarrow E.\text{KeyGen} &amp; \quad c:=E.\text{Enc}(k_e,m)&amp; \quad m:=E.\text{Dec}(k_e,c)\\
\quad k_m\leftarrow M.\text{KeyGen} &amp; \quad t:=M.\text{MAC}(k_m,m) &amp; \quad \text{if}\ t\neq M.\text{MAC}(k_m,m):\\
\quad \text{return}\ (k_e,k_m)&amp; \quad \text{return}\  (c,t) &amp;  \quad   \quad \text{return}\ \textcolor{brown}{\texttt{err}}\\
\quad &amp; &amp; \quad \text{return}\ m\\
\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">&amp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">&amp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">&amp;</span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Describe a distinguisher and compute its advantage.</p>
<p>10.8. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span></span></span></span></span> be a CPA-secure encryption scheme and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span></span></span></span></span> be a secure MAC. Show that the following encryption scheme <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Σ</span></span></span></span></span> (which I call encrypt-and-encrypted-MAC) is <strong>not</strong> CCA-secure:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi mathvariant="normal">Σ</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>m</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>←</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>t</mi><mo mathvariant="normal">≠</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>m</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|lll|}\hline
\underline{\Sigma.\text{KeyGen}:} &amp;  \underline{\Sigma.\text{Enc}((k_e,k_m),m):} &amp;  \underline{\Sigma.\text{Dec}((k_e,k_m),(c,c')):}\\
\quad k_e\leftarrow E.\text{KeyGen} &amp; \quad c:=E.\text{Enc}(k_e,m)&amp; \quad m:=E.\text{Dec}(k_e,c)\\
\quad k_m\leftarrow M.\text{KeyGen} &amp; \quad t:=M.\text{MAC}(k_m,m) &amp; \quad t:=E.\text{Dec}(k_e,c')\\
\quad \text{return}\ (k_e,k_m)&amp; \quad c'\leftarrow E.\text{Enc}(k_e,t) &amp;\quad \text{if}\ t\neq M.\text{MAC}(k_m,m):\\
&amp;\quad \text{return}\  (c,c') &amp;  \quad \quad \text{return \textcolor{brown}{\texttt{err}}}\\
&amp; &amp; \quad \text{return}\ m\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 10.84em; vertical-align: -5.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.69em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Σ.</span><span class="mord text"><span class="mord">KeyGen</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Σ.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord">Σ.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br>
Describe a distinguisher and compute its advantage.</p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋆</mo><mn>10.9.</mn></mrow><annotation encoding="application/x-tex">\star 10.9 .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">⋆</span><span class="mord">10.9.</span></span></span></span></span> In Construction <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>7.4</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">7.4,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83888em; vertical-align: -0.19444em;"></span><span class="mord">7.4</span><span class="mpunct">,</span></span></span></span></span> we encrypt one plaintext block into two ciphertext blocks. Imagine applying the Encrypt-then-MAC paradigm to this encryption scheme, but (erroneously) computing a MAC of only the second ciphertext block.</p>
<p>In other words, let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a PRF with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">i n=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span></span></span> out <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">=\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>, and let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span></span></span></span></span> be a MAC scheme for message space <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> Define the following encryption scheme:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>KeyGen</mtext><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Enc</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>k</mi><mi>e</mi></msub><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>t</mi><mo mathvariant="normal">≠</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>k</mi><mi>m</mi></msub><mo>←</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>m</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>else&nbsp;return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>r</mi><mo separator="true">,</mo><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|lll|}\hline
\underline{\text{KeyGen}:} &amp;  \underline{\text{Enc}((k_e,k_m),m):} &amp;  \underline{\text{Dec}((k_e,k_m),(r,x,t)):}\\
\quad k_e\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}  &amp; \quad r\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}&amp; \quad \text{if}\ t\neq M.\text{MAC}(k_m,x):\\
\quad k_m\leftarrow M.\text{KeyGen} &amp; \quad x:=F(k_e,r)\oplus m&amp; \quad \text{return \textcolor{brown}{\texttt{err}}}\\
\quad \text{return}\ (k_e,k_m)&amp; \quad t:=M.\text{MAC}(k_m,x) &amp;\quad \text{else return}\ F(k_e,r)\oplus x\\
&amp;\quad \text{return}\  (r,x,t) &amp;  \\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">KeyGen</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">m</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">((</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">else&nbsp;return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">x</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Show that the scheme does <strong>not</strong> have CCA security. Describe a successful attack and compute its advantage.</p>
<blockquote>
<p>Hint: Suppose (r, x, t) and (r′, x′, t′) are valid encryptions, and consider Dec((<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">k_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">k_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span>), (r′, x, t)) ⊕ x ⊕ x′.</p>
</blockquote>
<p>10.10. When we combine different cryptographic ingredients (e.g., combining a CPA-secure encryption scheme with a MAC to obtain a CCA-secure scheme) we generally require the two ingredients to use <em>separate</em>, <em>independent keys</em>. It would be more convenient if the entire scheme just used a single <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> -bit key.<br>
(a) Suppose we are using Encrypt-then-MAC, where both the encryption scheme and MAC have keys that are <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> bits long. Refer to the proof of security of Claim 12.5 and <strong>describe where it breaks down</strong> when we modify Encrypt-then-MAC to use the same key for both the encryption &amp; MAC components:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>KeyGen</mtext><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Enc</mtext><mo stretchy="false">(</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle></mpadded><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle></mpadded><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mstyle></mpadded></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle></mpadded><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>t</mi><mo mathvariant="normal">≠</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle></mpadded><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>k</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle></mpadded><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle></mpadded><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|lll|}\hline
\underline{\text{KeyGen}:} &amp;  \underline{\text{Enc}(\colorbox{Yellow}{$k$},m),:} &amp;  \underline{\text{Dec}(\colorbox{Yellow}{$k$},(c,t))):}\\
\quad \colorbox{Yellow}{$k\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}$}  &amp; \quad c:=E.\text{Enc}(\colorbox{Yellow}{$k$},m)&amp; \quad \text{if}\ t\neq M.\text{MAC}(\colorbox{Yellow}{$k$},c):\\
\quad \text{return}\ k &amp; \quad t:=M.\text{MAC}(\colorbox{Yellow}{$k$}, c)&amp; \quad \text{return \textcolor{brown}{\texttt{err}}}\\
&amp; \quad \text{return}\  (c,t) &amp;\quad \text{return}\ E.\text{Dec}(\colorbox{Yellow}{$k$},c)\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.25em; vertical-align: -3.355em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.895em;"><span class="" style="top: -5.855em;"><span class="pstrut" style="height: 5.855em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.21em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.355em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.855em;"><span class="" style="top: -5.855em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">KeyGen</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.055em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.14911em;"><span class="" style="top: -3.14911em;"><span class="pstrut" style="height: 3.69911em;"></span><span class="stretchy colorbox" style="height: 1.69911em; background-color: yellow;"></span></span><span class="" style="top: -3.69911em;"><span class="pstrut" style="height: 3.69911em;"></span><span class="mord boxpad"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.245em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span><span class="" style="top: -0.445em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.355em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.855em;"><span class="" style="top: -5.855em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.54em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.055em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -2.245em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: -0.445em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.355em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.855em;"><span class="" style="top: -5.855em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.54em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.055em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -2.245em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span><span class="" style="top: -0.445em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.355em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.21em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.355em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.855em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.71em;"><span class="pstrut" style="height: 5.855em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.355em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>(b) While Encrypt-then-MAC requires independent keys <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">k_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">k_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for the two components, show that they can both be <em>derived</em> from a single key using a PRF. In more detail, let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a PRF with <em>in</em> = 1 and out = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>. Prove that the following modified Encrypt-then-MAC construction is CCA-secure:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>KeyGen</mtext><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Enc</mtext><mo stretchy="false">(</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msup><mi>k</mi><mo>∗</mo></msup></mstyle></mpadded><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msup><mi>k</mi><mo>∗</mo></msup></mstyle></mpadded><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msup><mi>k</mi><mo>∗</mo></msup><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mstyle></mpadded></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>e</mi></msub><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msup><mi>k</mi><mo>∗</mo></msup><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>e</mi></msub><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msup><mi>k</mi><mo>∗</mo></msup><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><msup><mi>k</mi><mo>∗</mo></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>m</mi></msub><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msup><mi>k</mi><mo>∗</mo></msup><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="Yellow"><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mi>m</mi></msub><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msup><mi>k</mi><mo>∗</mo></msup><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mo stretchy="false">)</mo></mstyle></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>t</mi><mo mathvariant="normal">≠</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|lll|}\hline
\underline{\text{KeyGen}:} &amp;  \underline{\text{Enc}(\colorbox{Yellow}{$k^*$},m),:} &amp;  \underline{\text{Dec}(\colorbox{Yellow}{$k^*$},(c,t))):}\\
\quad \colorbox{Yellow}{$k^*\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}$}  &amp; \quad \colorbox{Yellow}{$k_e:=F(k^*,\textcolor{brown}{0})$}&amp;\quad \colorbox{Yellow}{$k_e:=F(k^*,\textcolor{brown}{0})$}\\
\quad \text{return}\ k^* &amp;\quad  \colorbox{Yellow}{$k_m:=F(k^*,\textcolor{brown}{1})$}&amp; \quad  \colorbox{Yellow}{$k_m:=F(k^*,\textcolor{brown}{1})$}\\
&amp; \quad c:=E.\text{Enc}(k_e,m)&amp;\quad \text{if}\ t\neq M.\text{MAC}(k_m,c):\\
&amp;\quad t:=M.\text{MAC}(k_m,c) &amp;\qquad \text{return \textcolor{brown}{\texttt{err}}}\\
&amp;\quad \text{return}\ (c,t) &amp;\quad \text{return}\ E.\text{Dec}(k_e,c)\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 10.86em; vertical-align: -5.16em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.7em;"><span class="" style="top: -7.66em;"><span class="pstrut" style="height: 7.66em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.82em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.16em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.66em;"><span class="" style="top: -7.66em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">KeyGen</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.86em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.14911em;"><span class="" style="top: -3.14911em;"><span class="pstrut" style="height: 3.69911em;"></span><span class="stretchy colorbox" style="height: 1.69911em; background-color: yellow;"></span></span><span class="" style="top: -3.69911em;"><span class="pstrut" style="height: 3.69911em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.24em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -0.44em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: 1.36em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.16em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.66em;"><span class="" style="top: -7.66em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.54em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.86em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.24em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span class="" style="top: -0.44em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span><span class="" style="top: 1.36em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.16em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.66em;"><span class="" style="top: -7.66em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.54em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">t</span><span class="mclose">)))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.86em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05em;"><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.6em;"></span><span class="stretchy colorbox" style="height: 1.6em; background-color: yellow;"></span></span><span class="" style="top: -3.6em;"><span class="pstrut" style="height: 3.6em;"></span><span class="mord boxpad"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.55em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.24em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -0.44em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span><span class="" style="top: 1.36em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.16em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.82em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.16em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.66em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.32em;"><span class="pstrut" style="height: 7.66em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.16em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>You should not have to re-prove all the tedious steps of the Encrypt-then-MAC security proof. Rather, you should apply the security of the PRF in order to reach the <em>original</em> Encrypt-then-MAC construction, whose security we already proved (so you don’t have to repeat).</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>Note that if the message is already a multiple of the block length, then padding adds an extra block. There exist clever ways to avoid an extra padding block in the case of MACs, which we don’t discuss further. <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>
</div>
</body>

</html>

