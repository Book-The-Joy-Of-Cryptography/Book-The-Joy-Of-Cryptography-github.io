---
layout: page
title: 6. Pseudorandom Functions &amp; Block Ciphers 
nav_order: 700
---

<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Welcome file</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="pseudorandom-functions--block-ciphers">6 Pseudorandom Functions &amp; Block Ciphers</h1>
<p>Imagine if Alice &amp; Bob had an <em>infinite</em> amount of shared randomness - not just a short key. They could split it up into <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> -bit chunks and use each one as a one-time pad whenever they want to send an encrypted message of length <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>.</p>
<p>Alice could encrypt by saying, "hey Bob, this message is encrypted with one-time pad using chunk <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">#</mi><mn>674696273</mn></mrow><annotation encoding="application/x-tex">\# 674696273</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">#674696273</span></span></span></span></span> as key. Bob could decrypt by looking up location <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">#</mi><mn>674696273</mn></mrow><annotation encoding="application/x-tex">\# 674696273</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">#674696273</span></span></span></span></span> in his copy of the shared randomness. As long as Alice doesn’t repeat a key/chunk, an eavesdropper (who doesn’t have the shared randomness) would learn nothing about the encrypted messages. Although Alice announces (publicly) <em>which</em> location/chunk was used as each one-time pad key, that information doesn’t help the attacker know the <em>value</em> at that location.</p>
<p><img src="https://statics.bsafes.com/images/joy-of-cryptography/help%20the%20attacker%20know.png" alt="help the attacker know"></p>
<p>It is silly to imagine an infinite amount of shared randomness. However, an exponential amount of something is often just as good as an infinite amount. A shared table containing “only” <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">2^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> one-time pad keys would be quite useful for encrypting as many messages as you could ever need.</p>
<p>A <strong>pseudorandom function (PRF)</strong> is a tool that allows Alice &amp; Bob to achieve the effect of such an exponentially large table of shared randomness in practice. In this chapter we will explore PRFs and their properties. In a later chapter, after introducing new security definitions for encryption, we will see that PRFs can be used to securely encrypt <em>many</em> messages under the same key, following the main idea illustrated above.</p>
<h2 id="definition">6.1 Definition</h2>
<p>Continuing our example, imagine a huge table of shared data stored as an array <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">T,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mpunct">,</span></span></span></span></span> so the ith item is referenced as <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></span>. Instead of thinking of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">i</span></span></span></span></span> as an integer, we can also think of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">i</span></span></span></span></span> as a binary string. If the array has <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">2^{\textit {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.830502em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> items, then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">i</span></span></span></span></span> will be an <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">i n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">in</span></span></span></span></span> -bit string. If the array contains strings of length “out”, then the notation <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>i</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mclose">]</span></span></span></span></span> is like a function that takes an input from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> and gives an output from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">out</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {out }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>A pseudorandom function emulates the functionality of a huge array. It is a function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> that takes an input from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> and gives an output from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">out</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {out }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span>. However, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> also takes an additional argument called the <strong>seed</strong>, which acts as a kind of secret key.</p>
<p>The goal of a pseudorandom function is to “look like” a uniformly chosen array / lookup table. Such an array can be accessed through the LOOKUP subroutine of the following library:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>for&nbsp;</mtext><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>in&nbsp;</mtext></msup><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>out&nbsp;</mtext></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP&nbsp;</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>in&nbsp;</mtext></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\text{for}\ x\in \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\text {in }}:\\
\quad T[x]\leftarrow \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\text {out }}\\
\underline{\text{LOOKUP}\ (x\in  \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\text {in }}):}\\
\quad \text{return} T[x]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>As you can see, this library initially fills up the array <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> with uniformly random data, and then allows the calling program to access any position in the array.</p>
<p>A pseudorandom function should produce indistinguishable behavior, when it is used with a uniformly chosen seed. More formally, the following library should be indistinguishable from the one above:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>&nbsp;return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
k \leftarrow\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\lambda}\\
\underline{\text {LOOKUP}(x \in\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }}):}\\
\quad {\text { return } F(k, x)}\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 5.44em; vertical-align: -2.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.99em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 4.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Note that the first library samples <em>out</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋅</mo><msup><mn>2</mn><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">\cdot 2^{\textit {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.830502em; vertical-align: 0em;"></span><span class="mord">⋅</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> bits uniformly at random (<em>out</em> bits for each of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">2^{\textit {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.830502em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> entries in the table), while the second library samples only <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> bits (the same <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> is used for all invocations of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> ). Still, we are asking for the two libraries to be indistinguishable.</p>
<p>This is basically the definition of a PRF, with one technical caveat. We want to allow situations like in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩾</mo><mi>λ</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\geqslant \lambda,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77334em; vertical-align: -0.13667em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">λ</span><span class="mpunct">,</span></span></span></span></span> but in those cases the first library runs in exponential time. It is generally convenient to build our security definitions with libraries that run in polynomial time. <sup class="footnote-ref"><a href="#fn1" id="fnref1">1</a></sup> We fix this by taking advantage of the fact that, no matter how big the table <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> is meant to be, a polynomial-time calling program will only access a polynomial amount of it. In some sense it is “overkill” to actually populate the entire table <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> upfront. Instead, we can populate <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> in a lazy <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">/</mi></mrow><annotation encoding="application/x-tex">/</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">/</span></span></span></span></span> on-demand way. <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> initially starts uninitialized, and its values are only assigned as the calling program requests them. This changes when each <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span></span> is sampled (if at all), but does not change <em>how</em> it is sampled (i.e, uniformly &amp; independently). This also changes <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> from being a typical array to being an <em>associative</em> array (“hash table” or “dictionary” data structure), since it only maps a subset of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>in&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\text {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> to values in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>out&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\text {out }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span>.</p>
<p><strong>Definition 6.1 (PRF security)</strong> <em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>×</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>in</mtext></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>out</mtext></msup></mrow><annotation encoding="application/x-tex">F:\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\lambda}\times\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\text{in}}\rightarrow\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\text{out}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out</span></span></span></span></span></span></span></span></span></span></span></span></span></span> be a deterministic function. We say that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure <strong>pseudorandom function (PRF)</strong> if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{prf-real}}^F\approx\mathcal{L}_{\text{prf-rand}}^F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, where:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>&nbsp;return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">out</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>&nbsp;return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{prf-real}}^F\\\hline
k \leftarrow\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\lambda}\\
\underline{\text {LOOKUP}(x \in\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }}):}\\
\quad {\text { return } F(k, x)}\\\hline
\end{array}
\quad
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{prf-rand}}^F\\\hline
T:=\text{empty assoc. array}\\\\
\underline{\text {LOOKUP}(x \in\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }}):}\\
\quad\text{if}\ T[x]\ \text{undefined:}\\
\qquad T[x]\leftarrow \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {out }}\\
\quad {\text { return } T[x]}\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.64em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.59em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="discussion-pitfalls">Discussion, Pitfalls</h3>
<p>The name “pseudorandom <em>function</em>” comes from the perspective of viewing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> not as an (associative) array, but as a function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">out</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">T:\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }} \rightarrow\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {out }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span>. There are <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mrow><mtext mathvariant="italic">out</mtext><mtext>&nbsp;</mtext></mrow><mo>−</mo><msup><mn>2</mn><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow></msup></mrow><annotation encoding="application/x-tex">2^{\textit {out }-2^{\textit {in }}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.99863em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.99863em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">out&nbsp;</span></span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mtight">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.908043em;"><span class="" style="top: -2.931em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> possible functions for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> (an incredibly large number), and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> chooses a “random function” by uniformly sampling its truth table as needed.</p>
<p>For each possible seed <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span>, the residual function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k, \cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> is also a function from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup><mo>→</mo></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }} \rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">out</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {out }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span>. There are “only” <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">2^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> possible functions of this kind (one for each choice of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> ), and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> chooses one of these functions randomly. In both cases, the libraries give the calling program input/output access to the function that was chosen. You can think of this in terms of the picture from Section 5.1 , but instead of strings, the objects are functions.</p>
<p>Note that even in the case of a “random function” <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\left(\mathcal{L}_{\text {prf-rand }}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> the function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> itself is still <strong>deterministic</strong>! To be precise, this library chooses a deterministic function, uniformly, from the set of all possible deterministic functions. But once it makes this choice, the input/output behavior of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> is fixed. If the calling program calls LOOKUP twice with the same <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span></span></span></span></span> it receives the same result. The same is true in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, since <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a deterministic function and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> is fixed throughout the entire execution. To avoid this very natural confusion, it is perhaps better to think in terms of “randomly initialized lookup tables” rather than "random functions.</p>
<h3 id="how-not-to-build-a-prf">How NOT to Build a PRF</h3>
<p>We can appreciate the challenges involved in building a PRF by looking at a natural approach that doesn’t quite work.</p>
<p><strong>Example</strong><br>
<em>Suppose we have a length-doubling <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">PRGG</mi><mo>⁡</mo><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\operatorname{PRGG}:\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\lambda} \rightarrow\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{2 \lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mop"><span class="mord mathrm">PRGG</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> and try to use it to construct a PRF F as follows:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>&nbsp;return&nbsp;</mtext><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>x</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\underline{F(k, x):}\\
\quad\text { return } G(k) \oplus x\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3.64em; vertical-align: -1.55em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.09em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 4.05em;"></span><span class="mtable"><span class="vertical-separator" style="height: 3.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -1.55em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 3.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -1.55em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 4.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -6.1em;"><span class="pstrut" style="height: 4.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><em>You might notice that all we have done is rename the encryption algorithm of “pseudo-OTP” (Construction 5.2). We have previously argued that this algorithm is a secure method for onetime encryption, and that the resulting ciphertexts are pseudorandom. Is this enough for a secure PRF? No, we can attack the security of this PRF.</em></p>
<p><em>Attacking F means designing distinguisher that behaves as differently as possible in the presence of the two <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mrow><mtext>prf-</mtext><mo>⋆</mo></mrow><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{prf-}\star}^F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-</span></span><span class="mord mtight">⋆</span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> libraries. We want to show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is insecure even if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is an excellent PRG. We should not try to base our attack on distinguishing outputs of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> from random. Instead, we must try to <strong>break the inappropriate way that</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> <strong>is used</strong> to construct a PRF</em></p>
<p><em>The distinguisher must use the interface of the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>prf</mtext><mo>−</mo><mo>⋆</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf}-\star }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf</span></span><span class="mord mtight">−⋆</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> libraries - i.e., make some calls to the LOOKUP subroutine and output 0 or 1 based on the answers it gets. The LOOKUP subroutine takes an argument, so the distinguisher has to choose which arguments to use.</em></p>
<p><em>One observation we can make is that if a calling program sees only one value of the form <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>x</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">G(k) \oplus x,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">x</span><span class="mpunct">,</span></span></span></span></span> it will look pseudorandom. This is essentially what we showed in Section 5.3. So we should be looking for a calling program that makes more than one call to LOOKUP.</em></p>
<p><em>If we make two calls to LOOKUP <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">−</span></span></span></span></span> say, on inputs <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo></mrow><annotation encoding="application/x-tex">x_{2}-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">−</span></span></span></span></span> the responses from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> will be <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⊕</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">G(k) \oplus x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⊕</mo><msub><mi>x</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">G(k) \oplus x_{2} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> To be a secure PRF, these responses must look independent and uniform. Do they? They actually have a pattern that the calling program can notice: their XOR is always <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x_{1} \oplus x_{2},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> a value that is already known to the calling program.</em></p>
<p><em>We can condense all of our observations into the following distinguisher:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mi mathvariant="script">A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>pick&nbsp;</mtext><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup><mtext>&nbsp;</mtext><mtext mathvariant="italic">arbitrarily</mtext><mtext>&nbsp;so&nbsp;that&nbsp;</mtext><msub><mi>x</mi><mn>1</mn></msub><mo mathvariant="normal">≠</mo><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>z</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>z</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;return&nbsp;</mtext><msub><mi>z</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>z</mi><mn>2</mn></msub><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><msub><mi>x</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad \qquad \qquad \qquad\mathcal{A}\\\hline
\text{pick}\ x_1,x_2\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\ \textit{arbitrarily}\ \text{so that} \ x_1\neq x_2\\
z_1:=\text{LOOKUP}(x_1)\\
z_2:=\text{LOOKUP}(x_2)\\
\text { return }z_1 \oplus z_2 \stackrel{?}{=}x_1\oplus x_2\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathcal">A</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">pick</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord textit">arbitrarily</span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">so&nbsp;that</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><em>Let’s compute its advantage in distinguishing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{prf-real}}^F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{prf-rand}}^F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span>  by considering <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi><mtext>’</mtext><mi>s</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}’s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathcal">A</span><span class="mord">’</span><span class="mord mathnormal">s</span></span></span></span></span> behavior when linked to these two libraries:</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mi mathvariant="script">A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>pick&nbsp;</mtext><msub><mi>x</mi><mn>1</mn></msub><mo mathvariant="normal">≠</mo><msub><mi>x</mi><mn>2</mn></msub><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>z</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>z</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;return&nbsp;</mtext><msub><mi>z</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>z</mi><mn>2</mn></msub><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><msub><mi>x</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>&nbsp;</mtext><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>&nbsp;return&nbsp;</mtext><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>x</mi><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad \quad \mathcal{A}\\\hline
\text{pick}\ x_1\neq x_2\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
z_1:=\text{LOOKUP}(x_1)\\
z_2:=\text{LOOKUP}(x_2)\\
\text { return }z_1 \oplus z_2 \stackrel{?}{=}x_1\oplus x_2\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\qquad \qquad \ \mathcal{L}_{\text{prf-real}}^F\\\hline
k\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\\\
\text{LOOKUP}(x):\\
\quad\text { return }G(k) \oplus x// F(k,x)\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathcal">A</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">pick</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">x</span><span class="mord">//</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><em>When <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> is linked to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}^{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, the library will choose a key <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span>. Then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">z_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is set to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⊕</mo><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">G(k) \oplus x_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">z_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is set to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⊕</mo><msub><mi>x</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">G(k) \oplus x_{2} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> So <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">z_{1} \oplus z_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is always equal to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x_{1} \oplus x_{2},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> always outputs <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1.</mn></mrow><annotation encoding="application/x-tex">1 .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1.</span></span></span></span></span> That is,</em><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Pr</mi><mo>⁡</mo><mrow><mo fence="true">[</mo><mi mathvariant="script">A</mi><mo>⋄</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext><mi>F</mi></msubsup><mo>⇒</mo><mn>1</mn><mo fence="true">]</mo></mrow><mo>=</mo><mn>1.</mn></mrow><annotation encoding="application/x-tex">
\operatorname{Pr}\left[\mathcal{A} \diamond \mathcal{L}_{\text {prf-real }}^{F} \Rightarrow 1\right]=1.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mop"><span class="mord mathrm">Pr</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">[</span></span><span class="mord mathcal">A</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1.</span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><mi mathvariant="script">A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>pick&nbsp;</mtext><msub><mi>x</mi><mn>1</mn></msub><mo mathvariant="normal">≠</mo><msub><mi>x</mi><mn>2</mn></msub><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>z</mi><mn>1</mn></msub><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>z</mi><mn>2</mn></msub><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;return&nbsp;</mtext><msub><mi>z</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>z</mi><mn>2</mn></msub><mo><mover><mo><mo>=</mo></mo><mo stretchy="false" lspace="0em" rspace="0em">?</mo></mover></mo><msub><mi>x</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>&nbsp;</mtext><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad \quad \mathcal{A}\\\hline
\text{pick}\ x_1\neq x_2\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
z_1:=\text{LOOKUP}(x_1)\\
z_2:=\text{LOOKUP}(x_2)\\
\text { return }z_1 \oplus z_2 \stackrel{?}{=}x_1\oplus x_2\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\qquad \qquad \ \mathcal{L}_{\text{prf-rand}}^F\\\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{if}\ T[x]\ \text{undefined:}\\
\qquad T[x]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\quad\text{return}\ T[x]\\
\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.04em; vertical-align: -4.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathcal">A</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">pick</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 12.64em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.59em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><em>When <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> is linked to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }}^F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, the responses of the two calls to LOOKUP will be chosen uniformly and independently because LOOKUP is being called on distinct inputs. Consider the moment in time when the second call to LOOKUP is about to happen. At that point, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x_{1}, x_{2},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">z_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> have all been determined, while <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">z_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is about to be chosen uniformly by the library. Using the properties of XOR, we see that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> will output 1 if and only if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">z_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is chosen to be exactly the value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>⊕</mo><msub><mi>x</mi><mn>2</mn></msub><mo>⊕</mo><msub><mi>z</mi><mn>1</mn></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">x_{1} \oplus x_{2} \oplus z_{1} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.73333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.04398em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> This happens only with probability <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mrow><mn>2</mn><mi>λ</mi></mrow></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">1 / 2^{2 \lambda} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> That is,</em><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">Pr</mi><mo>⁡</mo><mrow><mo fence="true">[</mo><mi mathvariant="script">A</mi><mo>∘</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mi>F</mi></msubsup><mo>⇒</mo><mn>1</mn><mo fence="true">]</mo></mrow><mo>=</mo><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mrow><mn>2</mn><mi>λ</mi></mrow></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
\operatorname{Pr}\left[\mathcal{A} \circ \mathcal{L}_{\text {prf-rand }}^{F} \Rightarrow 1\right]=1 / 2^{2 \lambda}.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mop"><span class="mord mathrm">Pr</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">[</span></span><span class="mord mathcal">A</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∘</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">⇒</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.14911em; vertical-align: -0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></span><br>
<em>The advantage of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> is therefore <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mn>1</mn><mi mathvariant="normal">/</mi><msup><mn>2</mn><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow><annotation encoding="application/x-tex">1-1 / 2^{2 \lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mord">1/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> which is certainly non-negligible since it doesn’t even approach <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0.</mn></mrow><annotation encoding="application/x-tex">0 .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0.</span></span></span></span></span> This shows that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is not a secure PRF.</em></p>
<p><em>At a more philosophical level, we wanted to identify exactly how <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is being used in an inappropriate way. The PRG security libraries guarantee security when G’s seed is chosen freshly for each call to G. This construction of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> violates that rule and allows the same seed to be used twice in different calls to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">G,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">G</span><span class="mpunct">,</span></span></span></span></span> where the results are supposed to look independent.</em></p>
<p>This example shows the challenge of building a PRF. Even though we know how to make any <em>individual</em> output pseudorandom, it is difficult to make all outputs collectively appear <em>independent</em>, when in reality they are derived from a single short seed.</p>
<h2 id="prfs-vs-prgs-variable-hybrid-proofs">6.2 PRFs vs PRGs; Variable-Hybrid Proofs</h2>
<p>In this section we show that a PRG can be used to construct a PRF, <strong>and vice-versa</strong>. The construction of a PRG from PRF is practical, and is one of the more common ways to obtain a PRG in practice. The construction of a PRF from PRG is more of theoretical interest and does not reflect how PRFs are designed in practice.</p>
<h3 id="constructing-a-prg-from-a-prf">Constructing a PRG from a PRF</h3>
<p>As promised, a PRF can be used to construct a PRG. The construction is quite natural. For simplicity, suppose we have a PRF <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>×</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">F:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \times\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> (i.e., in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> out <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">=\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> ). We can build a length-doubling PRG in the following way:</p>
<p><strong>Construction 6.2 (Counter PRG)</strong></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn><mo>⋯</mo><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn><mo>⋯</mo><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>&nbsp;return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\underline{G(s):}\\
\quad x:=F(s,\textcolor{brown}{0\cdots 00})\\
\quad y:=F(s,\textcolor{brown}{0\cdots 01})\\
\quad\text { return }x\|y\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner" style="color: brown;">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner" style="color: brown;">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>There is nothing particularly special about the inputs <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="brown"><mn>0</mn><mo>⋯</mo><mn>00</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{0\cdots 00}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner" style="color: brown;">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="brown"><mn>0</mn><mo>⋯</mo><mn>01</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{0\cdots 01}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner" style="color: brown;">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span></span></span></span></span> to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> . All that matters is that they are distinct. The construction can be extended to easily give more than 2 blocks of output, by treating the input to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> as a simple counter (hence the name of this construction).</p>
<p>The guarantee of a PRF is that when its seed is chosen uniformly and it is invoked on distinct inputs, its outputs look independently uniform. In particular, its output on inputs<br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="brown"><mn>0</mn><mo>⋯</mo><mn>00</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{0\cdots 00}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner" style="color: brown;">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="brown"><mn>0</mn><mo>⋯</mo><mn>01</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{0\cdots 01}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner" style="color: brown;">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span></span></span></span></span> are indistinguishable from uniform. Hence, concatenating them gives a string which is indistinguishable from a uniform 2<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>-bit string.</p>
<p>That really is all there is to the security of this construction, but unfortunately there is a slight technical issue which makes the security proof more complicated than you might guess. We will have to introduce a new technique of <strong>variable hybrids</strong> to cope with it.</p>
<p><strong>Claim 6.3</strong><br>
<em>If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF, then the counter PRG construction <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> above is a secure PRG.</em></p>
<p><strong>Proof</strong><br>
In order to prove that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is a secure PRG, we must prove that the following libraries are indistinguishable:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;</mtext><msubsup><mi mathvariant="script">L</mi><mtext>prg-real</mtext><mi>G</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>QUERY</mtext><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>s</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mrow><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;</mtext><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn><mo>⋯</mo><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;</mtext><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn><mo>⋯</mo><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;&nbsp;return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>G</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>&nbsp;&nbsp;</mtext><msubsup><mi mathvariant="script">L</mi><mtext>prg-rand</mtext><mi>G</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>QUERY</mtext><mo stretchy="false">(</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
 \qquad\qquad\ \ \mathcal{L}_{\text{prg-real}}^G\\\hline
\underline{\text{QUERY}():}\\
\quad s\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\left.\begin{array}{l}
\ x:=F(s,\textcolor{brown}{0\cdots 00})\\
\ y:=F(s,\textcolor{brown}{0\cdots 01})\\
\ \text { return }x\|y
\end{array}\right\}//G(s)\\\hline
\end{array}
\quad
\begin{array}{|l|}\hline
 \quad\ \  \mathcal{L}_{\text{prg-rand}}^G\\\hline
\underline{\text{QUERY}():}\\
\quad r\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\quad \text{return}\ r\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 10.84em; vertical-align: -5.15002em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.69002em;"><span class="" style="top: -7.65002em;"><span class="pstrut" style="height: 7.65002em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15002em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65002em;"><span class="" style="top: -9.34004em;"><span class="pstrut" style="height: 4.95002em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -7.54004em;"><span class="pstrut" style="height: 4.95002em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY</span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.74004em;"><span class="pstrut" style="height: 4.95002em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25002em;"><span class="pstrut" style="height: 4.95002em;"></span><span class="mord"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner" style="color: brown;">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner" style="color: brown;">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95002em;"><span class="" style="top: -1.59999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎭</span></span></span><span class="" style="top: -1.59199em;"><span class="pstrut" style="height: 3.15em;"></span><span class="" style="height: 0.916em; width: 0.889em;"><svg width="0.889em" height="0.9159999999999999em" style="width:0.889em" viewBox="0 0 889 916" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V916 H384z M384 0 H504 V916 H384z"></path></svg></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎬</span></span></span><span class="" style="top: -4.29201em;"><span class="pstrut" style="height: 3.15em;"></span><span class="" style="height: 0.916em; width: 0.889em;"><svg width="0.889em" height="0.9159999999999999em" style="width:0.889em" viewBox="0 0 889 916" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V916 H384z M384 0 H504 V916 H384z"></path></svg></span></span><span class="" style="top: -5.20002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎫</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45002em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">//</span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15002em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15002em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65002em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65002em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65002em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15002em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY</span></span><span class="mopen">(</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>During the proof, we are allowed to use the fact that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF. That is, we can use the fact that the following two libraries are indistinguishable:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>&nbsp;return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">out</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>&nbsp;return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{prf-real}}^F\\\hline
k \leftarrow\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\lambda}\\\\
\underline{\text {LOOKUP}(x \in\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }}):}\\
\quad {\text { return } F(k, x)}\\\hline
\end{array}
\quad
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{prf-rand}}^F\\\hline
T:=\text{empty assoc. array}\\\\
\underline{\text {LOOKUP}(x \in\{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {in }}):}\\
\quad\text{if}\ T[x]\ \text{undefined:}\\
\qquad T[x]\leftarrow \{\textcolor{brown}{0}, \textcolor{brown}{1}\}^{\textit {out }}\\
\quad {\text { return } T[x]}\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.64em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.59em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;return&nbsp;</span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>The inconvenience in the proof stems from a mismatch of the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">s</span></span></span></span></span> variable in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> variable in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. In <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext></msub><mo separator="true">,</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-real }}, s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">s</span></span></span></span></span> is local to the QUERY subroutine. Over the course of an execution, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">s</span></span></span></span></span> will take on many values. Since <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">s</span></span></span></span></span> is used as the PRF seed, we must write the calls to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> in terms of the LOOKUP subroutine of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. But in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> the PRF seed is fixed for the entire execution. In other words, we can only use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> to deal with a single PRF seed at a time, but <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> deals with many PRG seeds at a time.</p>
<p>To address this, we will have to apply the security of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo fence="true">(</mo></mrow><annotation encoding="application/x-tex">F\left(\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mclose nulldelimiter"></span></span></span></span></span></span> <em>i.e.</em>, replace <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ) <em>many times</em> during the proof <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">−</span></span></span></span></span> in fact, once for every call to QUERY made by the calling program. Previous security proofs had a fixed number of hybrid steps ( <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi mathvariant="normal">.</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">e . g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">e</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right: 0.03588em;">g</span></span></span></span></span>., the proof of Claim 5.5 used 7 hybrid libraries to show <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb&nbsp;</mtext><mo>−</mo><mn>1</mn></mrow></msub><mo>≈</mo><mo>⋯</mo><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mn>7</mn></mrow></msub><mo>≈</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-real }} \approx \mathcal{L}_{\text {hyb }-1} \approx \cdots \approx \mathcal{L}_{\text {hyb- } 7} \approx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb&nbsp;</span></span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.48312em; vertical-align: 0em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mtight">7</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prg-rand&nbsp;</mtext></msub><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left.\mathcal{L}_{\text {prg-rand }}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span>. This proof will have a <strong>variable number of hybrids that depends on the calling program.</strong> Specifically, we will prove<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext><mi>G</mi></msubsup><mo>≈</mo><msub><mi mathvariant="script">L</mi><mtext>hyb-1&nbsp;</mtext></msub><mo>≈</mo><mo>⋯</mo><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>q</mtext></mpadded></mrow></msub><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>prg-rand&nbsp;</mtext><mi>G</mi></msubsup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text {prg-real }}^{G} \approx \mathcal{L}_{\text {hyb-1 }} \approx \cdots \approx \mathcal{L}_{\text {hyb- } \colorbox{yellow}{q}} \approx \mathcal{L}_{\text {prg-rand }}^{G},
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-1&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.48312em; vertical-align: 0em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.19603em; vertical-align: -0.5127em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.53341em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.73056em;"><span class="" style="top: -2.73056em;"><span class="pstrut" style="height: 3.225em;"></span><span class="stretchy colorbox mtight" style="height: 1.225em; background-color: yellow;"></span></span><span class="" style="top: -3.225em;"><span class="pstrut" style="height: 3.225em;"></span><span class="mord mtight boxpad"><span class="mord mtight">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.49444em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.5127em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></span><br>
where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span> is the number of times the calling program calls QUERY.</p>
<p>Don’t be overwhelmed by all these hybrids. They all follow a simple pattern. In fact,<br>
the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">i</span></span></span></span></span>th hybrid looks like this:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb</mtext><mo>−</mo><mi>i</mi></mrow></msub><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>QUERY():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>⩽</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>else:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>s</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{hyb}-i}:\\\hline
count:=0\\\\
\underline{\text{QUERY():}}\\
\quad count:=count+1\\
\quad \text{if}\ count \leqslant \colorbox{silver}{\textit{i}}:\\
\qquad r\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\qquad\text{return}\ r\\
\quad \text{else:}\\
\qquad s\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\qquad x:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 23.44em; vertical-align: -11.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.99em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 13.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 23.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -11.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.95em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">else:</span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 23.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -11.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -24.1em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -25.9em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>In other words, the hybrid libraries all differ in the value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded></mrow><annotation encoding="application/x-tex">\colorbox{silver}{\textit{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26786em; vertical-align: -0.3em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span></span></span> that is inserted into the code above. If you’re familiar with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.07153em;">C</span></span></span></span></span> compilers, think of this as adding "<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="brown"><mi mathvariant="normal">#</mi><mtext>&nbsp;</mtext><mtext mathvariant="monospace">define</mtext><mtext>&nbsp;</mtext><mi>i</mi><mtext>&nbsp;</mtext><mn>427</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{\#\ \texttt{define}\ i\ 427}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord" style="color: brown;">#</span><span class="mspace" style="color: brown;"><span style="color: brown;">&nbsp;</span></span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">define</span></span><span class="mspace" style="color: brown;"><span style="color: brown;">&nbsp;</span></span><span class="mord mathnormal" style="color: brown;">i</span><span class="mspace" style="color: brown;"><span style="color: brown;">&nbsp;</span></span><span class="mord" style="color: brown;">427</span></span></span></span></span> " to the top of the code above, to obtain <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mn>427</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- } 427}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mtight">427</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p>
<p>First note what happens for extreme choices of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded></mrow><annotation encoding="application/x-tex">\colorbox{silver}{\textit{i}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26786em; vertical-align: -0.3em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span></span></span> :</p>
<ul>
<li>In <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- } 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, the if-branch is never taken (count <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩽</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\leqslant 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77334em; vertical-align: -0.13667em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span> is never true). This library behaves exactly like <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext><mi>G</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-real }}^{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> by giving PRG outputs on every call to QUERY.</li>
<li>If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span> is the total number of times that the calling program calls QUERY, then in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mrow><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">b</mi></mrow><mo>−</mo><mi>q</mi></mrow></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\mathrm{hyb}-q},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> the if-branch is always taken ( count <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩽</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">\leqslant q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77334em; vertical-align: -0.13667em;"></span><span class="mrel amsrm">⩽</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">q</span></span></span></span></span> is always true). This library behaves exactly like <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prg-rand&nbsp;</mtext><mi>G</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-rand }}^{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> by giving truly uniform output on every call to QUERY.</li>
</ul>
<p>In general, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- } i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> will respond to the first <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">i</span></span></span></span></span> calls to QUERY by giving truly random output. It will respond to all further calls by giving outputs of our PRG construction.</p>
<p>We have argued that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext><mi>G</mi></msubsup><mo>≡</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mn>0</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-real }}^{G} \equiv \mathcal{L}_{\text {hyb- } 0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prg-rand&nbsp;</mtext><mi>G</mi></msubsup><mo>≡</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>q</mi><mi mathvariant="normal">.</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-rand }}^{G} \equiv \mathcal{L}_{\text {hyb- } q .}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">q</span><span class="mord mtight">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> To complete the proof, we must show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- }(i-1)} \approx \mathcal{L}_{\text {hyb- } i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for all <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">i</span></span></span></span></span>. The main reason for going to all this trouble of defining so many hybrid libraries is that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mrow><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">b</mi></mrow><mo>−</mo><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\mathrm{hyb}-(i-1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- } i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> are completely identical except in how they respond to the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">i</span></span></span></span></span>th call to QUERY. This difference involves a single call to the PRG (and hence a single PRF seed), which allows us to apply the security of the PRF.</p>
<p>In more detail, let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">i</span></span></span></span></span> be arbitrary, and consider the following sequence of steps starting with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- }(i-1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span> :</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>QUERY():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&lt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>elseif:&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msup><mi>s</mi><mo>∗</mo></msup><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>∗</mo></msup><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>∗</mo></msup><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>else:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>s</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>We&nbsp;have&nbsp;taken&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>hyb-(i-1)</mtext></msub></mstyle><mtext>&nbsp;</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>and&nbsp;simply&nbsp;expanded&nbsp;the&nbsp;</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>else-branch&nbsp;(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>⩾</mo></mstyle><mtext>&nbsp;i&nbsp;)&nbsp;into</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;two&nbsp;subcases&nbsp;(</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>=</mo><mi>i</mi></mstyle><mtext>&nbsp;and</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&gt;</mo><mi>i</mi></mstyle><mtext>&nbsp;).&nbsp;However,&nbsp;both</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>cases&nbsp;lead&nbsp;to&nbsp;the&nbsp;same&nbsp;block&nbsp;of</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>code&nbsp;(apart&nbsp;from&nbsp;a&nbsp;change&nbsp;to&nbsp;a</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>local&nbsp;variable’s&nbsp;name),&nbsp;so&nbsp;the&nbsp;</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>change&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>calling&nbsp;program.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
count:=0\\\\
\underline{\text{QUERY():}}\\
\quad count:=count+1\\
\quad \text{if}\ count &lt; \colorbox{silver}{\textit{i}}:\\
\qquad r\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\qquad\text{return}\ r\\
\quad \text{elseif:}\ count = \colorbox{silver}{\textit{i}}:\\
\qquad s^*\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\qquad x:=F(s^*,\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=F(s^*,\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\
\quad \text{else:}\\
\qquad s\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\qquad x:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have taken $\mathcal{L}_{\text{hyb-(i-1)}}$ }\\
\text{and simply expanded the }\\
\text{else-branch ($count \geqslant$ i ) into}\\
\text{ two subcases ($count = i$ and}\\
\text{$count &gt; i$ ). However, both}\\
\text{cases lead to the same block of}\\
\text{code (apart from a change to a}\\
\text{local variable’s name), so the }\\
\text{change has no effect on the}\\
\text{calling program.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 30.64em; vertical-align: -15.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 15.59em;"><span class="" style="top: -17.55em;"><span class="pstrut" style="height: 17.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 30.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -15.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 15.55em;"><span class="" style="top: -17.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -15.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">elseif:</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">else:</span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: 9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 15.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 30.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -15.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 17.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -33.1em;"><span class="pstrut" style="height: 17.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 15.05em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;taken&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-(i-1)</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;</span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">and&nbsp;simply&nbsp;expanded&nbsp;the&nbsp;</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">else-branch&nbsp;(</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">&nbsp;i&nbsp;)&nbsp;into</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;two&nbsp;subcases&nbsp;(</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">i</span><span class="mord">&nbsp;and</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">i</span><span class="mord">&nbsp;).&nbsp;However,&nbsp;both</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">cases&nbsp;lead&nbsp;to&nbsp;the&nbsp;same&nbsp;block&nbsp;of</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">code&nbsp;(apart&nbsp;from&nbsp;a&nbsp;change&nbsp;to&nbsp;a</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">local&nbsp;variable’s&nbsp;name),&nbsp;so&nbsp;the&nbsp;</span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">change&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the</span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">calling&nbsp;program.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>QUERY():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&lt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>elseif:&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>LOOKUP</mtext></mpadded><mo stretchy="false">(</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>LOOKUP</mtext></mpadded><mo stretchy="false">(</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>else:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>s</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;factored&nbsp;out&nbsp;the&nbsp;calls</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>to&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi></mstyle><mtext>&nbsp;that&nbsp;use&nbsp;seed&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msup><mi>s</mi><mo>∗</mo></msup></mstyle><mtext>&nbsp;(corre</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>-sponding&nbsp;to&nbsp;the&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>case)&nbsp;in&nbsp;terms&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>prf-real</mtext></msub></mstyle><mtext>.&nbsp;This</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>change&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;calling</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>program.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
count:=0\\\\
\underline{\text{QUERY():}}\\
\quad count:=count+1\\
\quad \text{if}\ count &lt; \colorbox{silver}{\textit{i}}:\\
\qquad r\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\qquad\text{return}\ r\\
\quad \text{elseif:}\ count = \colorbox{silver}{\textit{i}}:\\
\qquad x:=\text{\colorbox{yellow}{LOOKUP}}(\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=\text{\colorbox{yellow}{LOOKUP}}(\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\
\quad \text{else:}\\
\qquad s\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\qquad x:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\qquad\mathcal{L}_{\text{prf-real}}^F\\\hline
k\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{return}\ F(k,x)\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have factored out the calls}\\
\text{to $F$ that use seed $s^*$ (corre}\\
\text{-sponding to the $count = \colorbox{silver}{\textit{i}}$}\\
 \text{case) in terms of $\mathcal{L}_{\text{prf-real}}$.  This}\\
\text{change no effect on the calling}\\
\text{program.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 28.84em; vertical-align: -14.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.69em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 16.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.65em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -14.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">elseif:</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.98333em;"><span class="" style="top: -2.98333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="stretchy colorbox" style="height: 1.28333em; background-color: yellow;"></span></span><span class="" style="top: -3.28333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="mord boxpad"><span class="mord">LOOKUP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.98333em;"><span class="" style="top: -2.98333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="stretchy colorbox" style="height: 1.28333em; background-color: yellow;"></span></span><span class="" style="top: -3.28333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="mord boxpad"><span class="mord">LOOKUP</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">else:</span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: 8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -31.3em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 10.8em; vertical-align: -5.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;factored&nbsp;out&nbsp;the&nbsp;calls</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">to&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mord">&nbsp;that&nbsp;use&nbsp;seed&nbsp;</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mord">&nbsp;(corre</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">-sponding&nbsp;to&nbsp;the&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">case)&nbsp;in&nbsp;terms&nbsp;of&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.&nbsp;This</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">change&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;calling</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">program.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>QUERY():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&lt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>elseif:&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>else:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>s</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>From&nbsp;the&nbsp;fact&nbsp;that&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi></mstyle><mtext>&nbsp;is&nbsp;a&nbsp;secure&nbsp;PRF,&nbsp;we</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>can&nbsp;replace&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup></mstyle><mtext>&nbsp;with&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mstyle><mtext>&nbsp;</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>and&nbsp;the&nbsp;overall&nbsp;change&nbsp;is&nbsp;indistinguishable.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
count:=0\\\\
\underline{\text{QUERY():}}\\
\quad count:=count+1\\
\quad \text{if}\ count &lt; \colorbox{silver}{\textit{i}}:\\
\qquad r\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\qquad\text{return}\ r\\
\quad \text{elseif:}\ count = \colorbox{silver}{\textit{i}}:\\
\qquad x:=\text{LOOKUP}(\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=\text{LOOKUP}(\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\
\quad \text{else:}\\
\qquad s\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\qquad x:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{prf-rand}}^F\\\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{if}\ T[x]\ \text{undefined:}\\
\qquad T[x]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\quad \text{return}\ T[x]\\\hline
\end{array}
\quad
\begin{array}{l}
\text{From the fact that $F$ is a secure PRF, we}\\
\text{can replace  $\mathcal{L}_{\text{prf-real}}^F$\ with\ $\mathcal{L}_{\text{prf-rand}}^F$ }\\
\text{and the overall change is indistinguishable.}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 28.84em; vertical-align: -14.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.69em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 16.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.65em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -14.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">elseif:</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">else:</span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: 8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -31.3em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 12.64em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.59em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">From&nbsp;the&nbsp;fact&nbsp;that&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mord">&nbsp;is&nbsp;a&nbsp;secure&nbsp;PRF,&nbsp;we</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">can&nbsp;replace&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;with&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">and&nbsp;the&nbsp;overall&nbsp;change&nbsp;is&nbsp;indistinguishable.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>QUERY():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&lt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>elseif:&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>else:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>s</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>Since&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>=</mo><mi>i</mi></mstyle><mtext>&nbsp;happens&nbsp;only&nbsp;once,&nbsp;only&nbsp;two</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>calls&nbsp;to&nbsp;LOOKUP&nbsp;will&nbsp;be&nbsp;made&nbsp;across&nbsp;the</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>entire&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;library,&nbsp;and&nbsp;they&nbsp;are&nbsp;on</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>distinct&nbsp;inputs.&nbsp;Therefore,&nbsp;the&nbsp;if-branch&nbsp;in</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>LOOKUP&nbsp;will&nbsp;always&nbsp;be&nbsp;taken,&nbsp;and&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>T</mi></mstyle><mtext>&nbsp;is&nbsp;never</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>needed&nbsp;(it&nbsp;is&nbsp;only&nbsp;needed&nbsp;to&nbsp;“remember”&nbsp;values&nbsp;and&nbsp;</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>give&nbsp;the&nbsp;same&nbsp;answer&nbsp;when&nbsp;the&nbsp;same&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle><mtext>&nbsp;is&nbsp;used&nbsp;</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>twice&nbsp;as&nbsp;argument&nbsp;to&nbsp;LOOKUP).&nbsp;Simplifying&nbsp;the</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>library&nbsp;therefore&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;calling&nbsp;program:</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
count:=0\\\\
\underline{\text{QUERY():}}\\
\quad count:=count+1\\
\quad \text{if}\ count &lt; \colorbox{silver}{\textit{i}}:\\
\qquad r\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\qquad\text{return}\ r\\
\quad \text{elseif:}\ count = \colorbox{silver}{\textit{i}}:\\
\qquad x:=\text{LOOKUP}(\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=\text{LOOKUP}(\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\
\quad \text{else:}\\
\qquad s\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\qquad x:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\underline{\text{LOOKUP}(x):}\\
\quad r \leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\quad \text{return}\ r\\\hline
\end{array}
\quad
\begin{array}{l}
\text{Since $count = i$ happens only once, only two}\\
\text{calls to LOOKUP will be made across the}\\
\text{entire lifetime of the library, and they are on}\\
\text{distinct inputs. Therefore, the if-branch in}\\
\text{LOOKUP will always be taken, and $T$ is never}\\
\text{needed (it is only needed to “remember” values and }\\
\text{give the same answer when the same $x$ is used }\\
\text{twice as argument to LOOKUP). Simplifying the}\\
\text{library therefore has no effect on the calling program:}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 28.84em; vertical-align: -14.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.69em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 16.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.65em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -14.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">elseif:</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">else:</span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: 8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -31.3em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 16.2em; vertical-align: -7.85em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.99em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 4.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 5.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -2.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.35em;"><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">Since&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">i</span><span class="mord">&nbsp;happens&nbsp;only&nbsp;once,&nbsp;only&nbsp;two</span></span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">calls&nbsp;to&nbsp;LOOKUP&nbsp;will&nbsp;be&nbsp;made&nbsp;across&nbsp;the</span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">entire&nbsp;lifetime&nbsp;of&nbsp;the&nbsp;library,&nbsp;and&nbsp;they&nbsp;are&nbsp;on</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">distinct&nbsp;inputs.&nbsp;Therefore,&nbsp;the&nbsp;if-branch&nbsp;in</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP&nbsp;will&nbsp;always&nbsp;be&nbsp;taken,&nbsp;and&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mord">&nbsp;is&nbsp;never</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">needed&nbsp;(it&nbsp;is&nbsp;only&nbsp;needed&nbsp;to&nbsp;“remember”&nbsp;values&nbsp;and&nbsp;</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">give&nbsp;the&nbsp;same&nbsp;answer&nbsp;when&nbsp;the&nbsp;same&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">&nbsp;is&nbsp;used&nbsp;</span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">twice&nbsp;as&nbsp;argument&nbsp;to&nbsp;LOOKUP).&nbsp;Simplifying&nbsp;the</span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">library&nbsp;therefore&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;calling&nbsp;program:</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 7.85em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>QUERY():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>:</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&lt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>elseif:&nbsp;</mtext><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo>&lt;</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">i</mtext></mpadded><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>x</mtext></mpadded><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>y</mtext></mpadded><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>else:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>s</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>00</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo>⋯</mo><mstyle mathcolor="brown"><mn>01</mn></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>Inlining&nbsp;the&nbsp;subroutine&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;calling&nbsp;program.</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>The&nbsp;resulting&nbsp;library&nbsp;responds&nbsp;with&nbsp;uniformly&nbsp;random&nbsp;output</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>to&nbsp;the&nbsp;first&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>i</mi></mstyle><mtext>&nbsp;calls&nbsp;to&nbsp;QUERY,&nbsp;and&nbsp;responds&nbsp;with&nbsp;outputs&nbsp;of&nbsp;our</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>PRG&nbsp;</mtext><mtext mathvariant="italic">G</mtext><mtext>&nbsp;to&nbsp;the&nbsp;others.&nbsp;Hence,&nbsp;this&nbsp;library&nbsp;has&nbsp;identical&nbsp;behavior</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>to&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mi>i</mi></mrow></msub></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
count:=0\\\\
\underline{\text{QUERY():}}\\
\quad count:=count+1\\
\quad \text{if}\ count &lt; \colorbox{silver}{\textit{i}}:\\
\qquad r\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\qquad\text{return}\ r\\
\quad \text{elseif:}\ count &lt; \colorbox{silver}{\textit{i}}:\\
\qquad \colorbox{yellow}{x}\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\qquad \colorbox{yellow}{y}\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\qquad \text{return}\ x\|y\\
\quad \text{else:}\\
\qquad s\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\qquad x:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{00})\\
\qquad y:=F(s,\textcolor{brown}{0}\cdots\textcolor{brown}{01})\\
\qquad \text{return}\ x\|y\\\hline
\end{array}
\quad
\begin{array}{l}
\text{Inlining the subroutine has no effect on the calling program.}\\
\text{The resulting library responds with uniformly random output}\\
\text{to the first $i$ calls to QUERY, and responds with outputs of our}\\
\text{PRG } \textit{G} \text{ to the others. Hence, this library has identical behavior}\\
\text{to $\mathcal{L}_{\text{hyb-}i }$.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 28.84em; vertical-align: -14.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.69em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 16.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 14.65em;"><span class="" style="top: -16.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">0</span></span></span><span class="" style="top: -14.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">elseif:</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">co</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.73056em;"><span class="" style="top: -2.73056em;"><span class="pstrut" style="height: 3.03056em;"></span><span class="stretchy colorbox" style="height: 1.03056em; background-color: yellow;"></span></span><span class="" style="top: -3.03056em;"><span class="pstrut" style="height: 3.03056em;"></span><span class="mord boxpad"><span class="mord">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.73056em;"><span class="" style="top: -2.73056em;"><span class="pstrut" style="height: 3.225em;"></span><span class="stretchy colorbox" style="height: 1.225em; background-color: yellow;"></span></span><span class="" style="top: -3.225em;"><span class="pstrut" style="height: 3.225em;"></span><span class="mord boxpad"><span class="mord">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.49444em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">else:</span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">00</span><span class="mclose">)</span></span></span><span class="" style="top: 8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">01</span><span class="mclose">)</span></span></span><span class="" style="top: 10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 28.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -14.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -31.3em;"><span class="pstrut" style="height: 16.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 14.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">Inlining&nbsp;the&nbsp;subroutine&nbsp;has&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;calling&nbsp;program.</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">The&nbsp;resulting&nbsp;library&nbsp;responds&nbsp;with&nbsp;uniformly&nbsp;random&nbsp;output</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">to&nbsp;the&nbsp;first&nbsp;</span><span class="mord mathnormal">i</span><span class="mord">&nbsp;calls&nbsp;to&nbsp;QUERY,&nbsp;and&nbsp;responds&nbsp;with&nbsp;outputs&nbsp;of&nbsp;our</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">PRG&nbsp;</span></span><span class="mord text"><span class="mord textit">G</span></span><span class="mord text"><span class="mord">&nbsp;to&nbsp;the&nbsp;others.&nbsp;Hence,&nbsp;this&nbsp;library&nbsp;has&nbsp;identical&nbsp;behavior</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">to&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span><br>
We showed that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>i</mi></mrow></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- }(i-1)} \approx \mathcal{L}_{\text {hyb- } i},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> and therefore:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext><mi>G</mi></msubsup><mo>≡</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mn>0</mn></mrow></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mtext>hyb-1&nbsp;</mtext></msub><mo>≈</mo><mo>⋯</mo><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>q</mi></mrow></msub><mo>≡</mo><msubsup><mi mathvariant="script">L</mi><mtext>prg-rand&nbsp;</mtext><mi>G</mi></msubsup></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text {prg-real }}^{G} \equiv \mathcal{L}_{\text {hyb- } 0} \approx \mathcal{L}_{\text {hyb-1 }} \approx \cdots \approx \mathcal{L}_{\text {hyb- } q} \equiv \mathcal{L}_{\text {prg-rand }}^{G}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-1&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.48312em; vertical-align: 0em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br>
This shows that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prg-real&nbsp;</mtext><mi>G</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>prg-rand&nbsp;</mtext><mi>G</mi></msubsup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prg-real }}^{G} \approx \mathcal{L}_{\text {prg-rand }}^{G},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">G</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> so <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is a secure PRG. <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&nbsp;</mtext><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\ \blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.675em; vertical-align: 0em;"></span><span class="mspace">&nbsp;</span><span class="mord amsrm">■</span></span></span></span></span></p>
<h2 id="starquad-a-theoretical-construction-of-a-prf-from-a-prg"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋆</mo><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\star\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord">⋆</span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span> A Theoretical Construction of a PRF from a PRG</h2>
<p>We have already seen that it is possible to feed the output of a PRG back into the PRG again, to extend its stretch (Claim 5.7). This is done by making a long chain (like a linked list) of PRGs. The trick to constructing a PRF from a PRG is to chain PRGs together in a <strong>binary tree</strong> (similar to Exercise <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>5.8</mn><mo stretchy="false">(</mo><mi mathvariant="normal">a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">5.8(\mathrm{a})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord">5.8</span><span class="mopen">(</span><span class="mord mathrm">a</span><span class="mclose">)</span></span></span></span></span> ). The leaves of the tree correspond to final outputs of the PRF. If we want a PRF with an exponentially large domain (<em>e.g., in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">=\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span></em> ), the binary tree itself is exponentially large! However, it is still possible to compute any individual leaf efficiently by simply traversing the tree from root to leaf. This tree traversal itself is the PRF algorithm. This construction of a PRF is due to Goldreich, Goldwasser, and Micali, in the paper that defined the concept of a PRF.</p>
<p><img src="https://statics.bsafes.com/images/joy-of-cryptography/Imagine%20a%20complete%20binary%20tree.png" alt="Imagine a complete binary tree"></p>
<p>Imagine a complete binary tree of height <em>in</em> (<em>in</em> will be the input length of the PRF). Every node in this tree has a <em>position</em> which can be written as a binary string. Think of a node’s position as the directions to get there starting at the root, where a <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="brown"><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: brown;">0</span></span></span></span></span> means “go left” and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="brown"><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: brown;">1</span></span></span></span></span> means “go right.” For example, the root has position <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">ϵ</span></span></span></span></span> (the empty string), the right child of the root has position <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="brown"><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: brown;">1</span></span></span></span></span> , etc.</p>
<p>The PRF construction works by assigning a <em>label</em> to every node in the tree, using the a length-doubling <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">PRG</mi><mo>⁡</mo><mi>G</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\operatorname{PRG} G:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2 \lambda} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mop"><span class="mord mathrm">PRG</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> For convenience, we will write <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G_{L}(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G_{R}(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span> to denote the first <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> bits and last <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> bits of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span></span></span></span></span>, respectively. Labels in the tree are <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>-bit strings, computed according to the following two rules:</p>
<ol>
<li>The root node’s label is the PRF seed.</li>
<li>If the node at position <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span></span> has label <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span></span>, then its left child (at position <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">p \| \textcolor{brown}{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">0</span></span></span></span></span> ) gets label <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">G_{L}(v),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span> and its right child (at position <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>1</mn></mstyle></mrow><annotation encoding="application/x-tex">p \| \textcolor{brown}{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">1</span></span></span></span></span> ) gets label <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G_{R}(v)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span></span></span></li>
</ol>
<p>In the picture above, a node’s label is the string being sent on its incoming edge. The tree has <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">2^{\textit {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.830502em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> leaves, whose positions are the strings <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>in&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\text {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span>. We define <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span> to be the label of node/leaf <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>. To compute this label, we can traverse the tree from root to leaf, taking left and right turns at each node according to the bits of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> and computing the labels along that path according to the labeling rule. In the picture above, the highlighted path corresponds to the computation of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1001</mn></mstyle><mo>⋯</mo> <mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k, \textcolor{brown}{1001}\cdots)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1001</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mclose">)</span></span></span></span></span>.</p>
<p>It is important to remember that the binary tree is a useful conceptual tool, but it is exponentially large in general. Running the PRF on some input does not involve computing labels for the entire tree, only along a single path from root to leaf.</p>
<p><strong>Construction 6.4 (GGM PRF)</strong></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext mathvariant="italic">in</mtext></msup></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>v</mi><mo>:</mo><mo>=</mo><mi>k</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;=&nbsp;arbitrary</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mn>1</mn><mtext>&nbsp;</mtext><mrow><mtext>to&nbsp;</mtext><mtext mathvariant="italic">in</mtext></mrow><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mo>=</mo><mi>λ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>v</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|ll|}\hline
&amp; \underline{F(k,x\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\textit{in}}}\\
&amp; \quad v:=k\\
\text{\textit{in} = arbitrary} &amp;\quad \text{for}\ i=1\ \text{to \textit{in}}:\\
out=\lambda &amp; \qquad \text{if}\ x_i=\textcolor{brown}{0}\ \text{then}\ v:=G_L(v)\\
&amp; \qquad \text{if}\ x_i=\textcolor{brown}{1}\ \text{then}\ v:=G_R(v)\\
&amp; \quad \text{return}\ v\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 10.84em; vertical-align: -5.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.69em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord text"><span class="mord textit">in</span></span><span class="mord">&nbsp;=&nbsp;arbitrary</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal">o</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">λ</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to&nbsp;</span><span class="mord text"><span class="mord textit">in</span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>Claim 6.5</strong><br>
<em>If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is a secure PRG, then Construction 6.4 is a secure PR</em>F.</p>
<p><strong>Proof</strong><br>
We prove the claim using a sequence of hybrids. The number of hybrids in this case depends on the input-length parameter <em>in</em>. The hybrids are defined as follows:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;</mtext><msub><mi mathvariant="script">L</mi><mtext>hyb-d</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>QUERY</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>p</mi><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">d</mtext></mpadded><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>v</mi><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext>d+1</mtext></mpadded><mtext>&nbsp;to&nbsp;</mtext><mi>i</mi><mi>n</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>v</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad \ \ \mathcal{L}_{\text{hyb-d}}\\\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{QUERY}(x):}\\
\quad p:=\text{first} \colorbox{silver}{\textit{d}}\  \text{bits of}\ x\\
\quad \text{if}\  T[p]\ \text{undefined:}\\
\qquad T[p]\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad v:=T[p]\\
\quad \text{for}\ i=\colorbox{silver}{d+1}\ \text{to}\ in: \\
\qquad \text{if}\ x_i=\textcolor{brown}{0}\ \text{then}\ v:=G_L(v)\\
\qquad \text{if}\ x_i=\textcolor{brown}{1}\ \text{then}\ v:=G_R(v)\\
\quad \text{return}\ v\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 21.64em; vertical-align: -10.55em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.09em;"><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 13.05em;"></span><span class="mtable"><span class="vertical-separator" style="height: 21.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.55em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.05em;"><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-d</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.37777em;"></span><span class="stretchy colorbox" style="height: 1.37777em; background-color: silver;"></span></span><span class="" style="top: -3.37777em;"><span class="pstrut" style="height: 3.37777em;"></span><span class="mord boxpad"><span class="mord">d+1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.38333em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 21.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.55em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -22.3em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -24.1em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.55em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>The hybrids differ only in their hard-coded value of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">d</mtext></mpadded></mrow><annotation encoding="application/x-tex">\colorbox{silver}{\textit{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.29444em; vertical-align: -0.3em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span></span></span>. We will show that<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext><mi>F</mi></msubsup><mo>≡</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mn>0</mn></mrow></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mn>1</mn></mrow></msub><mo>≈</mo><mo>⋯</mo><mo>≈</mo><msub><mi mathvariant="script">L</mi><mtext>hyb-in&nbsp;</mtext></msub><mo>≡</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text {prf-real }}^{F} \equiv \mathcal{L}_{\text {hyb- } 0} \approx \mathcal{L}_{\text {hyb- } 1} \approx \cdots \approx \mathcal{L}_{\text {hyb-in }} \equiv \mathcal{L}_{\text {prf-rand }}^{F}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.48312em; vertical-align: 0em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-in&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span><br>
We first start by understanding the behavior of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- } d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for extreme choices of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">d</mtext></mpadded></mrow><annotation encoding="application/x-tex">\colorbox{silver}{\textit{d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.29444em; vertical-align: -0.3em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span></span></span>. Simplifications to the code are shown on the right.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mtext>hyb-0</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>k</mi><mo>:</mo><mo>=</mo><mtext>undefined</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>k</mi><mtext>&nbsp;is&nbsp;alias&nbsp;for&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>ϵ</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>p</mi><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext>0</mtext></mpadded><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;</mtext><mi>p</mi><mo>=</mo><mi>ϵ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;if&nbsp;</mtext><mi>k</mi><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mrow><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>v</mi><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext>1</mtext></mpadded><mtext>&nbsp;to&nbsp;</mtext><mi>i</mi><mi>n</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow><mi>v</mi><mo>:</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>v</mi><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>return&nbsp;&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>In&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>hyb-0</mtext></msub></mstyle><mtext>,&nbsp;we&nbsp;always&nbsp;have&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi><mo>=</mo><mi>ϵ</mi></mstyle><mtext>,</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>so&nbsp;the&nbsp;only&nbsp;entry&nbsp;of&nbsp;T&nbsp;that&nbsp;is&nbsp;accessed</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>is&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>T</mi><mo stretchy="false">[</mo><mi>ϵ</mi><mo stretchy="false">]</mo></mstyle><mtext>.&nbsp;Then&nbsp;renaming&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>T</mi><mo stretchy="false">[</mo><mi>ϵ</mi><mo stretchy="false">]</mo></mstyle><mtext>&nbsp;to&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle><mtext>,&nbsp;we&nbsp;see</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>that&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>hyb-0</mtext></msub><mo>≡</mo><msubsup><mi mathvariant="script">L</mi><mtext>hyb-real</mtext><mi>F</mi></msubsup></mstyle><mtext>.&nbsp;The&nbsp;only&nbsp;difference&nbsp;is</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>when&nbsp;the&nbsp;PRF&nbsp;seed&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">[</mo><mi>ϵ</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mstyle><mtext>&nbsp;is&nbsp;sampled:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;eagerly&nbsp;at&nbsp;initialization&nbsp;time&nbsp;in&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>hyb-real</mtext><mi>F</mi></msubsup></mstyle><mtext>&nbsp;Vs.</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>at&nbsp;the&nbsp;last&nbsp;possible&nbsp;minute&nbsp;in&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>hyb-0</mtext></msub></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad \qquad \qquad \qquad \mathcal{L}_{\text{hyb-0}}\\\hline
\begin{array}{ll}
T:=\text{empty assoc. array} &amp;\qquad k:=\text{undefined}\\
&amp; \qquad//k\text{ is alias for}\ T[\epsilon]\\
\end{array}\\
\begin{array}{ll}
\underline{\text{LOOKUP}(x):}\\
\quad p:=\text{first} \colorbox{silver}{0}\  \text{bits of}\ x &amp;\qquad\ \ p=\epsilon\\
\quad \text{if}\  T[p]\ \text{undefined:} &amp;\qquad\ \  \text{if}\ k\ \text{undefined:}\\
\qquad T[p]\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda &amp; \qquad \qquad k\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\end{array}\\
\left.\begin{array}{l}
\quad v:=T[p]\\
\quad \text{for}\ i=\colorbox{silver}{1}\ \text{to}\ in: \\
\qquad \text{if}\ x_i=\textcolor{brown}{0}\ \text{then}\ v:=G_L(v)\\
\qquad \text{if}\ x_i=\textcolor{brown}{1}\ \text{then}\ v:=G_R(v)\\
\end{array}\right\}v:=F(k,x)\\
\quad \text{return}\ v \qquad \qquad \qquad \qquad \qquad \text{return}\ \ F(k,x)\\\hline
\end{array}
\quad
\begin{array}{l}
\text{In $\mathcal{L}_{\text{hyb-0}}$, we always have $p=\epsilon$,}\\
\text{so the only entry of T that is accessed}\\
\text{is $T[\epsilon]$. Then renaming
$T[\epsilon]$ to $k$, we see}\\
\text{that $\mathcal{L}_{\text{hyb-0}}\equiv\mathcal{L}_{\text{hyb-real}}^F$. The only difference is}\\
\text{when the PRF seed $k(T[\epsilon])$ is sampled:}\\
\text{ eagerly at initialization time in $\mathcal{L}_{\text{hyb-real}}^F$ Vs.}\\
\text{at the last possible minute in $\mathcal{L}_{\text{hyb-0}}$.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 21.64em; vertical-align: -10.55em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.09em;"><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 13.05em;"></span><span class="mtable"><span class="vertical-separator" style="height: 21.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.55em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.05em;"><span class="" style="top: -15.64em;"><span class="pstrut" style="height: 5.85002em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 5.85002em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">undefined</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord">//</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mord text"><span class="mord">&nbsp;is&nbsp;alias&nbsp;for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">ϵ</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span><span class="" style="top: -7.65004em;"><span class="pstrut" style="height: 5.85002em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94444em;"><span class="" style="top: -2.94444em;"><span class="pstrut" style="height: 3.24444em;"></span><span class="stretchy colorbox" style="height: 1.24444em; background-color: silver;"></span></span><span class="" style="top: -3.24444em;"><span class="pstrut" style="height: 3.24444em;"></span><span class="mord boxpad"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">ϵ</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span><span class="" style="top: -0.45002em;"><span class="pstrut" style="height: 5.85002em;"></span><span class="mord"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.94444em;"><span class="" style="top: -2.94444em;"><span class="pstrut" style="height: 3.24444em;"></span><span class="stretchy colorbox" style="height: 1.24444em; background-color: silver;"></span></span><span class="" style="top: -3.24444em;"><span class="pstrut" style="height: 3.24444em;"></span><span class="mord boxpad"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85002em;"><span class="" style="top: -1.36599em;"><span class="pstrut" style="height: 3.816em;"></span><span class="delimsizinginner delim-size4"><span class="">⎭</span></span></span><span class="" style="top: -1.35799em;"><span class="pstrut" style="height: 3.816em;"></span><span class="" style="height: 1.816em; width: 0.889em;"><svg width="0.889em" height="1.8159999999999998em" style="width:0.889em" viewBox="0 0 889 1816" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V1816 H384z M384 0 H504 V1816 H384z"></path></svg></span></span><span class="" style="top: -3.81601em;"><span class="pstrut" style="height: 3.816em;"></span><span class="delimsizinginner delim-size4"><span class="">⎬</span></span></span><span class="" style="top: -4.95801em;"><span class="pstrut" style="height: 3.816em;"></span><span class="" style="height: 1.816em; width: 0.889em;"><svg width="0.889em" height="1.8159999999999998em" style="width:0.889em" viewBox="0 0 889 1816" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V1816 H384z M384 0 H504 V1816 H384z"></path></svg></span></span><span class="" style="top: -6.76602em;"><span class="pstrut" style="height: 3.816em;"></span><span class="delimsizinginner delim-size4"><span class="">⎫</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35002em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span class="" style="top: 4.16em;"><span class="pstrut" style="height: 5.85002em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 21.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.55em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -22.3em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -24.1em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.55em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">In&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">,&nbsp;we&nbsp;always&nbsp;have&nbsp;</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">ϵ</span><span class="mord">,</span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">so&nbsp;the&nbsp;only&nbsp;entry&nbsp;of&nbsp;T&nbsp;that&nbsp;is&nbsp;accessed</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">is&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">ϵ</span><span class="mclose">]</span><span class="mord">.&nbsp;Then&nbsp;renaming&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">ϵ</span><span class="mclose">]</span><span class="mord">&nbsp;to&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mord">,&nbsp;we&nbsp;see</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">that&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">.&nbsp;The&nbsp;only&nbsp;difference&nbsp;is</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">when&nbsp;the&nbsp;PRF&nbsp;seed&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">ϵ</span><span class="mclose">])</span><span class="mord">&nbsp;is&nbsp;sampled:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;eagerly&nbsp;at&nbsp;initialization&nbsp;time&nbsp;in&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;Vs.</span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">at&nbsp;the&nbsp;last&nbsp;possible&nbsp;minute&nbsp;in&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb</mtext><mo>−</mo><mi>i</mi><mi>n</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6600em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>p</mi><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">in</mtext></mpadded><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;</mtext><mi>p</mi><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>v</mi><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mrow><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mrow><mtext mathvariant="italic">in</mtext><mtext>+1</mtext></mrow></mpadded><mtext>&nbsp;to&nbsp;</mtext><mi>i</mi><mi>n</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">}</mo></mrow><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mtext mathvariant="italic">unreachable</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>v</mi><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>return&nbsp;&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>In&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb</mtext><mo>−</mo><mi>i</mi><mi>n</mi></mrow></msub></mstyle><mtext>,&nbsp;we&nbsp;always&nbsp;have&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi><mo>=</mo><mi>x</mi></mstyle><mtext>,</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>and&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;forloop&nbsp;is&nbsp;always</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>unreachable.&nbsp;In&nbsp;that&nbsp;case,&nbsp;it&nbsp;is&nbsp;easy&nbsp;to</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;see&nbsp;that&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb</mtext><mo>−</mo><mi>i</mi><mi>n</mi></mrow></msub></mstyle><mtext>&nbsp;has&nbsp;identical&nbsp;behavior&nbsp;to</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad \qquad \qquad \qquad \mathcal{L}_{\text{hyb}-in}\\\hline
\begin{array}{ll}
T:=\text{empty assoc. array} &amp;\\
&amp;\\
\end{array}\\
\begin{array}{ll}
\underline{\text{LOOKUP}(x):}\\
\quad p:=\text{first} \colorbox{silver}{\textit{in}}\  \text{bits of}\ x &amp;\qquad\ \ p=x\\
\quad \text{if}\  T[p]\ \text{undefined:} &amp;\qquad\ \  \text{if}\ T[x]\ \text{undefined:}\\
\qquad T[p]\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda &amp; \qquad \qquad T[x]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad v:=T[p]\\
\end{array}\\
\left.\begin{array}{l}
\quad \text{for}\ i=\colorbox{silver}{\textit{in}+1}\ \text{to}\ in: \\
\qquad \text{if}\ x_i=\textcolor{brown}{0}\ \text{then}\ v:=G_L(v)\\
\qquad \text{if}\ x_i=\textcolor{brown}{1}\ \text{then}\ v:=G_R(v)\\
\end{array}\right\}// \textit{unreachable}\\
\quad \text{return}\ v \qquad \qquad \qquad \qquad \qquad \text{return}\ \ T[x]\\\hline
\end{array}
\quad
\begin{array}{l}
\text{In $\mathcal{L}_{\text{hyb}-in}$, we always have $p=x$,}\\
\text{and the body of the forloop is always}\\
\text{unreachable. In that case, it is easy to}\\
\text{ see that $\mathcal{L}_{\text{hyb}-in}$ has identical behavior to}\\
\text{ $\mathcal{L}_{\text{prf-rand}}^F$.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 21.64em; vertical-align: -10.55em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.09em;"><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 13.05em;"></span><span class="mtable"><span class="vertical-separator" style="height: 21.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.55em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.05em;"><span class="" style="top: -16.54em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span><span class="" style="top: -7.65002em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="stretchy colorbox" style="height: 1.26786em; background-color: silver;"></span></span><span class="" style="top: -3.26786em;"><span class="pstrut" style="height: 3.26786em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mord"><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.96786em;"><span class="" style="top: -2.96786em;"><span class="pstrut" style="height: 3.35119em;"></span><span class="stretchy colorbox" style="height: 1.35119em; background-color: silver;"></span></span><span class="" style="top: -3.35119em;"><span class="pstrut" style="height: 3.35119em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">in</span></span><span class="mord">+1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.38333em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95002em;"><span class="" style="top: -1.59999em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎭</span></span></span><span class="" style="top: -1.59199em;"><span class="pstrut" style="height: 3.15em;"></span><span class="" style="height: 0.916em; width: 0.889em;"><svg width="0.889em" height="0.9159999999999999em" style="width:0.889em" viewBox="0 0 889 916" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V916 H384z M384 0 H504 V916 H384z"></path></svg></span></span><span class="" style="top: -3.15001em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎬</span></span></span><span class="" style="top: -4.29201em;"><span class="pstrut" style="height: 3.15em;"></span><span class="" style="height: 0.916em; width: 0.889em;"><svg width="0.889em" height="0.9159999999999999em" style="width:0.889em" viewBox="0 0 889 916" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V916 H384z M384 0 H504 V916 H384z"></path></svg></span></span><span class="" style="top: -5.20002em;"><span class="pstrut" style="height: 3.15em;"></span><span class="delimsizinginner delim-size4"><span class="">⎫</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45002em;"><span class=""></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">//</span><span class="mord text"><span class="mord textit">unreachable</span></span></span></span><span class="" style="top: 3.26002em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 21.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.55em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -22.3em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -24.1em;"><span class="pstrut" style="height: 13.05em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.55em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">In&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">,&nbsp;we&nbsp;always&nbsp;have&nbsp;</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">x</span><span class="mord">,</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">and&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;forloop&nbsp;is&nbsp;always</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">unreachable.&nbsp;In&nbsp;that&nbsp;case,&nbsp;it&nbsp;is&nbsp;easy&nbsp;to</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;see&nbsp;that&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;has&nbsp;identical&nbsp;behavior&nbsp;to</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p>The general pattern is that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-&nbsp;</mtext><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {hyb- } d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-&nbsp;</span></span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> “chops off” the top <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">d</span></span></span></span></span> levels of the conceptual binary tree. When computing the output for some string <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>, we don’t start traversing the tree from the root but rather <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">d</span></span></span></span></span> levels down the tree, at the node whose position is the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">d</span></span></span></span></span>-bit prefix of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> (called <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span></span> in the library). We initialize the label of this node as a uniform value (unless it has already been defined), and then continue the traversal to the leaf <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>.</p>
<p>To finish the proof, we show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mrow><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">b</mi></mrow><mo>−</mo><mo stretchy="false">(</mo><mi>d</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\mathrm{hyb}-(d-1)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">d</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mrow><mi mathvariant="normal">h</mi><mi mathvariant="normal">y</mi><mi mathvariant="normal">b</mi></mrow><mo>−</mo><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\mathrm{hyb}-d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">hyb</span></span><span class="mbin mtight">−</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> are indistinguishable:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>p</mi><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext>d-1</mtext></mpadded><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>T</mtext></mpadded><mo stretchy="false">[</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>T</mtext></mpadded><mo stretchy="false">[</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>1</mn></mstyle><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>:=&nbsp;first</mtext></mpadded><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext>d</mtext></mpadded><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mrow><mtext mathvariant="italic">v</mtext><mtext>&nbsp;:=</mtext></mrow></mpadded><mi>T</mi><mo stretchy="false">[</mo><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mrow><mtext mathvariant="italic">d</mtext><mtext>&nbsp;+1</mtext></mrow></mpadded><mtext>&nbsp;to&nbsp;</mtext><mi>i</mi><mi>n</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>v</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>The&nbsp;library&nbsp;that&nbsp;is&nbsp;shown&nbsp;here&nbsp;is&nbsp;different&nbsp;from</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mo stretchy="false">(</mo><mi>d</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mtext>in&nbsp;the&nbsp;highlighted&nbsp;parts.&nbsp;However,&nbsp;these&nbsp;differences</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>have&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;calling&nbsp;program.&nbsp;The&nbsp;library&nbsp;here</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>advances&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>d</mi><mo>−</mo><mn>1</mn></mstyle><mtext>&nbsp;levels&nbsp;down&nbsp;the&nbsp;tree&nbsp;(to&nbsp;the&nbsp;node&nbsp;at&nbsp;location&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle><mtext>),</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>initializes&nbsp;that&nbsp;node’s&nbsp;label&nbsp;as&nbsp;a&nbsp;uniform&nbsp;value,&nbsp;then</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>computes&nbsp;the&nbsp;labels&nbsp;for&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi><mi>o</mi><mi>t</mi><mi>h</mi></mstyle><mtext>&nbsp;its&nbsp;children,&nbsp;and&nbsp;finally&nbsp;continues&nbsp;computing</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>labels&nbsp;toward&nbsp;the&nbsp;leaf.&nbsp;The&nbsp;only&nbsp;significant&nbsp;difference&nbsp;from</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hyb-</mtext><mo stretchy="false">(</mo><mi>d</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mrow><mtext>is&nbsp;that&nbsp;it&nbsp;computes&nbsp;the&nbsp;labels&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi><mi>o</mi><mi>t</mi><mi>h</mi></mstyle><mtext>&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>p</mi></mstyle><mtext>’s&nbsp;children,&nbsp;even</mtext></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>though&nbsp;only&nbsp;one&nbsp;is&nbsp;on&nbsp;the&nbsp;path&nbsp;to&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle><mtext>.&nbsp;Since&nbsp;it&nbsp;computes&nbsp;the&nbsp;label</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>correctly,&nbsp;though,&nbsp;it&nbsp;makes&nbsp;no&nbsp;difference&nbsp;when&nbsp;(or&nbsp;if)&nbsp;this</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>extra&nbsp;label&nbsp;is&nbsp;computed.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{LOOKUP}(x):}\\
\quad p:=\text{first} \colorbox{silver}{d-1}\  \text{bits of}\ x\\
\quad \text{if}\  T[p]\ \text{undefined:}\\
\qquad T[p]\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\qquad \colorbox{yellow}{T}[p\|\textcolor{brown}{0}]:=G_L(T[p])\\
\qquad \colorbox{yellow}{T}[p\|\textcolor{brown}{1}]:=G_R(T[p])\\
\quad p' \colorbox{yellow}{:= \text{first}} \colorbox{silver}{d}\ \text{bits of}\ x\\
\quad \colorbox{yellow}{\textit{v} :=}T[p']\\
\quad \text{for}\ i=\colorbox{silver}{\textit{d} +1}\ \text{to}\ in: \\
\qquad \text{if}\ x_i=\textcolor{brown}{0}\ \text{then}\ v:=G_L(v)\\
\qquad \text{if}\ x_i=\textcolor{brown}{1}\ \text{then}\ v:=G_R(v)\\
\quad \text{return}\ v\\\hline
\end{array}
\quad
\begin{array}{l}
\text{The library that is shown here is different from}\\
\mathcal{L}_{\text{hyb-}(d-1)}\text{in the highlighted parts. However, these differences}\\
\text{have no effect on the calling program. The library here}\\
\text{advances $d- 1$ levels down the tree (to the node at location $p$),}\\
\text{initializes that node’s label as a uniform value, then}\\
\text{computes the labels for $both$ its children, and finally continues computing}\\
\text{labels toward the leaf. The only significant difference from}\\
\mathcal{L}_{\text{hyb-}(d-1)}\text{is that it computes the labels of $both$ of $p$’s children, even}\\
\text{though only one is on the path to $x$. Since it computes the label}\\
\text{correctly, though, it makes no difference when (or if) this}\\
\text{extra label is computed.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 25.24em; vertical-align: -12.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 12.89em;"><span class="" style="top: -14.85em;"><span class="pstrut" style="height: 14.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 25.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -12.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 12.85em;"><span class="" style="top: -14.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -13.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord">d-1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.98333em;"><span class="" style="top: -2.98333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="stretchy colorbox" style="height: 1.28333em; background-color: yellow;"></span></span><span class="" style="top: -3.28333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="mord boxpad"><span class="mord">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">0</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">])</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.98333em;"><span class="" style="top: -2.98333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="stretchy colorbox" style="height: 1.28333em; background-color: yellow;"></span></span><span class="" style="top: -3.28333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="mord boxpad"><span class="mord">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">])</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord">:=&nbsp;</span><span class="mord text"><span class="mord">first</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.73056em;"><span class="" style="top: -2.73056em;"><span class="pstrut" style="height: 3.03056em;"></span><span class="stretchy colorbox" style="height: 1.03056em; background-color: yellow;"></span></span><span class="" style="top: -3.03056em;"><span class="pstrut" style="height: 3.03056em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">v</span></span><span class="mord">&nbsp;:=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.37777em;"></span><span class="stretchy colorbox" style="height: 1.37777em; background-color: silver;"></span></span><span class="" style="top: -3.37777em;"><span class="pstrut" style="height: 3.37777em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span><span class="mord">&nbsp;+1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.38333em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 12.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 25.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -12.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 14.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -27.7em;"><span class="pstrut" style="height: 14.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 12.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 10.15em;"><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">The&nbsp;library&nbsp;that&nbsp;is&nbsp;shown&nbsp;here&nbsp;is&nbsp;different&nbsp;from</span></span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">d</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mord text"><span class="mord">in&nbsp;the&nbsp;highlighted&nbsp;parts.&nbsp;However,&nbsp;these&nbsp;differences</span></span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">have&nbsp;no&nbsp;effect&nbsp;on&nbsp;the&nbsp;calling&nbsp;program.&nbsp;The&nbsp;library&nbsp;here</span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">advances&nbsp;</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1&nbsp;levels&nbsp;down&nbsp;the&nbsp;tree&nbsp;(to&nbsp;the&nbsp;node&nbsp;at&nbsp;location&nbsp;</span><span class="mord mathnormal">p</span><span class="mord">),</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">initializes&nbsp;that&nbsp;node’s&nbsp;label&nbsp;as&nbsp;a&nbsp;uniform&nbsp;value,&nbsp;then</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">computes&nbsp;the&nbsp;labels&nbsp;for&nbsp;</span><span class="mord mathnormal">b</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord">&nbsp;its&nbsp;children,&nbsp;and&nbsp;finally&nbsp;continues&nbsp;computing</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">labels&nbsp;toward&nbsp;the&nbsp;leaf.&nbsp;The&nbsp;only&nbsp;significant&nbsp;difference&nbsp;from</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hyb-</span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">d</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mord text"><span class="mord">is&nbsp;that&nbsp;it&nbsp;computes&nbsp;the&nbsp;labels&nbsp;of&nbsp;</span><span class="mord mathnormal">b</span><span class="mord mathnormal">o</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord">&nbsp;of&nbsp;</span><span class="mord mathnormal">p</span><span class="mord">’s&nbsp;children,&nbsp;even</span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">though&nbsp;only&nbsp;one&nbsp;is&nbsp;on&nbsp;the&nbsp;path&nbsp;to&nbsp;</span><span class="mord mathnormal">x</span><span class="mord">.&nbsp;Since&nbsp;it&nbsp;computes&nbsp;the&nbsp;label</span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">correctly,&nbsp;though,&nbsp;it&nbsp;makes&nbsp;no&nbsp;difference&nbsp;when&nbsp;(or&nbsp;if)&nbsp;this</span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">extra&nbsp;label&nbsp;is&nbsp;computed.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 9.65em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>p</mi><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mrow><mtext mathvariant="italic">d</mtext><mtext>-1</mtext></mrow></mpadded><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>T</mtext></mpadded><mo stretchy="false">[</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo stretchy="false">]</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">∣</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">∣</mo><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>1</mn></mstyle><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mtext>QUERY()</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">d</mtext></mpadded><mo>+</mo><mn>1</mn><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>v</mi><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mrow><mtext mathvariant="italic">d</mtext><mtext>&nbsp;</mtext></mrow></mpadded><mo>+</mo><mn>1</mn><mtext>&nbsp;to&nbsp;</mtext><mi>i</mi><mi>n</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>v</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prg-real</mtext><mi>G</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>QUERY():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>s</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>G</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;factored&nbsp;out&nbsp;the&nbsp;body</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>of&nbsp;the&nbsp;if-statement&nbsp;in&nbsp;terms&nbsp;of</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prg-real</mtext><mi>G</mi></msubsup><mtext>since&nbsp;it&nbsp;involves&nbsp;an&nbsp;call</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>to&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>G</mi></mstyle><mtext>&nbsp;on&nbsp;uniform&nbsp;input.&nbsp;Importantly,</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>the&nbsp;seed&nbsp;to&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>G</mi></mstyle><mtext>&nbsp;(called&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo></mstyle><mtext>&nbsp;in&nbsp;the&nbsp;previous</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>hybrid)&nbsp;was&nbsp;not&nbsp;used&nbsp;anywhere&nbsp;else&nbsp;—</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>it&nbsp;was&nbsp;a&nbsp;string&nbsp;of&nbsp;length&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>d</mi><mo>−</mo><mn>1</mn></mstyle><mtext>&nbsp;while</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>the&nbsp;library&nbsp;only&nbsp;reads&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>T</mi><mo stretchy="false">[</mo><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">]</mo></mstyle><mtext>&nbsp;for&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mstyle><mtext>&nbsp;of</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>ength&nbsp;d.&nbsp;The&nbsp;change&nbsp;has&nbsp;no&nbsp;effect</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>on&nbsp;the&nbsp;calling&nbsp;program.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{LOOKUP}(x):}\\
\quad p:=\text{first} \colorbox{silver}{\textit{d}-1}\  \text{bits of}\ x\\
\quad \text{if}\  T[p]\ \text{undefined:}\\
\qquad \colorbox{yellow}{T}[p\|\textcolor{brown}{0}]\Big|\Big|T[p\|\textcolor{brown}{1}]:=\text{QUERY()}\\
\quad p':=\text{first} \colorbox{silver}{\textit{d}}+1\ \text{bits of}\ x\\
\quad v:=T[p']\\
\quad \text{for}\ i=\colorbox{silver}{\textit{d} }+1\ \text{to}\ in: \\
\qquad \text{if}\ x_i=\textcolor{brown}{0}\ \text{then}\ v:=G_L(v)\\
\qquad \text{if}\ x_i=\textcolor{brown}{1}\ \text{then}\ v:=G_R(v)\\
\quad \text{return}\ v\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\quad\mathcal{L}_{\text{prg-real}}^G\\\hline
\underline{\text{QUERY():}}\\
\quad s\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad \text{return}\ G(s)\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have factored out the body}\\
\text{of the if-statement in terms of}\\
\mathcal{L}_{\text{prg-real}}^G\text{since it involves an call}\\
\text{to $G$ on uniform input. Importantly,}\\
\text{the seed to $G$ (called $T[p]$ in the previous}\\
\text{hybrid) was not used anywhere else —}\\
\text{it was a string of length $d - 1$ while}\\
\text{the library only reads $T[p']$ for $p'$ of}\\
\text{ength d. The change has no effect}\\
\text{on the calling program.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 21.75em; vertical-align: -10.605em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.145em;"><span class="" style="top: -13.105em;"><span class="pstrut" style="height: 13.105em;"></span><span class="mtable"><span class="vertical-separator" style="height: 21.71em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.605em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.105em;"><span class="" style="top: -13.105em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -11.305em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -9.50501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -7.70501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span><span class="mord">-1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -5.90501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -4.10501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.98333em;"><span class="" style="top: -2.98333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="stretchy colorbox" style="height: 1.28333em; background-color: yellow;"></span></span><span class="" style="top: -3.28333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="mord boxpad"><span class="mord">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">0</span><span class="mclose">]</span><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.162em;"><span class="" style="top: -1.966em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="delimsizinginner delim-size1"><span class="">∣</span></span></span><span class="" style="top: -2.564em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="" style="height: 0.61601em; width: 0.333em;"><svg width="0.333em" height="0.61601em" style="width:0.333em" viewBox="0 0 333 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span class="" style="top: -3.17201em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="delimsizinginner delim-size1"><span class="">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.650015em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.162em;"><span class="" style="top: -1.966em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="delimsizinginner delim-size1"><span class="">∣</span></span></span><span class="" style="top: -2.564em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="" style="height: 0.61601em; width: 0.333em;"><svg width="0.333em" height="0.61601em" style="width:0.333em" viewBox="0 0 333 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span class="" style="top: -3.17201em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="delimsizinginner delim-size1"><span class="">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.650015em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">QUERY()</span></span></span></span><span class="" style="top: -2.19499em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -0.394993em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: 1.40501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span><span class="mord">&nbsp;</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 3.20501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 5.00501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 6.80501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.605em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 21.71em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.605em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.105em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -24.21em;"><span class="pstrut" style="height: 13.105em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.605em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 18em; vertical-align: -8.75em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;factored&nbsp;out&nbsp;the&nbsp;body</span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">of&nbsp;the&nbsp;if-statement&nbsp;in&nbsp;terms&nbsp;of</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord text"><span class="mord">since&nbsp;it&nbsp;involves&nbsp;an&nbsp;call</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">to&nbsp;</span><span class="mord mathnormal">G</span><span class="mord">&nbsp;on&nbsp;uniform&nbsp;input.&nbsp;Importantly,</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;seed&nbsp;to&nbsp;</span><span class="mord mathnormal">G</span><span class="mord">&nbsp;(called&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mord">&nbsp;in&nbsp;the&nbsp;previous</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">hybrid)&nbsp;was&nbsp;not&nbsp;used&nbsp;anywhere&nbsp;else&nbsp;—</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">it&nbsp;was&nbsp;a&nbsp;string&nbsp;of&nbsp;length&nbsp;</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1&nbsp;while</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;library&nbsp;only&nbsp;reads&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mord">&nbsp;for&nbsp;</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord">&nbsp;of</span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">ength&nbsp;d.&nbsp;The&nbsp;change&nbsp;has&nbsp;no&nbsp;effect</span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">on&nbsp;the&nbsp;calling&nbsp;program.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>p</mi><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mrow><mrow><mtext mathvariant="italic">d</mtext><mtext>&nbsp;</mtext></mrow><mtext>-1</mtext></mrow></mpadded><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo stretchy="false">]</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">∣</mo><mo fence="false" stretchy="true" minsize="1.8em" maxsize="1.8em">∣</mo><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>1</mn></mstyle><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mtext>QUERY()</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">d</mtext></mpadded><mo>+</mo><mn>1</mn><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>v</mi><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">d</mtext></mpadded><mo>+</mo><mn>1</mn><mtext>&nbsp;to&nbsp;</mtext><mi>i</mi><mi>n</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>v</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mo>⋄</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>&nbsp;&nbsp;</mtext><msubsup><mi mathvariant="script">L</mi><mtext>prg-rand</mtext><mi>G</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>QUERY():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>λ</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>We&nbsp;have&nbsp;applied&nbsp;the&nbsp;security</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mrow><mtext>of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>G</mi></mstyle><mtext>&nbsp;and&nbsp;replaced</mtext></mrow><msub><mi mathvariant="script">L</mi><mtext>prg-real</mtext></msub><mtext>&nbsp;with</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="script">L</mi><mtext>prg-rand</mtext></msub><mi mathvariant="normal">.</mi><mtext>The&nbsp;change&nbsp;is&nbsp;indistinguishable.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{LOOKUP}(x):}\\
\quad p:=\text{first} \colorbox{silver}{\textit{d }-1}\  \text{bits of}\ x\\
\quad \text{if}\  T[p]\ \text{undefined:}\\
\qquad T[p\|\textcolor{brown}{0}]\Big|\Big|T[p\|\textcolor{brown}{1}]:=\text{QUERY()}\\
\quad p':=\text{first} \colorbox{silver}{\textit{d}}+1\ \text{bits of}\ x\\
\quad v:=T[p']\\
\quad \text{for}\ i=\colorbox{silver}{\textit{d}}+1\ \text{to}\ in: \\
\qquad \text{if}\ x_i=\textcolor{brown}{0}\ \text{then}\ v:=G_L(v)\\
\qquad \text{if}\ x_i=\textcolor{brown}{1}\ \text{then}\ v:=G_R(v)\\
\quad \text{return}\ v\\\hline
\end{array}
\diamond
\begin{array}{|l|}\hline
\quad\ \ \mathcal{L}_{\text{prg-rand}}^G\\\hline
\underline{\text{QUERY():}}\\
\quad r\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2\lambda}\\
\quad \text{return}\ r\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have applied the security}\\
\text{of $G$ and replaced} \mathcal{L}_{\text{prg-real}}\ \text{with}\\
\mathcal{L}_{\text{prg-rand}}. \text{The change is indistinguishable.}\\
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 21.75em; vertical-align: -10.605em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.145em;"><span class="" style="top: -13.105em;"><span class="pstrut" style="height: 13.105em;"></span><span class="mtable"><span class="vertical-separator" style="height: 21.71em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.605em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.105em;"><span class="" style="top: -13.105em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -11.305em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -9.50501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -7.70501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d&nbsp;</span></span><span class="mord">-1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -5.90501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -4.10501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">0</span><span class="mclose">]</span><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.162em;"><span class="" style="top: -1.966em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="delimsizinginner delim-size1"><span class="">∣</span></span></span><span class="" style="top: -2.564em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="" style="height: 0.61601em; width: 0.333em;"><svg width="0.333em" height="0.61601em" style="width:0.333em" viewBox="0 0 333 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span class="" style="top: -3.17201em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="delimsizinginner delim-size1"><span class="">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.650015em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.162em;"><span class="" style="top: -1.966em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="delimsizinginner delim-size1"><span class="">∣</span></span></span><span class="" style="top: -2.564em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="" style="height: 0.61601em; width: 0.333em;"><svg width="0.333em" height="0.61601em" style="width:0.333em" viewBox="0 0 333 616" preserveAspectRatio="xMinYMin"><path d="M145 0 H188 V616 H145z M145 0 H188 V616 H145z"></path></svg></span></span><span class="" style="top: -3.17201em;"><span class="pstrut" style="height: 2.61601em;"></span><span class="delimsizinginner delim-size1"><span class="">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.650015em;"><span class=""></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">QUERY()</span></span></span></span><span class="" style="top: -2.19499em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -0.394993em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: 1.40501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 3.20501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 5.00501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 6.80501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.605em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 21.71em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -10.605em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.105em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -24.21em;"><span class="pstrut" style="height: 13.105em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 10.605em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 7.24em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">QUERY():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;applied&nbsp;the&nbsp;security</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">of&nbsp;</span><span class="mord mathnormal">G</span><span class="mord">&nbsp;and&nbsp;replaced</span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">with</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span><span class="mord text"><span class="mord">The&nbsp;change&nbsp;is&nbsp;indistinguishable.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>p</mi><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mrow><mtext mathvariant="italic">d</mtext><mtext>&nbsp;-1</mtext></mrow></mpadded><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>T</mtext></mpadded><mo stretchy="false">[</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>T</mtext></mpadded><mo stretchy="false">[</mo><mi>p</mi><mi mathvariant="normal">∥</mi><mstyle mathcolor="brown"><mn>1</mn></mstyle><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>:</mo><mo>=</mo><mtext>first</mtext><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">d</mtext></mpadded><mo>+</mo><mn>1</mn><mtext>&nbsp;bits&nbsp;of&nbsp;</mtext><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>v</mi><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="silver"><mtext mathvariant="italic">d</mtext></mpadded><mo>+</mo><mn>1</mn><mtext>&nbsp;to&nbsp;</mtext><mi>i</mi><mi>n</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>L</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mtext>&nbsp;then&nbsp;</mtext><mi>v</mi><mo>:</mo><mo>=</mo><msub><mi>G</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>v</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>v</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>We&nbsp;have&nbsp;inlined&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>prg-rand</mtext></msub></mstyle><mtext>&nbsp;and&nbsp;split&nbsp;the&nbsp;sampling&nbsp;of&nbsp;2</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>λ</mi></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>bits&nbsp;into&nbsp;two&nbsp;separate&nbsp;statements&nbsp;sampling&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>λ</mi></mstyle><mtext>&nbsp;bits&nbsp;each.</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>In&nbsp;this&nbsp;library,&nbsp;we&nbsp;advance&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>d</mi></mstyle><mtext>&nbsp;levels&nbsp;down&nbsp;the&nbsp;tree,&nbsp;assign</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>a&nbsp;uniform&nbsp;label&nbsp;to&nbsp;a&nbsp;node&nbsp;(and&nbsp;its&nbsp;sibling),&nbsp;and&nbsp;then&nbsp;proceed</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>to&nbsp;the&nbsp;leaf&nbsp;applying&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>G</mi></mstyle><mtext>&nbsp;as&nbsp;usual.&nbsp;The&nbsp;only&nbsp;difference</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>between&nbsp;this&nbsp;library&nbsp;and&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>hby-d</mtext></msub></mstyle><mtext>&nbsp;is&nbsp;that&nbsp;we&nbsp;sample&nbsp;the&nbsp;label</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>of&nbsp;a&nbsp;node&nbsp;that&nbsp;is&nbsp;not&nbsp;on&nbsp;our&nbsp;direct&nbsp;path.&nbsp;But&nbsp;since&nbsp;we</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>sample&nbsp;it&nbsp;uniformly,&nbsp;it&nbsp;doesn’t&nbsp;matter&nbsp;when&nbsp;(or&nbsp;if)&nbsp;that</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>extra&nbsp;value&nbsp;is&nbsp;sampled.&nbsp;Hence,&nbsp;this&nbsp;library&nbsp;has&nbsp;identical</mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>behavior&nbsp;to&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="script">L</mi><mtext>hby-d</mtext></msub></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{LOOKUP}(x):}\\
\quad p:=\text{first} \colorbox{silver}{\textit{d} -1}\  \text{bits of}\ x\\
\quad \text{if}\  T[p]\ \text{undefined:}\\
\qquad \colorbox{yellow}{T}[p\|\textcolor{brown}{0}]\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\qquad \colorbox{yellow}{T}[p\|\textcolor{brown}{1}]\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad p':=\text{first} \colorbox{silver}{\textit{d}}+1\ \text{bits of}\ x\\
\quad v:=T[p']\\
\quad \text{for}\ i=\colorbox{silver}{\textit{d}}+1\ \text{to}\ in: \\
\qquad \text{if}\ x_i=\textcolor{brown}{0}\ \text{then}\ v:=G_L(v)\\
\qquad \text{if}\ x_i=\textcolor{brown}{1}\ \text{then}\ v:=G_R(v)\\
\quad \text{return}\ v\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have inlined $\mathcal{L}_{\text{prg-rand}}$ and split the sampling of 2$\lambda$}\\
\text{bits into two separate statements sampling  $\lambda$ bits each.}\\
\text{In this library, we advance $d$ levels down the tree, assign}\\
\text{a uniform label to a node (and its sibling), and then proceed}\\
\text{to the leaf applying $G$ as usual. The only difference}\\
\text{between this library and $\mathcal{L}_{\text{hby-d}}$ is that we sample the label}\\
\text{of a node that is not on our direct path. But since we}\\
\text{sample it uniformly, it doesn’t matter when (or if) that}\\
\text{extra value is sampled. Hence, this library has identical}\\
\text{behavior to $\mathcal{L}_{\text{hby-d}}$.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 23.44em; vertical-align: -11.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.99em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 13.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 23.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -11.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.95em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span><span class="mord">&nbsp;-1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.98333em;"><span class="" style="top: -2.98333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="stretchy colorbox" style="height: 1.28333em; background-color: yellow;"></span></span><span class="" style="top: -3.28333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="mord boxpad"><span class="mord">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">0</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.98333em;"><span class="" style="top: -2.98333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="stretchy colorbox" style="height: 1.28333em; background-color: yellow;"></span></span><span class="" style="top: -3.28333em;"><span class="pstrut" style="height: 3.28333em;"></span><span class="mord boxpad"><span class="mord">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal">p</span><span class="mord">∥</span><span class="mord" style="color: brown;">1</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">first</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">bits&nbsp;of</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">x</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: silver;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord text"><span class="mord textit">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">to</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">0</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord" style="color: brown;">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">then</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">)</span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 23.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -11.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -25.9em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;inlined&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prg-rand</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;and&nbsp;split&nbsp;the&nbsp;sampling&nbsp;of&nbsp;2</span><span class="mord mathnormal">λ</span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">bits&nbsp;into&nbsp;two&nbsp;separate&nbsp;statements&nbsp;sampling&nbsp;</span><span class="mord mathnormal">λ</span><span class="mord">&nbsp;bits&nbsp;each.</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">In&nbsp;this&nbsp;library,&nbsp;we&nbsp;advance&nbsp;</span><span class="mord mathnormal">d</span><span class="mord">&nbsp;levels&nbsp;down&nbsp;the&nbsp;tree,&nbsp;assign</span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">a&nbsp;uniform&nbsp;label&nbsp;to&nbsp;a&nbsp;node&nbsp;(and&nbsp;its&nbsp;sibling),&nbsp;and&nbsp;then&nbsp;proceed</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">to&nbsp;the&nbsp;leaf&nbsp;applying&nbsp;</span><span class="mord mathnormal">G</span><span class="mord">&nbsp;as&nbsp;usual.&nbsp;The&nbsp;only&nbsp;difference</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">between&nbsp;this&nbsp;library&nbsp;and&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hby-d</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">&nbsp;is&nbsp;that&nbsp;we&nbsp;sample&nbsp;the&nbsp;label</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">of&nbsp;a&nbsp;node&nbsp;that&nbsp;is&nbsp;not&nbsp;on&nbsp;our&nbsp;direct&nbsp;path.&nbsp;But&nbsp;since&nbsp;we</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">sample&nbsp;it&nbsp;uniformly,&nbsp;it&nbsp;doesn’t&nbsp;matter&nbsp;when&nbsp;(or&nbsp;if)&nbsp;that</span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">extra&nbsp;value&nbsp;is&nbsp;sampled.&nbsp;Hence,&nbsp;this&nbsp;library&nbsp;has&nbsp;identical</span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">behavior&nbsp;to&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hby-d</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p>We showed that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mtext>hby</mtext><mo>−</mo><mo stretchy="false">(</mo><mi>d</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mtext>hby-d</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{hby}-(d-1)}\approx \mathcal{L}_{\text{hby-d}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03853em; vertical-align: -0.3552em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.3448em;"><span class="" style="top: -2.5198em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hby</span></span><span class="mbin mtight">−</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">d</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3552em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hby-d</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. Putting everything together, we have:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup><mo>≡</mo><msub><mi mathvariant="script">L</mi><mtext>hby-0</mtext></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mtext>hby-1</mtext></msub><mo>≈</mo><mo>⋯</mo><mo>≈</mo><msub><mi mathvariant="script">L</mi><mtext>hby-in</mtext></msub><mo>≡</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mi>F</mi></msubsup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{prf-real}}^F\equiv\mathcal{L}_{\text{hby-0}}\approx\mathcal{L}_{\text{hby-1}}\approx\cdots\approx \mathcal{L}_{\text{hby-in}}\equiv\mathcal{L}_{\text{prf-rand}}^F.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hby-0</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hby-1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.48312em; vertical-align: 0em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">hby-in</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></span></p>
<p>Hence, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF. <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&nbsp;</mtext><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\ \blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.675em; vertical-align: 0em;"></span><span class="mspace">&nbsp;</span><span class="mord amsrm">■</span></span></span></span></span></p>
<h2 id="block-ciphers-pseudorandom-permutations">6.3 Block Ciphers (Pseudorandom Permutations)</h2>
<p>After fixing the seed of a PRF, it computes a function from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>in&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\text {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>out&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\text {out }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span>. Let’s consider the case where <em>in</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> <em>out</em>. Some functions from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>in&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\text {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>out&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\text {out }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> are invertible, which leads to the question of whether a PRF might realize such a function and be invertible (with knowledge of the seed). In other words, what if it were possible to determine <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> when given <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">F(k, x) ?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)?</span></span></span></span></span> While this would be a convenient property, it is not guaranteed by the PRF security definition, even in the case of <em>in</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> <em>out</em>. A function from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>in&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\text {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>out&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\text {out }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">out&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> chosen at random is unlikely to have an inverse, therefore a PRF instantiated with a random key is unlikely to have an inverse.</p>
<p>A <strong>pseudorandom permutation</strong> <strong>(PRP)</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">−</span></span></span></span></span> also called a <strong>block cipher</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">−</span></span></span></span></span> is essentially a PRF that is guaranteed to be invertible for every choice of seed. We use both terms (PRP and block cipher) interchangeably. The term “permutation” refers to the fact that, for every <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">k,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span></span></span></span></span> the function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k, \cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> should be a permutation of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>i</mi><mi>n</mi></mrow></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{i n} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> Instead of requiring a PRP to be indistinguishable from a randomly chosen function, we require it to be indistinguishable from a randomly chosen <em>invertible</em> function.<sup class="footnote-ref"><a href="#fn2" id="fnref2">2</a></sup>  This means we must modify one of the libraries from the PRF definition. Instead of populating the associative array <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> with uniformly random values, it chooses uniformly random <em>but distinct</em> values. As long as <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> gives distinct outputs on distinct inputs, it is consistent with some invertible function. The library guarantees distinctness by only sampling values that it has not previously assigned. Thinking of an associative array <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> as a key-value store, we use the notation <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">T .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mord">.</span></span></span></span></span> values to denote the set of values stored in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span>.</p>
<p><strong>Definition 6.6 (PRP syntax)</strong></p>
<p><em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>×</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">blen</mtext><mtext>&nbsp;</mtext></mrow></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">blen</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">F:\{0,1\}^{\lambda} \times\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\textit {blen }} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\textit {blen }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">blen&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">blen&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> be a deterministic function. We refer to blen as the <strong>blocklength</strong> of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> and any element of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mtext>blen&nbsp;</mtext></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\text {blen }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">blen&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> as a <strong>block</strong>.</em></p>
<p><em>We call <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> a <strong>secure pseudorandom permutation (PRP) (block cipher)</strong> if the following two conditions hold:</em></p>
<ol>
<li><em>(Invertible given <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> ) There is a function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>×</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">blen</mtext><mtext>&nbsp;</mtext></mrow></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">blen</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">F^{-1}:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \times\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\textit {blen }} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\textit {blen }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">blen&nbsp;</span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">blen&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> satisfying</em><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
F^{-1}(k, F(k, x))=x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.11411em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span></span><br>
for all <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">k \in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.0391em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> and all <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">blen</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">x \in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\textit {blen }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">blen&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>(Security) <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prp-real&nbsp;</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext><mi>F</mi></msubsup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-real }}^{F} \approx \mathcal{L}_{\text {prp-rand }}^{F},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> where</li>
</ol>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prp-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prp-rand</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mi mathvariant="normal">\</mi><mpadded width="+6pt" height="+6pt" lspace="3pt" voffset="3pt" mathbackground="yellow"><mtext>T.values</mtext></mpadded></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{prp-real}}^F\\\hline
k\leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\\\
\underline{\text{LOOKUP}(x\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}):}\\
\quad \text{return}\ F(k,x)\\\hline
\end{array}
\quad
\begin{array}{|l|}\hline
\qquad \qquad \quad\mathcal{L}_{\text{prp-rand}}^F\\\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{LOOKUP}(x\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}):}\\
\quad \text{if}\ T[x]\ \text{undefined:}\\
\qquad T[x]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}\backslash \colorbox{yellow}{T.values}\\
\quad \text{return}\ T[x]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.64em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.79em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 6.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.75em;"><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -4.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 6.75em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 4.25em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.59em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mord">\</span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.99444em;"><span class="" style="top: -2.99444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="stretchy colorbox" style="height: 1.29444em; background-color: yellow;"></span></span><span class="" style="top: -3.29444em;"><span class="pstrut" style="height: 3.29444em;"></span><span class="mord boxpad"><span class="mord">T.values</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.3em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>“T.values” refers to the set <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mi>v</mi><mo>∣</mo><mi mathvariant="normal">∃</mi><mi>x</mi><mo>:</mo><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>=</mo><mi>v</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{v \mid \exists x: T[x]=v\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">∃</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">v</span><span class="mclose">}</span></span></span></span></span>.</p>
<p>The changes from the PRF definition are highlighted in yellow. In particular, the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prp-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> libraries are identical.</p>
<h3 id="discussion-pitfalls-1">Discussion, Pitfalls</h3>
<p>In the definition, both the functions <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> take the seed <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> as input. Therefore, only someone with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> can invert the block cipher. Think back to the definition of a PRF without the seed <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span>, it is hard to compute <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>. A block cipher has a forward and reverse direction, and computing <em>either</em> of them is hard without <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">k !</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">!</span></span></span></span></span></p>
<h2 id="relating-prfs-and-block-ciphers">6.4 Relating PRFs and Block Ciphers</h2>
<p>In this section we discuss how to obtain PRFs from PRPs/block ciphers, and vice-versa.</p>
<h3 id="switching-lemma-prps-are-prfs-too">Switching Lemma (PRPs are PRFs, Too!)</h3>
<p>Imagine you can query a PRP on chosen inputs (as in the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prp-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> library), and suppose the blocklength of the PRP is <em>blen</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">=\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>. You would only be able to query that PRP on a <em>negligible</em> <em>fraction</em> of its exponentially large input domain. It seems unlikely that you would even be able to tell that it was a PRP (i.e., an invertible function) rather than a PRF (an unrestricted function).</p>
<p>This idea can be formalized as follows.</p>
<p><strong>Lemma 6.7 (PRP switching)</strong><br>
<em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> be defined as in Definitions <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6.1</mn><mtext>&nbsp;</mtext><mi mathvariant="normal">&amp;</mi><mtext>&nbsp;</mtext><mn>6.6</mn><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">6.1 \ \&amp; \ 6.6,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">6.1</span><span class="mspace">&nbsp;</span><span class="mord">&amp;</span><span class="mspace">&nbsp;</span><span class="mord">6.6</span><span class="mpunct">,</span></span></span></span></span> with parameters <em>in</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> <em>out</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> blen <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">=\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> (so that the interfaces match up). Then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub><mo>≈</mo><msub><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }} \approx \mathcal{L}_{\text {prp-rand }}.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></em></p>
<p><strong>Proof</strong><br>
Recall the replacement-sampling lemma, Lemma 4.11 , which showed that the following libraries are indistinguishable:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>&nbsp;</mtext><msub><mi mathvariant="script">L</mi><mtext>samp-L</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>SAMP():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>&nbsp;</mtext><msub><mi mathvariant="script">L</mi><mtext>samp-R</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>R</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">∅</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mtext>SAMP():</mtext><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>r</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mi mathvariant="normal">\</mi><mi>R</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>R</mi><mo>:</mo><mo>=</mo><mi>R</mi><mo>∪</mo><mo stretchy="false">{</mo><mi>r</mi><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>r</mi></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\quad\ \mathcal{L}_{\text{samp-L}}\\\hline
\underline{\text{SAMP():}}\\
\quad r\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\
\quad \text{return}\ r\\\hline
\end{array}\quad
\begin{array}{|l|}\hline
\qquad\ \mathcal{L}_{\text{samp-R}}\\\hline
R:=\emptyset\\\\
\underline{\text{SAMP():}}\\
\quad r\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \backslash R\\
\quad R:=R\cup\{r\}\\
\quad \text{return}\ r\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.64em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.89em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">SAMP():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.59em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">∅</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">SAMP():</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mord">\</span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mclose">}</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>samp-L</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{samp-L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> samples values with replacement, and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>samp-R</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{samp-R}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-R</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> samples values without replacement. Now consider the following library <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">L</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal{L}^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;</mtext><msup><mi mathvariant="script">L</mi><mo>∗</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>←</mo><mtext>SAMP()</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad\qquad\ \ \mathcal{L}^*\\\hline
T:=\text{empty assoc. array}\\\\
\underline{\text{LOOKUP}(x\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}):}\\
\quad \text{if}\ T[x]\ \text{undefined:}\\
\qquad T[x]\leftarrow\text{SAMP()}\\
\quad \text{return}\ T[x]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.64em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.59em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">SAMP()</span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span></span></span></span></span></span><br>
When we link <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">L</mi><mo lspace="0em" rspace="0em">∗</mo></msup><mo>⋄</mo><msub><mi mathvariant="script">L</mi><mtext>samp-L</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}^{*} \diamond \mathcal{L}_{\text{samp-L}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-L</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> we obtain <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> since the values in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span></span> are sampled uniformly. When we link <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">L</mi><mo lspace="0em" rspace="0em">∗</mo></msup><mo>⋄</mo><msub><mi mathvariant="script">L</mi><mtext>samp-R&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}^{*} \diamond \mathcal{L}_{\text {samp-R }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-R&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> we obtain <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> since the values in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span></span></span> are sampled uniformly subject to having no repeats (consider <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span></span></span></span></span> playing the role of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">T .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mord">.</span></span></span></span></span> values in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>). Then from Lemma 4.11 , we have:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub><mo>≡</mo><msup><mi mathvariant="script">L</mi><mo lspace="0em" rspace="0em">∗</mo></msup><mo>⋄</mo><msub><mi mathvariant="script">L</mi><mtext>samp-L&nbsp;</mtext></msub><mo>≈</mo><msup><mi mathvariant="script">L</mi><mo lspace="0em" rspace="0em">∗</mo></msup><mo>⋄</mo><msub><mi mathvariant="script">L</mi><mtext>samp-R&nbsp;</mtext></msub><mo>≡</mo><msub><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text {prf-rand }} \equiv \mathcal{L}^{*} \diamond \mathcal{L}_{\text {samp-L }} \approx \mathcal{L}^{*} \diamond \mathcal{L}_{\text {samp-R }} \equiv \mathcal{L}_{\text {prp-rand }},
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.738696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-L&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.738696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-R&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></span><br>
which completes the proof. <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&nbsp;</mtext><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\ \blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.675em; vertical-align: 0em;"></span><span class="mspace">&nbsp;</span><span class="mord amsrm">■</span></span></span></span></span></p>
<p>Using the switching lemma, we can conclude that every PRP (with <em>blen</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">=\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> ) is also a PRF:</p>
<p><strong>Corollary 6.8</strong><br>
<em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>×</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">F:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \times\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> be a secure PRP (with blen <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">=\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> ). Then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is also a secure PRF.</em></p>
<p><strong>Proof</strong><br>
As we have observed above, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}^{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prp-real&nbsp;</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-real }}^{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> are literally the same library. Since <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRP, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prp-real&nbsp;</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext><mi>F</mi></msubsup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-real }}^{F} \approx \mathcal{L}_{\text {prp-rand }}^{F} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> Finally, by the switching lemma, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-rand }}^{F} \approx \mathcal{L}_{\text {prf-rand }}^{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> Putting everything together:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext><mi>F</mi></msubsup><mo>≡</mo><msubsup><mi mathvariant="script">L</mi><mtext>prp-real&nbsp;</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mi>F</mi></msubsup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">
\mathcal{L}_{\text {prf-real }}^{F} \equiv \mathcal{L}_{\text {prp-real }}^{F} \approx \mathcal{L}_{\text {prp-rand }}^{F} \approx \mathcal{L}_{\text {prf-rand }}^{F},
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span></span><br>
hence <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF.</p>
<p>Keep in mind that the switching lemma applies only when the blocklength is sufficiently large (at least <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span> bits long). This comes from the fact that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>samp-L&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {samp-L }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-L&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>samp-R&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {samp-R }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328331em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">samp-R&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> in the proof are indistinguishable only when sampling with long (length-<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>) strings (look at the proof of Lemma 4.11 to recall why). Exercise 6.14 asks you to show that a random permutation over a <em>small domain</em> can be distinguished from a random (unconstrained) function; so, a PRP with a small blocklength is <strong>not</strong> a PRF.</p>
<h3 id="constructing-a-prp-from-a-prf-the-feistel-construction">Constructing a PRP from a PRF: The Feistel Construction</h3>
<p>How can you build an <em>invertible</em> block cipher out of a PRF that is not necessarily invertible? In this section, we show a simple technique called the <strong>Feistel construction</strong> (named after<br>
IBM cryptographer Horst Feistel).</p>
<p>The main idea in the Feistel construction is to convert a not-necessarily-invertible function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>n</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">F:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^n\rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> into an invertible function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>n</mi></mrow></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mn>2</mn><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">F^*:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2n}\rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{2n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span>. The function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">F^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> is called the <strong>Feistel round with round function</strong> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> and is defined as follows:</p>
<p><strong>Construction 6.9 (Feistel round)</strong></p>
<p><img src="https://statics.bsafes.com/images/joy-of-cryptography/No%20matter%20what%20F%20is.png" alt="No matter what F is"></p>
<p>No matter what <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is, its Feistel round <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">F^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> is invertible. Not only that, but its inverse is a kind of “mirror image” of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">F^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>:</p>
<p><img src="https://statics.bsafes.com/images/joy-of-cryptography/Note%20how%20both%20the%20forward.png" alt="Note how both the forward"></p>
<p>Note how both the forward and inverse Feistel rounds use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> in the forward direction!</p>
<p><strong>Example</strong><br>
<em>Let’s see what happens in the Feistel construction with a trivial round function. Consider the constant function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>n</mi></msup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">F(y)=\textcolor{brown}{0}^{n},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.858832em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> which is the "<em>least invertible" function imaginable.</em> The Feistel construction gives:</em><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.2500em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>F</mi><mo lspace="0em" rspace="0em">∗</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>y</mi><mi mathvariant="normal">∥</mi><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>y</mi><mi mathvariant="normal">∥</mi><mrow><mo fence="true">(</mo><msup><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi>n</mi></msup><mo>⊕</mo><mi>x</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>y</mi><mi mathvariant="normal">∥</mi><mi>x</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
F^{*}(x \| y) &amp;=y \|(F(y) \oplus x) \\
&amp;=y \|\left(\textcolor{brown}{0}^{n} \oplus x\right) \\
&amp;=y \| x
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 4.5em; vertical-align: -2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.5em;"><span class="" style="top: -4.66em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span><span class="" style="top: -3.16em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span><span class="" style="top: -1.66em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.5em;"><span class="" style="top: -4.66em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mord">∥</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span class="" style="top: -3.16em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mord">∥</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord" style="color: brown;">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.714392em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">x</span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span><span class="" style="top: -1.66em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mord">∥</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 2em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br>
<em>The result is a function that simply switches the order of its halves - clearly invertible.</em></p>
<p><strong>Example</strong><br>
<em>Let’s try another simple round function, this time the identity function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">F(y)=y .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mord">.</span></span></span></span></span> The Feistel construction gives:</em><br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.2500em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>F</mi><mo lspace="0em" rspace="0em">∗</mo></msup><mo stretchy="false">(</mo><mi>x</mi><mi mathvariant="normal">∥</mi><mi>y</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>y</mi><mi mathvariant="normal">∥</mi><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mi>y</mi><mi mathvariant="normal">∥</mi><mo stretchy="false">(</mo><mi>y</mi><mo>⊕</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{aligned}
F^{*}(x \| y) &amp;=y \|(F(y) \oplus x) \\
&amp;=y \|(y \oplus x)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 3em; vertical-align: -1.25em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span class="" style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span class=""></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.75em;"><span class="" style="top: -3.91em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mord">∥</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span class="" style="top: -2.41em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mord">∥</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></span></span><br>
<em>This function is invertible because given <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>⊕</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">y \oplus x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> we can solve for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> as <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>⊕</mo><mo stretchy="false">(</mo><mi>y</mi><mo>⊕</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">y \oplus(y \oplus x) .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span> You can verify that this is what happens when you plug <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> into the inverse Feistel construction.</em></p>
<p>We can also consider using a round function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> that has a key/seed. The result will be an <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo lspace="0em" rspace="0em">∗</mo></msup></mrow><annotation encoding="application/x-tex">F^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span></span> that also takes a seed. For every seed <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo separator="true">,</mo><msup><mi>F</mi><mo lspace="0em" rspace="0em">∗</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k, F^{*}(k, \cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> will have an inverse (which looks like its mirror image).</p>
<p><strong>Construction 6.10 (Keyed Feistel)</strong></p>
<p><img src="https://statics.bsafes.com/images/joy-of-cryptography/which%20looks%20like%20its%20mirror%20image.png" alt="which looks like its mirror image"></p>
<p>Now suppose <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF and we use it as a Feistel round function, to obtain a<br>
keyed function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">F^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>. Since <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F^*(k,\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> is invertible for every <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span>, and since <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">F^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> uses a secure PRF in some way, you might be tempted to claim that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">F^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> is a secure PRP. Unfortunately, it is not! The output of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">F^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span> contains half of its input, making it quite trivial to break the PRP-security of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo>∗</mo></msup></mrow><annotation encoding="application/x-tex">F^*</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.688696em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span></span></span></span></span>.</p>
<p>We can avoid this trivial attack by performing several Feistel rounds in succession, resulting in a construction called a <strong>Feistel cipher</strong>. At each round, we can even use a<br>
different key to the round function. If we use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">k_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> in the first round, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">k_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> in the second round, and so on, then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>k</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">k_1, k_2,\ldots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span></span></span></span></span> is called the <strong>key schedule</strong> of the Feistel cipher. The formal definition of an r-round Feistel cipher is given below:</p>
<p><strong>Construction 6.11 (Feistel cipher)</strong></p>
<p><img src="https://statics.bsafes.com/images/joy-of-cryptography/Because%20each%20round%20is%20invertible.png" alt="Because each round is invertible"></p>
<p>Because each round is invertible (given the appropriate round key), the overall Feistel cipher is also invertible. Note that the inverse of the Feistel cipher uses inverse Feistel rounds and reverses the order of the key schedule.</p>
<p>Surprisingly, a 3-round Feistel cipher can actually be secure, although a 2-round Feistel cipher is never secure (see the exercises). More precisely: when <em>F</em> is a secure PRF with <em>in = out</em> = <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>, then using <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> as the round function of a 3-round Feistel cipher results in a secure PRP. The Feistel cipher has blocklength <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>λ</mi></mrow><annotation encoding="application/x-tex">2\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">2</span><span class="mord mathnormal">λ</span></span></span></span></span>, and it has a key of length <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mi>λ</mi></mrow><annotation encoding="application/x-tex">3\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">3</span><span class="mord mathnormal">λ</span></span></span></span></span>(3 times longer than the key for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> ). Implicitly, this means that the three round keys are chosen independently.</p>
<p><strong>Theorem 6.12 (Luby-Rackoff)</strong><br>
<em>If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>×</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">F:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \times\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> is a secure PRF, then the 3-round Feistel cipher <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83889em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> (Construction 6.11) is a secure PRP.</em></p>
<p>Unfortunately, the proof of this theorem is beyond the scope of this book.</p>
<h2 id="prfs-and-block-ciphers-in-practice">6.5 PRFs and Block Ciphers in Practice</h2>
<p>Block ciphers are one of the cornerstones of cryptography in practice today. We have shown how (at least in principle) block ciphers can be constructed out of simpler primitives: PRGs and PRFs. However, in practice we use block ciphers that are designed “from scratch,” and then use these block ciphers to construct simpler PRGs and PRFs when we need them.</p>
<p>We currently have <strong>no proof</strong> that any secure PRP exists. As we discussed in Section 5.2, such a proof would resolve the famous P vs NP problem. Without such proofs, what is our<br>
basis for confidence in the security of block ciphers being used today? The process that led to the Advanced Encryption Standard (AES) block cipher demonstrates the cryptographic community’s best efforts at instilling such confidence.</p>
<p>The National Institute of Standards &amp; Technology (NIST) sponsored a competition to design a block cipher to replace the DES standard from the 1970s. Many teams of cryptographers<br>
submitted their block cipher designs, all of which were then subject to years of intense public scrutiny by the cryptographic research community. The designs were evaluated on the basis of their performance and resistance to attacks against the PRP security definition (and other attacks). Some designs did offer proofs that they resist certain <em>classes of attacks</em>, and proofs that justify certain choices in building the block cipher from simpler components.</p>
<p>The Rijndael cipher, designed by Vincent Rijmen and Joan Daemen, was selected as the winner and became the AES standard in 2001. There may not be another cryptographic algorithm that has been the focus of more scrutiny and attempts at attack. So far no significant weaknesses in AES are known.<sup class="footnote-ref"><a href="#fn3" id="fnref3">3</a></sup></p>
<p>The AES block cipher has a blocklength of 128 bits, and offers 3 different variants with 128-bit, 192-bit, and 256-bit keys. As a result of its standardization, AES is available in cryptographic libraries for any programming language. It is even implemented as hardware instructions in most modern processors, allowing millions of AES evaluations per second. As we have seen, once you have access to a good block cipher, it can be used directly also as a secure PRF (Corollary 6.8), and it can be used to construct a simple PRG (Construction 6.2). Even though AES itself is not a <em>provably secure</em> PRP, these constructions of PRFs and PRGs based on AES are secure. Or, more precisely, the PRF-security and PRG-security of these constructions is guaranteed to be as good as the PRP-security of AES.</p>
<h2 id="star-6.6--strong-pseudorandom-permutations"><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋆</mo></mrow><annotation encoding="application/x-tex">\star</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord">⋆</span></span></span></span></span> 6.6  Strong Pseudorandom Permutations</h2>
<p>Since a block cipher <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> has a corresponding inverse <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F ^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>, it is natural to think of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F ^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> as interchangeable in some sense. However, the PRP security definition only guarantees a security property for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> and not its inverse. In the exercises, you will see that it is possible to construct <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> which is a secure PRP, whose inverse <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> is not a secure PRP!</p>
<p>It would be very natural to ask for a PRP whose <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F ^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> are both secure. We will later  see applications where this property would be convenient. An even stronger requirement would allow the distinguisher to query both <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F ^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span> in a <em>single</em> interaction (rather than one security definition where the distinguisher queries only F , and another definition where the distinguisher queries only <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">F ^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.814108em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></span>). If a PRP is indistinguishable from a random permutation under that setting, then we say it is a <strong>strong PRP</strong> (SPRP).</p>
<p>In the formal security definition, we provide the calling program <em>two</em> subroutines: one for forward queries and one for reverse queries. In <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>sprp-real</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{sprp-real}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sprp-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, these subroutines are implemented by calling the PRP or its inverse accordingly. In <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>sprp-rand</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{sprp-rand}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sprp-rand</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, we emulate the behavior of a randomly chosen permutation that can be queried in both directions. We maintain two associative arrays <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{inv}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> to hold the truth tables of these permutations, and sample their values on-demand. The only restriction is that  <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_{inv}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> maintain consistency <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">(T[x]=y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span> if and only if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_{inv}[y]=x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>. This also ensures that they always represent an invertible function. We use the same technique as before to ensure invertibility.</p>
<p><strong>Definition 6.13 (SPRP security)</strong><br>
<em>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>×</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">F:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \times\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span> be a deterministic function. We say that F is a <strong>secure strong pseudorandom permutation (SPRP)</strong> if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>sprp-real</mtext><mi>F</mi></msubsup><mo>≈</mo><msubsup><mi mathvariant="script">L</mi><mtext>sprp-rand</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{sprp-real}}^F\approx \mathcal{L}_{\text{sprp-rand}}^F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sprp-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sprp-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, where</em></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;</mtext><msubsup><mi mathvariant="script">L</mi><mtext>sprp-real</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>k</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>INVLOOKUP</mtext><mo stretchy="false">(</mo><mi>y</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6600em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mtext>&nbsp;&nbsp;</mtext><msubsup><mi mathvariant="script">L</mi><mtext>sprp-rand</mtext><mi>F</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo separator="true">,</mo><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;arrays</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined</mtext><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mi mathvariant="normal">\</mi><mi>T</mi><mi mathvariant="normal">.</mi><mtext>values</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>y</mi><mo separator="true">;</mo><mspace width="1em"></mspace><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>INVLOOKUP</mtext><mo stretchy="false">(</mo><mi>y</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‾</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined</mtext><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>x</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>b</mi><mi>l</mi><mi>e</mi><mi>n</mi></mrow></msup><mi mathvariant="normal">\</mi><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mi mathvariant="normal">.</mi><mtext>values</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>x</mi><mo separator="true">;</mo><mspace width="1em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><msub><mi>T</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad\qquad \ \ \mathcal{L}_{\text{sprp-real}}^F\\\hline
\quad k\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}\\\\
\underline{\text{LOOKUP}(x\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}):}\\
\quad \text{return}\ F(k,x)\\\\
\underline{\text{INVLOOKUP}(y\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}):}\\
\quad \text{return}\ F^{-1}(k,y)\\\hline
\end{array}\quad
\begin{array}{|l|}\hline
\qquad\qquad \ \ \mathcal{L}_{\text{sprp-rand}}^F\\\hline
T,T_{inv}:=\text{empty assoc. arrays}\\\\
\underline{\text{LOOKUP}(x\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}):}\\
\quad \text{if}\ T[x]\ \text{undefined}:\\
\qquad y\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}\backslash T.\text{values}\\
\qquad T[x]:=y;\quad T_{inv}[y]:=x\\
\quad \text{return}\ T[x]\\
\underline{\text{INVLOOKUP}(y\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}):}\\
\quad \text{if}\ T_{inv}[y]\ \text{undefined}:\\
\qquad x\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{blen}\backslash T_{inv}.\text{values}\\
\qquad T_{inv}[y]:=x;\quad T[x]:=y\\
\quad \text{return}\ T_{inv}[y]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 23.44em; vertical-align: -11.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.49em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 9.45em;"></span><span class="mtable"><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.45em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sprp-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">INVLOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 14.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -6.95em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -16.9em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.99em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 13.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 23.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -11.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.95em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">sprp-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;arrays</span></span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mord">\</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mord">.</span><span class="mord text"><span class="mord">values</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">x</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">INVLOOKUP</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="mord mathnormal mtight" style="margin-right: 0.01968em;">l</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mord">\</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span><span class="mord text"><span class="mord">values</span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal">x</span><span class="mpunct">;</span><span class="mspace" style="margin-right: 1em;"></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 23.4em; border-right-width: 0.04em; border-right-style: solid; margin: 0px -0.02em; vertical-align: -11.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -24.1em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -25.9em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Earlier we showed that using a PRF as the round function in a 3-round Feistel cipher results in a secure PRP. However, that PRP is <strong>not</strong> a <em>strong</em> PRP. Even more surprisingly, adding an extra round to the Feistel cipher does make it a strong PRP! We present the following theorem without proof:</p>
<p><strong>Theorem 6.14 (Luby-Rackoff)</strong></p>
<p><em>If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>×</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">F:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \times\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.09911em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">λ</span></span></span></span></span></span></span></span></span></span></span></span></span> is a secure PRF, then the 4-round Feistel cipher <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">\mathbb{F}_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83889em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> (Construction 6.11) is a secure SPRP.</em></p>
<h3 id="exercises">Exercises</h3>
<p>6.1. In this problem, you will show that it is hard to determine the key of a PRF by querying the PRF.</p>
<p>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a candidate PRF, and suppose there exists a program <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> such that:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Pr</mtext><mo stretchy="false">[</mo><mi mathvariant="script">A</mi><mo>⋄</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mi>F</mi></msubsup><mtext>&nbsp;outputs&nbsp;</mtext><mi>k</mi><mo stretchy="false">]</mo><mtext>&nbsp;is&nbsp;non-negligible:</mtext></mrow><annotation encoding="application/x-tex">\text{Pr}[\mathcal{A}\diamond\mathcal{L}_{\text{prf-real}}^F\ \text{outputs}\ k]\ \text{is non-negligible:}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord text"><span class="mord">Pr</span></span><span class="mopen">[</span><span class="mord mathcal">A</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.27444em; vertical-align: -0.383108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">outputs</span></span><span class="mspace">&nbsp;</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">is&nbsp;non-negligible:</span></span></span></span></span></span></span></p>
<p>In the above expression, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> refers to the private variable within <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{prf-real}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p>
<p>Prove that if such an <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> exists, then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is not a secure PRF. Use<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> to construct a distinguisher that violates the PRF security definition.</p>
<p>6.2. Let F be a secure PRF.</p>
<p>(a) Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">m\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></span> be a fixed (public, hard-coded, known to the adversary) string. Define:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>m</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">F_m(k,x)=F(k,x)\oplus m.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">m</span><span class="mord">.</span></span></span></span></span></span></p>
<p>Prove that for every <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo separator="true">,</mo><msub><mi>F</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">m, F_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is a secure PRF.</p>
<p>(b) Define<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">
F^{\prime}(k, x)=F(k, x) \oplus x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span></span><br>
Prove that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is a secure PRF.</p>
<p>6.3. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRF with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>-bit outputs, and let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> be a PRG with stretch <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">ℓ</mi></mrow><annotation encoding="application/x-tex">\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">ℓ</span></span></span></span></span>. Define<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo><mo>=</mo><mi>G</mi><mo stretchy="false">(</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
F^{\prime}(k, r)=G(F(k, r))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.02778em;">r</span><span class="mclose">))</span></span></span></span></span></span><br>
So <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> has outputs of length <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>+</mo><mi mathvariant="normal">ℓ</mi></mrow><annotation encoding="application/x-tex">\lambda+\ell</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord">ℓ</span></span></span></span></span>. Prove that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is a secure PRF.</p>
<p>6.4. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRF with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mo>=</mo><mn>2</mn><mi>λ</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">i n=2 \lambda,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">in</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord">2</span><span class="mord mathnormal">λ</span><span class="mpunct">,</span></span></span></span></span> and let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> be a length-doubling <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">R</mi><mi mathvariant="normal">G</mi></mrow><annotation encoding="application/x-tex">\mathrm{PRG}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathrm">PRG</span></span></span></span></span></span>. Define<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>G</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
F^{\prime}(k, x)=F(k, G(x))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span></span></span><br>
We will see that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is not necessarily a PRF.</p>
<p>(a) Prove that if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span> is injective then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is a secure PRF.</p>
<blockquote>
<p>Hint: You should not even need to use the fact that G is a PRG.</p>
</blockquote>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋆</mo></mrow><annotation encoding="application/x-tex">\star</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mord">⋆</span></span></span></span></span> (b) Exercise 5.9 (b) constructs a secure length-doubling PRG that ignores half of its input Show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is insecure when instantiated with such a PRG. Give a distinguisher and compute its advantage.<br>
<em>Note</em>: You are not attacking the PRF security of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">F,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mpunct">,</span></span></span></span></span> nor the PRG security of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal">G</span></span></span></span></span>. You are attacking the invalid way in which they have been combined.</p>
<p>6.5. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRF, and let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">in</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow><annotation encoding="application/x-tex">m \in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\textit {in }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.0805em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.830502em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">in&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span> be a fixed (therefore known to the adversary) string. Define the new function<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
F_{m}(k, x)=F(k, x) \oplus F(k, m).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></span><br>
Show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">F_{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.13889em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is <strong>not</strong> a secure PRF. Describe a distinguisher and compute its advantage.</p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⋆</mo><mtext>&nbsp;</mtext><mn>6.6.</mn></mrow><annotation encoding="application/x-tex">\star \ 6.6 .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">⋆</span><span class="mspace">&nbsp;</span><span class="mord">6.6.</span></span></span></span></span> In the previous problem, what happens when <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">m</span></span></span></span></span> is secret and part of the PRF seed? Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRF, and define the new function: Define the new function<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
F^{\prime}((k, m), x)=F(k, x) \oplus F(k, m).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></span><br>
The seed of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(k, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></span>, which you can think of as a <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>+</mo><mi>i</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">\lambda+i n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.08333em;"></span><span class="mord mathnormal">λ</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.65952em; vertical-align: 0em;"></span><span class="mord mathnormal">in</span></span></span></span></span> bit string. Show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is indeed a secure PRF.</p>
<blockquote>
<p>Hint: Rewrite the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> algorithm to include an “if x = m” clause and argue that the calling program can rarely satisfy this clause.</p>
</blockquote>
<p>6.7. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRF. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.63056em; vertical-align: 0em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.63056em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.55056em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span></span></span></span></span> denote the bitwise complement of the string <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>. Define the new function:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mover accent="true"><mi>x</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
F^{\prime}((k, x)=F(k, x) \| F(k, \overline{x}).
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mopen">((</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.63056em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span class="" style="top: -3.55056em;"><span class="pstrut" style="height: 3em;"></span><span class="overline-line" style="border-bottom-width: 0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></span><br>
Show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">F'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> is <strong>not</strong> a secure PRF. Describe a distinguisher and compute its advantage.</p>
<p>6.8. Suppose <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF with input length in, but we want to use it to construct a PRF with longer input length. Below are some approaches that don’t work. For each one, describe a successful distinguishing attack and compute its advantage:</p>
<p>(a) <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mi mathvariant="normal">∥</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∥</mi><mi>F</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">F^{\prime}\left(k, x \| x^{\prime}\right)=F(k, x) \| F\left(k, x^{\prime}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mord">∥</span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> are each <em>in</em> bits long.<br>
(b) <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mi mathvariant="normal">∥</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>F</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">F^{\prime}\left(k, x \| x^{\prime}\right)=F(k, x) \oplus F\left(k, x^{\prime}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> are each <em>in</em> bits long.<br>
(c ) <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mi mathvariant="normal">∥</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>F</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo>⊕</mo><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">F^{\prime}\left(k, x \| x^{\prime}\right)=F(k, x) \oplus F\left(k, x \oplus x^{\prime}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> are each <em>in</em> bits long.<br>
(d) <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>F</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mi mathvariant="normal">∥</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mi mathvariant="normal">∥</mi><mi>x</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>F</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><mi mathvariant="normal">∥</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">F^{\prime}\left(k, x \| x^{\prime}\right)=F(k, \textcolor{brown}{0} \| x) \oplus F\left(k, \textcolor{brown}{1} \| x^{\prime}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">0</span><span class="mord">∥</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> are each <em>in</em> - <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span></span></span></span></span> bits long.</p>
<p>6.9. Define a PRF <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> whose key <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> we write as <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><msub><mi>k</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>k</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\left(k_{1}, \ldots, k_{i n}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">…</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> where each <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">k_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> is a string of length <em>out</em>. Then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is defined as:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munder><mo>⨁</mo><mrow><mi>i</mi><mo>×</mo><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow></munder><msub><mi>k</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
F(k, x)=\bigoplus_{i \times x_{i}=1} k_{i}.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 2.42777em; vertical-align: -1.37777em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.05001em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.328086em;"><span class="" style="top: -2.357em; margin-left: 0em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.143em;"><span class=""></span></span></span></span></span></span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">⨁</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.37777em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></span><br>
Show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is not a secure PRF. Describe a distinguisher and compute its advantage.</p>
<p>6.10. Define a PRF <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> whose key <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> is an <em>in</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\times 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.72777em; vertical-align: -0.08333em;"></span><span class="mord">×</span><span class="mord">2</span></span></span></span></span> array of out-bit strings, whose entries we refer to as <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo stretchy="false">[</mo><mi>i</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">k[i, b]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mopen">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">b</span><span class="mclose">]</span></span></span></span></span>. Then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is defined as:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>⨁</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mi>n</mi></mrow></munderover><mi>k</mi><mrow><mo fence="true">[</mo><mi>i</mi><mo separator="true">,</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">]</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
F(k, x)=\bigoplus_{i=1}^{i n} k\left[i, x_{i}\right].
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 3.08934em; vertical-align: -1.27767em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.81167em;"><span class="" style="top: -1.87233em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span class="" style="top: -3.05001em;"><span class="pstrut" style="height: 3.05em;"></span><span class=""><span class="mop op-symbol large-op">⨁</span></span></span><span class="" style="top: -4.30001em; margin-left: 0em;"><span class="pstrut" style="height: 3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 1.27767em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">[</span><span class="mord mathnormal">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">]</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span></span></span><br>
Show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is <strong>not</strong> a secure PRF. Describe a distinguisher and compute its advantage.</p>
<p>6.11. A function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>n</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{n} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span> is chosen uniformly at random. What is the probability that the function is invertible?</p>
<p>6.12. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRP with blocklength <em>blen</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mn>128.</mn></mrow><annotation encoding="application/x-tex">=128 .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">128.</span></span></span></span></span> Then for each <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">k,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span></span></span></span></span> the function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k,\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> is a permutation on <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mn>128</mn></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{128}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">128</span></span></span></span></span></span></span></span></span></span></span></span></span>. Suppose I choose a permutation on <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mn>128</mn></msup></mrow><annotation encoding="application/x-tex">\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{128}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.06411em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.814108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">128</span></span></span></span></span></span></span></span></span></span></span></span></span> uniformly at random. What is the probability that the permutation I chose agrees with a permutation of the form <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">F(k,\cdot) ?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">⋅</span><span class="mclose">)?</span></span></span></span></span> Compute the probability as an actual number <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo></mrow><annotation encoding="application/x-tex">-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="mord">−</span></span></span></span></span> is it a reasonable probability or a tiny one?</p>
<p>6.13. Suppose <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>n</mi></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">R:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{n} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span> is chosen uniformly among all such functions. What is the probability that there exists an <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">x \in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.5782em; vertical-align: -0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></span> such that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">R(x)=x ?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span><span class="mclose">?</span></span></span></span></span></p>
<blockquote>
<p>Hint: First find the probability that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo mathvariant="normal">≠</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">R(x)\neq x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.00773em;">R</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span> for all <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathnormal">x</span></span></span></span></span>. Simplify your answer using the approximation <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mo>≈</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>y</mi></mrow></msup></mrow><annotation encoding="application/x-tex">(1-y)\approx e^{-y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.771331em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.771331em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">y</span></span></span></span></span></span></span></span></span></span></span></span></span>.</p>
</blockquote>
<p>6.14. In this problem, you will show that the PRP switching lemma holds only for large domains. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prp-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> be as in Lemma <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>6.7.</mn></mrow><annotation encoding="application/x-tex">6.7 .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">6.7.</span></span></span></span></span> Choose any small value of blen <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span></span></span></span></span> out that you like, and show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext></msub><mo>≉</mo><msub><mi mathvariant="script">L</mi><mtext>prp-rand&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }} \not\approx \mathcal{L}_{\text {prp-rand }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.980548em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height: 0.48312em; vertical-align: 0em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> with those parameters. Describe a distinguisher and compute its advantage.</p>
<blockquote>
<p>Hint: Remember that the distinguisher needs to run in polynomial time in<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>, but not necessarily polynomial in <em>blen</em>.</p>
</blockquote>
<p>6.15. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo>:</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>i</mi><mi>n</mi></mrow></msup><mo>→</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">F:\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{in} \rightarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.07466em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.824664em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">in</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.04356em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span></span> be a (not necessarily invertible) function. We showed how to use F as a round function in the Feistel construction ony when <em>in = out</em>.</p>
<p>Describe a modification of the Feistel construction that works even when the round function satisfies <em>in</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo mathvariant="normal">≠</mo></mrow><annotation encoding="application/x-tex">\neq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mord"><span class="mrel"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span></span></span></span></span> <em>out</em>. The result should be an invertible with input/output length <em>in + out</em>. Be sure to show that your proposed transform is invertible! You are not being asked to show any security properties of the Feistel construction.</p>
<p>6.16. Show that a 1-round keyed Feistel cipher <strong>cannot</strong> be a secure PRP, no matter what its round functions are. That is, construct a distinguisher that successfully distinguishes <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prp-real</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{prp-real}}^F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prp-rand</mtext><mi>F</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{prp-rand}}^F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prp-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, knowing only that F is a 1-round Feistel cipher. In particular, the purpose is to attack the Feistel transform and not its round function, so your attack should work no matter what the round function is.</p>
<p>6.17. Show that a 2-round keyed Feistel cipher <strong>cannot</strong> be a secure PRP, no matter what its round functions are. Your attack should work without knowing the round keys, and it should work even with different (independent) round keys.</p>
<blockquote>
<p>Hint: A successful attack requires two queries.</p>
</blockquote>
<p>6.18. Show that any function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> that is a 3-round keyed Feistel cipher <strong>cannot</strong> be a secure <em>strong</em> PRP. As above, your distinguisher should work without knowing what the round functions are, and the attack should work with different (independent) round functions.</p>
<p>6.19. In this problem you will show that PRPs are hard to invert without the key (if the blocklength is large enough). Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a candidate PRP with blocklength blen <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩾</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">\geqslant \lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77334em; vertical-align: -0.13667em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>. Suppose there is a program <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> where:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi><munder><mo><mi mathvariant="normal">Pr</mi><mo>⁡</mo></mo><mrow><mi>y</mi><mo>←</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mtext mathvariant="italic">blen</mtext><mtext>&nbsp;</mtext></mrow></msup></mrow></munder></mi><mrow><mo fence="true">[</mo><mi mathvariant="script">A</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>⋄</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext><mi>F</mi></msubsup><mtext>&nbsp;outputs&nbsp;</mtext><msup><mi>F</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mtext>&nbsp;is&nbsp;non-negligible.&nbsp;</mtext></mrow><annotation encoding="application/x-tex">
\underset{y \leftarrow\{\textcolor{brown}{0},\textcolor{brown}{1}\}^{\textit {blen }}}{\operatorname{Pr}}\left[\mathcal{A}(y) \diamond \mathcal{L}_{\text {prf-real }}^{F} \text { outputs } F^{-1}(k, y)\right] \text { is non-negligible. }
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.87975em; vertical-align: -0.98842em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.28658em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.03588em;">y</span><span class="mrel mtight">←</span><span class="mopen mtight">{</span><span class="mord mtight" style="color: brown;">0</span><span class="mpunct mtight">,</span><span class="mord mtight" style="color: brown;">1</span><span class="mclose mtight"><span class="mclose mtight">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.782029em;"><span class="" style="top: -2.786em; margin-right: 0.0714286em;"><span class="pstrut" style="height: 2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord textit mtight">blen&nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop"><span class="mop"><span class="mord mathrm">Pr</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.98842em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size1">[</span></span><span class="mord mathcal">A</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋄</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.891331em;"><span class="" style="top: -2.453em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right: 0.13889em;">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.383108em;"><span class=""></span></span></span></span></span></span><span class="mord text"><span class="mord">&nbsp;outputs&nbsp;</span></span><span class="mord"><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.864108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord text"><span class="mord">&nbsp;is&nbsp;non-negligible.&nbsp;</span></span></span></span></span></span></span><br>
The notation means that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> receives a random block <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span> as an input (and is also linked to <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">\left.\mathcal{L}_{\text {prf-real }}\right) . k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span></span></span></span></span> refers to the private variable within <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real.&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real. }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real.&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> So, when given the ability to evaluate <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> in the forward direction only (via <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.969438em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> ), <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> can invert a uniformly chosen block <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathnormal" style="margin-right: 0.03588em;">y</span></span></span></span></span></p>
<p>Prove that if such an <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> exists, then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is not a secure PRP. Use <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> to construct a distinguisher that violates the PRP security definition. Where do you use the fact that blen <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⩾</mo><mi>λ</mi><mo stretchy="false">?</mo></mrow><annotation encoding="application/x-tex">\geqslant \lambda ?</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77334em; vertical-align: -0.13667em;"></span><span class="mrel amsrm">⩾</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span><span class="mclose">?</span></span></span></span></span> How do you deal with the fact that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">A</mi></mrow><annotation encoding="application/x-tex">\mathcal{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathcal">A</span></span></span></span></span> may give the wrong answer with high probability?</p>
<p>6.20. Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRP with blocklength <em>blen</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>λ</mi></mrow><annotation encoding="application/x-tex">=\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathnormal">λ</span></span></span></span></span>, and consider <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>F</mi><mo stretchy="true">undefined</mo></mover><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⊕</mo><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\widehat{F}(k, x)=F(k, k) \oplus F(k, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.17333em; vertical-align: -0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span><span class="svg-align" style="width: calc(100% - 0.16668em); margin-left: 0.16668em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;"><svg width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span></span>.</p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="1em"></mspace></mrow><annotation encoding="application/x-tex">\quad</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0em; vertical-align: 0em;"></span><span class="mspace" style="margin-right: 1em;"></span></span></span></span></span>(a) Show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>F</mi><mo stretchy="true">undefined</mo></mover></mrow><annotation encoding="application/x-tex">\widehat{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.92333em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span><span class="svg-align" style="width: calc(100% - 0.16668em); margin-left: 0.16668em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;"><svg width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span></span></span></span></span> is not a strong PRP (even if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span></span></span></span> is).<br>
<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>&nbsp;</mtext><mo>⋆</mo></mrow><annotation encoding="application/x-tex">\ \star</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.46528em; vertical-align: 0em;"></span><span class="mspace">&nbsp;</span><span class="mord">⋆</span></span></span></span></span> (b) Show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>F</mi><mo stretchy="true">undefined</mo></mover></mrow><annotation encoding="application/x-tex">\widehat{F}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.92333em; vertical-align: 0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.92333em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord mathnormal" style="margin-right: 0.13889em;">F</span></span><span class="svg-align" style="width: calc(100% - 0.16668em); margin-left: 0.16668em; top: -3.68333em;"><span class="pstrut" style="height: 3em;"></span><span class="" style="height: 0.24em;"><svg width="100%" height="0.24em" viewBox="0 0 1062 239" preserveAspectRatio="none"><path d="M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z"></path></svg></span></span></span></span></span></span></span></span></span></span> is a secure (normal) PRP.</p>
<hr class="footnotes-sep">
<section class="footnotes">
<ol class="footnotes-list">
<li id="fn1" class="footnote-item"><p>When we use a pseudorandom function as a component in other constructions, the libraries for PRF security will show up as <em>calling programs</em> of other libraries. The definition of indistinguishability requires all calling programs to run in polynomial time. <a href="#fnref1" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn2" class="footnote-item"><p>As we will see later, the distinction between randomly chosen function and randomly chosen <em>invertible</em> function is not as significant as it might seem. <a href="#fnref2" class="footnote-backref">↩︎</a></p>
</li>
<li id="fn3" class="footnote-item"><p>In all fairness, there is a possibility that government agencies like NSA know of weaknesses in many cryptographic algorithms, but keep them secret. I know of a rather famous cryptographer (whom I will not name here) who believes this is likely, based on the fact that NSA has hired more math &amp; cryptography PhDs than have gone on to do public research. <a href="#fnref3" class="footnote-backref">↩︎</a></p>
</li>
</ol>
</section>
</div>
</body>

</html>


