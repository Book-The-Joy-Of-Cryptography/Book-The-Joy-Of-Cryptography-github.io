---
layout: page
title: 12. Authenticated Encryption & AEAD
nav_order: 1300
---

<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>12</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><h1 id="authenticated-encryption--aead">12 Authenticated Encryption &amp; AEAD</h1>
<p>It can be helpful to think of encryption as providing a secure logical channel between two users who only have access to an insecure physical channel. Below are a few things that an attacker might do to the insecure physical channel:</p>
<ul>
<li>An attacker may <strong>passively eavesdrop</strong>; i.e., simply observe the channel. A CPAsecure encryption scheme provides <strong>confidentiality</strong> and prevents the attacker from learning anything by eavesdropping.</li>
<li>An attacker may <strong>drop</strong> messages sent along the channel, resulting in a denial of service. If the attacker can do this on the underlying physical channel, then it cannot be overcome through cryptography.</li>
<li>An attacker may try to <strong>modify</strong> messages that are sent along the channel, by tampering with their ciphertexts. This sounds like what CCA-secure encryption protects against, right?</li>
<li>An attacker may try to <strong>inject</strong> new messages into the channel. If successful, Bob might receive a message and mistake it for something that Alice meant to send. Does CCA security protect against this? If it is indeed possible to inject new messages into the channel, then an attacker can delete Alice‚Äôs ciphertexts and replace them with their own. This would seem to fall under the category of ‚Äúmodifying‚Äù messages on the channel, so message-injection and message-modification are somewhat connected.</li>
<li>An attacker may try to <strong>replay</strong> messages that were sent. For example, if Bob was convinced that a ciphertext <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> came from Alice, then an attacker can re-send the same <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> many times, and Bob may interpret this as Alice wanting to re-send the same plaintext many times. Does CCA security protect against this?</li>
</ul>
<p>Although it might seem that CCA-secure encryption guarantees protection against many of these kinds of attacks, it does not!</p>
<p>To see why, consider the SPRP-based encryption scheme of Construction 9.3. We proved that this scheme has CCA security. However, it never raises any errors during decryption. <em>Every</em> ciphertext is interpreted as a valid encryption of some plaintext. An attacker can choose an arbitrary ciphertext, and when Bob decrypts it he might think Alice was trying to send some (presumably garbled) message. The only thing that CCA security guarantees is that if an attacker is able to make a ciphertext that decrypts without error, then it must decrypt to something that is unrelated to the contents of other ciphertexts.</p>
<p>In order to achieve protection against message-modification and message-injection on the secure channel, we need a stronger/better security denition. <strong>Authenticated encryption (AE)</strong> formalizes the extra property that only someone with the secret key can find ciphertexts that decrypt without error. For example, encrypt-then-MAC (Construction 10.9) already has this property.</p>
<p>In this chapter we will discuss authenticated encryption and a closely-related concept of encryption with <strong>associated data (AD)</strong>, which is designed to help prevent message replay attacks. These two concepts are the ‚Äúgold standard‚Äù for encryption.</p>
<h2 id="definitions">12.1 Definitions</h2>
<h3 id="authenticated-encryption">Authenticated Encryption</h3>
<p>As with CPA and CCA flavors of security, we can define AE security in both a ‚Äúleft-vsright‚Äù style or a ‚Äúpseudorandom ciphertexts‚Äù style. Both are reasonable choices. To make life simpler we will only dene the pseudorandom-ciphertexts-style of AE security in this chapter.</p>
<p>In CCA<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Œ¶</mi></mrow><annotation encoding="application/x-tex">\varPhi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathit">Œ¶</span></span></span></span></span></span> security, the attacker has access to the decryption algorithm (except for ciphertexts generated by the library itself). This captures the idea that the result of decrypting adversarially-generated ciphertexts cannot help distinguish the contents of other ciphertexts. For AE security, we want a stronger condition that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Dec</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>=</mo><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow><annotation encoding="application/x-tex">\operatorname{Dec}(k, c)=\textcolor{brown}{\texttt{err}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">D</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span></span>for every adversarially-generated ciphertext <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">c .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span><span class="mord">.</span></span></span></span></span> Using the same ideas used to define security for MACs, we express this requirement by saying that the attacker shouldn‚Äôt be able to distinguish access to the ‚Äúreal‚Äù Dec algorithm, or one that always outputs <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{\texttt{err}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span></span>:</p>
<p><strong>Definition 12.1 (AE)</strong><br>
Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Œ£</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Œ£</span></span></span></span></span> be an encryption scheme. We saythat <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Œ£</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Œ£</span></span></span></span></span> has authenticated encryption (AE) security if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mrow><mtext>ae</mtext><mi>Œ¶</mi><mo>‚àí</mo><mrow><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></mrow><mi mathvariant="normal">Œ£</mi></msubsup><mo>‚âà</mo><msubsup><mi mathvariant="script">L</mi><mrow><mtext>ae</mtext><mi>Œ¶</mi><mo>‚àí</mo><mtext>rand&nbsp;</mtext></mrow><mi mathvariant="normal">Œ£</mi></msubsup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {ae}\varPhi-{real }}^{\Sigma} \approx \mathcal{L}_{\text {ae}\varPhi-\text{rand }}^{\Sigma},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.18277em; vertical-align: -0.341439em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ae</span></span><span class="mord mtight"><span class="mord mathit mtight">Œ¶</span></span><span class="mbin mtight">‚àí</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.341439em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.18277em; vertical-align: -0.341439em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ae</span></span><span class="mord mtight"><span class="mord mathit mtight">Œ¶</span></span><span class="mbin mtight">‚àí</span><span class="mord text mtight"><span class="mord mtight">rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.341439em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> where:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mrow><mtext>ae</mtext><mi>Œ¶</mi><mo>‚àí</mo><mrow><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></mrow><mi mathvariant="normal">Œ£</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>‚Üê</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">‚àÖ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CTXT</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>S</mi><mo>:</mo><mo>=</mo><mi>S</mi><mo>‚à™</mo><mo stretchy="false">{</mo><mi>c</mi><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>DECRYPT</mtext><mo stretchy="false">(</mo><mi>c</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mo>‚àà</mo><mi>S</mi><mo>:</mo><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mrow><mtext>ae</mtext><mi>Œ¶</mi><mo>‚àí</mo><mrow><mi>f</mi><mi>a</mi><mi>k</mi><mi>e</mi></mrow></mrow><mi mathvariant="normal">Œ£</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CTXT</mtext><mo stretchy="false">(</mo><mi>m</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>‚Üê</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo stretchy="false">(</mo><mi mathvariant="normal">‚à£</mi><mi>m</mi><mi mathvariant="normal">‚à£</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>DECRYPT</mtext><mo stretchy="false">(</mo><mi>c</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \quad\mathcal{L}_{\text {ae}\varPhi-{real }}^{\Sigma}\\\hline
k\leftarrow \Sigma.\text{KeyGen}\\
S:=\emptyset\\
\underline{\text{CTXT}(m\in\Sigma.\mathcal{M}):}\\
\quad c:=\Sigma.\text{Enc}(k,m)\\
\quad S:=S\cup \{c\}\\
\quad \text{return}\ c\\
\underline{\text{DECRYPT}(c\in\Sigma.C):}\\
\quad\text{if}\ c\in S:\text{return \textcolor{brown}{\texttt{err}}}\\
\quad\text{return}\ \Sigma.\text{Dec}(k,c)\\\hline
\end{array} 
\quad
\begin{array}{|l|}\hline
\qquad \quad\mathcal{L}_{\text {ae}\varPhi-{fake}}^{\Sigma}\\\hline
\underline{\text{CTXT}(m\in\Sigma.\mathcal{M}):}\\
\quad c\leftarrow \Sigma.C(|m|)\\
\quad \text{return}\ c\\
\underline{\text{DECRYPT}(c\in\Sigma.C):}\\
\quad\text{return \textcolor{brown}{\texttt{err}}}\\\hline
\end{array} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 18.05em; vertical-align: -8.75em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.3em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 11.25em;"></span><span class="mtable"><span class="vertical-separator" style="height: 18em; vertical-align: -8.75em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ae</span></span><span class="mord mtight"><span class="mord mathit mtight">Œ¶</span></span><span class="mbin mtight">‚àí</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.341439em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">‚àÖ</span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CTXT</span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal">M</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚à™</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{</span><span class="mord mathdefault">c</span><span class="mclose">}</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">DECRYPT</span></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 18em; vertical-align: -8.75em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -18.7em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -20.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.7em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">ae</span></span><span class="mord mtight"><span class="mord mathit mtight">Œ¶</span></span><span class="mbin mtight">‚àí</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CTXT</span></span><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal">M</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mopen">(</span><span class="mord">‚à£</span><span class="mord mathdefault">m</span><span class="mord">‚à£</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">DECRYPT</span></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="discussion">Discussion</h3>
<p>The two libraries are different from each other in two major ways: whether the calling program sees real ciphertexts or random strings (that have nothing to do with the given plaintext), and whether the calling program sees the true result of decryption or an error message. With these two differences, we are demanding that two conditions be true: the calling program can‚Äôt tell whether it is seeing real or fake ciphertexts, it also cannot generate a ciphertext (other than the ones it has seen) that would cause Dec to output anything except <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{\texttt{err}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span></span>.</p>
<p>Whenever the calling program calls DECRYPT( <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> ) for a ciphertext <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> that was produced by the library (in crxt), both libraries will return <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{\texttt{err}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span></span> by construction. Importantly, the difference in the libraries is the behavior of DECRYPT on ciphertexts that were not generated by the library (i.e., generated by the attacker).</p>
<h3 id="associated-data">Associated Data</h3>
<p>AE provides a secure channel between Alice and Bob that is safe from messagemodification and message-injection by the attacker (in addition to providing confidentiality). However, AE still does not protect from <strong>replay</strong> of messages. If Alice sends a ciphertext <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> to Bob, we know that Bob will decrypt <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> without error. The guarantee of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">A</mi><mi mathvariant="normal">E</mi></mrow><annotation encoding="application/x-tex">\mathrm{AE}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathrm">A</span><span class="mord mathrm">E</span></span></span></span></span></span> security is that Bob can be sure that the message originated from Alice in this case. If an attacker re-sends the same <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> at a later time, Bob will likely interpret that as a sign that Alice wanted to say the same thing again, even though this was not Alice‚Äôs intent. It is still true that Alice was the originator of the message, but just not at this time.</p>
<p>You may wonder how it is possible to prevent this sort of attack. If a ciphertext <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> is a valid ciphertext when Alice sends it, then it will always be a valid ciphertext, right? A clever way around this problem is for Alice to not only authenticate the ciphertext as coming from her, but to authenticate it also to a <em>specific</em> context. For example, suppose that Alice &amp; Bob are exchanging encrypted messages, and the 5 th ciphertext is <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">c,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">c</span><span class="mpunct">,</span></span></span></span></span> sent by Alice. The main idea is to let Alice authenticate the fact that ‚ÄúI meant to send <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> as the 5 th ciphertext in the conversation.‚Äù If an attacker re-sends <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> later <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>e</mi><mi mathvariant="normal">.</mi><mi>g</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">(e . g .,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mord">.</span><span class="mpunct">,</span></span></span></span></span> as the 11 th ciphertext, a different context), Bob will attempt to authenticate the fact that ‚ÄúAlice meant to send <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> as the 11 th ciphertext.‚Äù and this authentication will fail.</p>
<p>What I have called ‚Äúcontext‚Äù is called <strong>associated data</strong> in an encryption scheme. In order to support associated data, we modify the syntax of the encryption and decryption algorithms to take an additional argument <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span>. The ciphertext <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi><mo>=</mo><mi mathvariant="normal">Enc</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c=\operatorname{Enc}(k, d, m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">E</span><span class="mord mathrm">n</span><span class="mord mathrm">c</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span></span></span> is an encryption of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span> with associated data <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span>. In application, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span> could be a sequence number of a conversation, a hash of the entire conversation up to this point, an IP address + port number, etc. - basically, as much information as you can think of regarding this ciphertext‚Äôs intended context. Decrypting <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> with the ‚Äúcorrect‚Äù associated data <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span> via <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Dec</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{Dec}(k, d, c)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">D</span><span class="mord mathrm">e</span><span class="mord mathrm">c</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span></span> should result in the correct plaintext <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span>. Decrypting <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">c</span></span></span></span></span> with any other associated data should result in an error, since that reflects a mismatch between the sender‚Äôs and receiver‚Äôs contexts.</p>
<p>The intuitive security requirement for <strong>authenticated encryption with associated data (AEAD)</strong> is that an attacker who sees many encryptions <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> of chosen plaintexts, each authenticated to a particular associated data <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">d_{i},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> cannot generate a different <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><msup><mi>c</mi><mo>‚àó</mo></msup><mo separator="true">,</mo><msup><mi>d</mi><mo>‚àó</mo></msup><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(c^{*}, d^{*}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> that decrypts successfully. The security definition rules out attempts to modify some <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> under the same <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">d_{i},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> or modify some <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.84444em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for the same <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">c_{i},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> or produce a completely new <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><msup><mi>c</mi><mo>‚àó</mo></msup><mo separator="true">,</mo><msup><mi>d</mi><mo>‚àó</mo></msup><mo fence="true">)</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\left(c^{*}, d^{*}\right) .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span></span></p>
<p><strong>Definition 12.2 (AEAD)</strong><br>
Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Œ£</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Œ£</span></span></span></span></span> be an encryption scheme. We write <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\Sigma . \mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span></span></span></span></span> to denote the space of supported associated data signifiers (‚Äúcontexts‚Äù). We say that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Œ£</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord">Œ£</span></span></span></span></span> has authenticated encryption with associated data (AEAD) security if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mrow><mtext>aead</mtext><mi>Œ¶</mi><mo>‚àí</mo><mtext>real&nbsp;</mtext></mrow><mi mathvariant="normal">Œ£</mi></msubsup><mo>‚âà</mo><msubsup><mi mathvariant="script">L</mi><mrow><mtext>aead</mtext><mi>Œ¶</mi><mo>‚àí</mo><mtext>rand,&nbsp;</mtext></mrow><mi mathvariant="normal">Œ£</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {aead}\varPhi-\text{real }}^{\Sigma} \approx \mathcal{L}_{\text {aead}\varPhi-\text{rand, }}^{\Sigma}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.18277em; vertical-align: -0.341439em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">aead</span></span><span class="mord mtight"><span class="mord mathit mtight">Œ¶</span></span><span class="mbin mtight">‚àí</span><span class="mord text mtight"><span class="mord mtight">real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.341439em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">aead</span></span><span class="mord mtight"><span class="mord mathit mtight">Œ¶</span></span><span class="mbin mtight">‚àí</span><span class="mord text mtight"><span class="mord mtight">rand,&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> where:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mrow><mtext>aead</mtext><mi>Œ¶</mi><mo>‚àí</mo><mrow><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></mrow><mi mathvariant="normal">Œ£</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>‚Üê</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mtext>KeyGen</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">‚àÖ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CTXT</mtext><mo stretchy="false">(</mo><mi>d</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">D</mi><mo separator="true">,</mo><mi>m</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>:</mo><mo>=</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>S</mi><mo>:</mo><mo>=</mo><mi>S</mi><mo>‚à™</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>d</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>DECRYPT</mtext><mo stretchy="false">(</mo><mi>d</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">D</mi><mo separator="true">,</mo><mi>c</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mo stretchy="false">(</mo><mi>d</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo><mo>‚àà</mo><mi>S</mi><mo>:</mo><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mtext>Dec</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mrow><mtext>aead</mtext><mi>Œ¶</mi><mo>‚àí</mo><mrow><mi>f</mi><mi>a</mi><mi>k</mi><mi>e</mi></mrow></mrow><mi mathvariant="normal">Œ£</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>CTXT</mtext><mo stretchy="false">(</mo><mi>c</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">D</mi><mo separator="true">,</mo><mi>m</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>‚Üê</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi>C</mi><mo stretchy="false">(</mo><mi mathvariant="normal">‚à£</mi><mi>m</mi><mi mathvariant="normal">‚à£</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>DECRYPT</mtext><mo stretchy="false">(</mo><mi>d</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">D</mi><mo separator="true">,</mo><mi>c</mi><mo>‚àà</mo><mi mathvariant="normal">Œ£</mi><mi mathvariant="normal">.</mi><mi mathvariant="script">M</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \quad\mathcal{L}_{\text {aead}\varPhi-{real }}^{\Sigma}\\\hline
k\leftarrow \Sigma.\text{KeyGen}\\
S:=\emptyset\\
\underline{\text{CTXT}(d\in \Sigma.\mathcal{D},m\in \Sigma.\mathcal{M}):}\\
\quad c:=\Sigma.\text{Enc}(k,d, m)\\
\quad S:=S\cup \{(d,c)\}\\
\quad \text{return}\ c\\
\underline{\text{DECRYPT}(d\in \Sigma.\mathcal{D},c\in \Sigma.\mathcal{M}):}\\
\quad\text{if}\ (d,c)\in S:\text{return \textcolor{brown}{\texttt{err}}}\\
\quad\text{return}\ \Sigma.\text{Dec}(k,d,c)\\\hline
\end{array} 
\quad
\begin{array}{|l|}\hline
\qquad \quad\mathcal{L}_{\text {aead}\varPhi-{fake}}^{\Sigma}\\\hline
\underline{\text{CTXT}(c\in \Sigma.\mathcal{D},m\in \Sigma.\mathcal{M}):}\\
\quad c\leftarrow \Sigma.C(|m|)\\
\quad \text{return}\ c\\
\underline{\text{DECRYPT}(d\in \Sigma.\mathcal{D},c\in \Sigma.\mathcal{M}):}\\
\quad\text{return \textcolor{brown}{\texttt{err}}}\\\hline
\end{array} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 18.05em; vertical-align: -8.75em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.3em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 11.25em;"></span><span class="mtable"><span class="vertical-separator" style="height: 18em; vertical-align: -8.75em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">aead</span></span><span class="mord mtight"><span class="mord mathit mtight">Œ¶</span></span><span class="mbin mtight">‚àí</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.01968em;">l</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.341439em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord text"><span class="mord">KeyGen</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">‚àÖ</span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CTXT</span></span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal">M</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚à™</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mopen">{</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mclose">}</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">DECRYPT</span></span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal">M</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 18em; vertical-align: -8.75em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -18.7em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -20.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.7em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">aead</span></span><span class="mord mtight"><span class="mord mathit mtight">Œ¶</span></span><span class="mbin mtight">‚àí</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.10764em;">f</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right: 0.03148em;">k</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">CTXT</span></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal">M</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord mathdefault" style="margin-right: 0.07153em;">C</span><span class="mopen">(</span><span class="mord">‚à£</span><span class="mord mathdefault">m</span><span class="mord">‚à£</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">DECRYPT</span></span><span class="mopen">(</span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">Œ£</span><span class="mord">.</span><span class="mord"><span class="mord mathcal">M</span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="discussion-1">Discussion</h3>
<p>One way to "authenticate a message to some context <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span> " is to encrypt <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi mathvariant="normal">‚à•</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">m \| d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">m</span><span class="mord">‚à•</span><span class="mord mathdefault">d</span></span></span></span></span> instead of just <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span> (in an AE scheme). This would indeed work! Including <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span> as part of the plaintext would indeed authenticate it, but it would also hide it. The point of differentiating between plaintext and associated data is that we assume the associated data is shared context between both participants. In other words, we assume that the sender and receiver both already know the context <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span>. Therefore, <em>hiding</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span> is overkill - only authentication is needed. By making a distinction between plaintext and associated data separately in AEAD, the <strong>ciphertext length can depend only on the length of the plaintext</strong>, and not depend on the length of the associated data.</p>
<p>The fact that associated data <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span> is public is reflected in the fact that the calling program chooses it in the security definition.</p>
<p>‚ÄúStandard‚Äù AE corresponds to the case where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span> is always empty: all ciphertexts are authenticated to the same context.</p>
<h2 id="achieving-aeaead">12.2 Achieving AE/AEAD</h2>
<p>The Encrypt-then-MAC construction (Construction 10.9 ) has the property that the attacker cannot generate ciphertexts that decrypt correctly. Even though we introduced encrypt-then-MAC to achieve CCA security, it also achieves the stronger requirement of AE</p>
<p><strong>Claim 12.3</strong><br>
If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span></span></span></span></span> has CPA security and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span></span></span></span></span> is a secure MAC, then EtM (Construction 10.9) has AE security.</p>
<p><strong>to-do</strong></p>
<blockquote>
<p>There is a slight mismatch here, sinceI defined AE/AEAD securify as a ‚Äúpseudorandom ciph texts‚Äù style definition. So you actually need CPAS+PRF instead of CPA+MAC. But CPA+MAC is enough for the left-vs-right style of AE/AEAD security.</p>
</blockquote>
<p>The security proof is essentially the same as the proof of CCA security (Claim 12.5). In that proof, there is a hybrid in which the pecrypt subroutine always returns an error. Stopping the proof at that point would result in a proof of AE security.</p>
<h3 id="encrypt-then-mac-with-associated-data">Encrypt-then-MAC with Associated Data</h3>
<p>Recall that the encrypt-then-MAC construction computes a MAC of the ciphertext. To incorporate associated data, we simply need to compute a MAC of the ciphertext along with the associated data.</p>
<p>Recall that most MACs in practice support variable-length inputs, but the length of the MAC tag does not depend on the length of the message. Hence, this new variant of encrypt-then-MAC has ciphertexts whose length does not depend on the length of the associated data.</p>
<p><strong>Construction 12.4 (Enc+MAC+AD)</strong></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Enc</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mo>‚Üê</mo><mi>E</mi><mi mathvariant="normal">.</mi><mtext>Enc</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>t</mi><mo>:</mo><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>d</mi><mi mathvariant="normal">‚à•</mi><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>Dec</mtext><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>d</mi><mo separator="true">,</mo><mo stretchy="false">(</mo><mi>c</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>t</mi><mi mathvariant="normal">‚â†</mi><mi>M</mi><mi mathvariant="normal">.</mi><mtext>MAC</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>m</mi></msub><mo separator="true">,</mo><mi>d</mi><mi mathvariant="normal">‚à•</mi><mi>c</mi><mo stretchy="false">)</mo><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mrow><mtext>return&nbsp;</mtext><mstyle mathcolor="brown"><mtext mathvariant="monospace">err</mtext></mstyle></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;E.Dec</mtext><mo stretchy="false">(</mo><msub><mi>k</mi><mi>e</mi></msub><mo separator="true">,</mo><mi>c</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|ll|}\hline
\begin{array}{l}
\underline{\text{Enc}((k_e,k_m),d,m):}\\
\quad c\leftarrow E.\text{Enc}(k_e,m)\\
\quad t:=M.\text{MAC}(k_m,d\|c)\\
\quad\text{return}\ (c,t)
\end{array}&amp;
\begin{array}{l}
\underline{\text{Dec}((k_e,k_m),d,(c,t)):}\\
\quad\text{if}\ t\neq M.\text{MAC}(k_m,d\|c):\\
\qquad \text{return \textcolor{brown}{\texttt{err}}}\\
\quad \text{return E.Dec}(k_e,c)
\end{array}\\\hline
\end{array} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.25em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.9em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">E</span><span class="mord">.</span><span class="mord text"><span class="mord">Enc</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mord">‚à•</span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">Dec</span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span><span class="mord">.</span><span class="mord text"><span class="mord">MAC</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">d</span><span class="mord">‚à•</span><span class="mord mathdefault">c</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return&nbsp;</span><span class="mord text" style="color: brown;"><span class="mord texttt" style="color: brown;">err</span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;E.Dec</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: -0.03148em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">c</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>Claim 12.5</strong><br>
If E has CPA security and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.10903em;">M</span></span></span></span></span> is a secure MAC, then Construction 12.4 has AEAD security, when the associated data has fixed length (i,e,<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">D</mi><mo>=</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\mathcal{D}=\{\textcolor{brown}{0},\textcolor{brown}{1}\}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right: 0.02778em;">D</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.664392em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> for some fixed <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span></span></span></span></span>).</p>
<p><strong>to-do</strong><br>
This construction is insecure for variable-length associated data. It is not terribly hard to fix this; see exercises.</p>
<h2 id="carter-wegman-macs">12.3 Carter-Wegman MACs</h2>
<p>Suppose we construct an AE[AD] scheme using the encrypt-then-MAC paradigm. A good choice for the CPA-secure encryption scheme would be CBC mode; a good choice for the MAC scheme would be ECBC-MAC. Combining these two building blocks would result in an AE[AD] scheme that invokes the block cipher twice for each plaintext block - once for the CBC encryption (applied to the plaintext) and once more for the ECBC-MAC (applied to that ciphertext block).</p>
<p>Is it possible to achieve AE[AD] with less cost? In this section we will explore a more efficient technique for variable-length MACs, which requires only one multiplication operation per message block along with a single invocation of a block cipher.</p>
<h3 id="universal-hash-functions">Universal Hash Functions</h3>
<p>The main building block in Carter-Wegman-style MACs is a kind of hash function called a <strong>universal hash function (UHF)</strong>. While the name ‚Äúuniversal hash function‚Äù sounds like it must be an incredibly strong primitive, a UHF actually gives a much weaker security guarantee than a collision-resistant or second-preimage-resistant hash function.</p>
<p>Recall that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(x, x^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> is a <strong>collision</strong> under salt <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi mathvariant="normal">‚â†</mi><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x \neq x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mrow><mo fence="true">(</mo><mi>s</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(s, x)=H\left(s, x^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span>. A universal hash function has the property that it is hard to find such a collision <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>‚Ä¶</mo></mrow><annotation encoding="application/x-tex">\ldots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.12em; vertical-align: 0em;"></span><span class="minner">‚Ä¶</span></span></span></span></span></p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>‚Ä¶</mo></mrow><annotation encoding="application/x-tex">\ldots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.12em; vertical-align: 0em;"></span><span class="minner">‚Ä¶</span></span></span></span></span> when <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> are chosen without knowledge of the salt,</p>
<p><span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>‚Ä¶</mo></mrow><annotation encoding="application/x-tex">\ldots</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.12em; vertical-align: 0em;"></span><span class="minner">‚Ä¶</span></span></span></span></span> and when the attacker has only one attempt at finding a collision for a particular salt value.</p>
<p>These constraints are equivalent to choosing the salt after <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x'</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> are chosen, and a collision should be negligibly likely under such circumstances. The definition can be stated more formally:</p>
<p><strong>Definition 12.6 (UHF)</strong><br>
A hash function <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> with set of salts <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span></span></span> is called a <strong>universal hash function (UHF)</strong> if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>uhf-real</mtext><mi>H</mi></msubsup><mo>‚âà</mo><msubsup><mi mathvariant="script">L</mi><mtext>uhf-fake</mtext><mi>H</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{uhf-real}}^H\approx\mathcal{L}_{\text{uhf-fake}}^H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">uhf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.08125em;">H</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">uhf-fake</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.08125em;">H</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>, where:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>uhf-real</mtext><mi mathvariant="normal">Œ£</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>TEST</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo>‚àà</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>b</mi><mo>:</mo><mo>=</mo><mrow><mo fence="true">[</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mover><mo><mo>=</mo></mo><mo stretchy="false">?</mo></mover><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>uhf-fake</mtext><mi mathvariant="normal">Œ£</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>TEST</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo>‚àà</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mtext>false</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text {uhf-real}}^{\Sigma}\\\hline
\underline{\text{TEST}(x,x'\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^*):}\\
\quad s\leftarrow S\\
\quad b:=\left[H(s,x)\stackrel{?}{=}H(s,x')\right]\\
\quad \text{return}\ (s,b)\\\hline
\end{array} 
\quad
\begin{array}{|l|}\hline
\qquad \quad\mathcal{L}_{\text {uhf-fake}}^{\Sigma}\\\hline
\underline{\text{TEST}(x,x'\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^*):}\\
\quad s\leftarrow S\\
\quad \text{return}\ (s,\text{false})\\\hline
\end{array} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 9.16002em; vertical-align: -4.30501em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.85501em;"><span class="" style="top: -6.80501em;"><span class="pstrut" style="height: 6.80501em;"></span><span class="mtable"><span class="vertical-separator" style="height: 9.11002em; vertical-align: -4.30501em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 4.80501em;"><span class="" style="top: -6.80501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">uhf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.00501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">TEST</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.20501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -1.40501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">[</span></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 1.15298em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class=""><span class="mop">=</span></span></span><span class="" style="top: -3.56687em; margin-left: 0em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mclose mtight">?</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">]</span></span></span></span></span><span class="" style="top: 0.50501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 4.30501em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 9.11002em; vertical-align: -4.30501em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 6.80501em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -9.81002em;"><span class="pstrut" style="height: 6.80501em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -11.61em;"><span class="pstrut" style="height: 6.80501em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 4.30501em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.9em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">uhf-fake</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">TEST</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord text"><span class="mord">false</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>This definition is similar in spirit to the formal definition of collision resistance (Definition 11.1). Just like that definition, this one is cumbersome to use in a security proof. When using a hash function, one typically does not explicitly check for collisions, but instead just proceeds as if there was no collision.</p>
<p>In the case of UHFs, there is a different and helpful way of thinking about security. Consider a <strong>‚Äúblind collision-resistance‚Äù</strong> game, where you try to find a collision under <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> without access to the salt, and even <em>without</em> <em>seeing the outputs of</em> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span>! It turns out that if H is a UHF, then it is hard to find collisions in such a game:</p>
<p><strong>Claim 12.7</strong><br>
If H is a UHF, then the following libraries are indistinguishable:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>brc-real</mtext><mi mathvariant="normal">Œ£</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>TEST</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mo>‚àà</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;define&nbsp;and&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mi mathvariant="normal">‚â†</mi><mi>x</mi><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>return&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;false</mtext></mrow></mstyle></mtd></mtr></mtable></menclose><mo>‚âà</mo><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>bcr-fake</mtext><mi mathvariant="normal">Œ£</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>TEST</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>‚àà</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mo>‚àó</mo></msup><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;false</mtext></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad \qquad\mathcal{L}_{\text {brc-real}}^{\Sigma}\\\hline
s\leftarrow S\\
H_{inv}:=\text{empty assoc. array}\\
\underline{\text{TEST}(x,\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^*):}\\
\quad y:=H(s,x)\\
\quad \text{if}\ H_{inv}[y]\ \text{define and}\ H_{inv}[y]\neq x:\\
\qquad \text{return}\ H_{inv}[y]\\
\quad H_{inv}[y]:=x\\
\quad \text{return false}\\\hline
\end{array} 
\approx
\begin{array}{|l|}\hline
\qquad \quad\mathcal{L}_{\text {bcr-fake}}^{\Sigma}\\\hline
\underline{\text{TEST}(x\in\{\textcolor{brown}{0},\textcolor{brown}{1}\}^*):}\\
\quad \text{return false}\\\hline
\end{array} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 16.25em; vertical-align: -7.85em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.4em;"><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 10.35em;"></span><span class="mtable"><span class="vertical-separator" style="height: 16.2em; vertical-align: -7.85em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.35em;"><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">brc-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">TEST</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">define&nbsp;and</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">x</span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;false</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 7.85em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 16.2em; vertical-align: -7.85em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 10.35em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -16.9em;"><span class="pstrut" style="height: 10.35em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -18.7em;"><span class="pstrut" style="height: 10.35em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 7.85em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 5.45em; vertical-align: -2.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 4.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 5.4em; vertical-align: -2.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bcr-fake</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Œ£</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">TEST</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚àà</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">‚àó</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;false</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 5.4em; vertical-align: -2.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -6.1em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -7.9em;"><span class="pstrut" style="height: 4.95em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>In these libraries, the calling program chooses inputs <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> to the UHF. The <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>bcr-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {bcr-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bcr-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> library maintains a private record of all of the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> values and their hashes, in the form of a reverse lookup table. <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mtext>inv&nbsp;</mtext></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H_{\text {inv }}[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">inv&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> will hold the value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> that was hashed to result in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span>.</p>
<p>If the calling program calls <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">TEST</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\operatorname{TEST}(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">T</span><span class="mord mathrm">E</span><span class="mord mathrm">S</span><span class="mord mathrm">T</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span> on a value that collides with a previous <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x^{\prime},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.946332em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>bcr-real&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {bcr-real }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bcr-real&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> will respond with this <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> value (the purpose of this is just to be helpful to security proofs that use these libraries); otherwise it will respond with false, giving no information about <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> or <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(s, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span>. The other library always responds with false. Hence, the two are indistinguishable only if finding collisions is hard.</p>
<p><strong>to-do</strong></p>
<blockquote>
<p>Proof to come. It‚Äôs not hard but tedious.</p>
</blockquote>
<h3 id="constructing-uhfs-using-polynomials">Constructing UHFs using Polynomials</h3>
<p>UHFs have much weaker security than other kinds of hashing, and they can in fact be constructed unconditionally. One of the mathematically simplest constructions has to do with polynomials.</p>
<p><strong>Claim 12.8</strong><br>
Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span></span> be a prime and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span></span></span></span></span> be a nonzero polynomial with coefficients in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.974998em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> and degree at most <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span>. Then <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span></span></span></span></span> has at most <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">d</span></span></span></span></span> zeroes from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.974998em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>.</p>
<p>This observation leads to a simple UHF construction, whose idea is to interpret the string <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> as the coefficients of a polynomial, and evaluate that polynomial at point <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> (the salt of the UHF). In more detail, let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span></span> be a prime with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>&gt;</mo><msup><mn>2</mn><mi>Œª</mi></msup></mrow><annotation encoding="application/x-tex">p&gt;2^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.73354em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">Œª</span></span></span></span></span></span></span></span></span></span></span></span></span>, and let the salt <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> be a uniformly chosen element of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{Z}_{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.974998em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. To compute the hash of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>, first split <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> into <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Œª</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">Œª</span></span></span></span></span> -bit blocks, which will be convenient to index as <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mrow><mo fence="true">‚à•</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>2</mn></mrow></msub><mo fence="true">‚à•</mo></mrow><mo>‚Ä¶</mo><mi mathvariant="normal">‚à•</mi><msub><mi>x</mi><mn>0</mn></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">x_{d-1}\left\|x_{d-2}\right\| \ldots \| x_{0} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">‚à•</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">‚à•</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">‚à•</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> Interpret each <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.58056em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> as a number mod <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span></span>. Then, the value of the hash <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(s, x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></span> is:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>s</mi><mi>d</mi></msup><mo>+</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><msup><mi>s</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>+</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>2</mn></mrow></msub><msup><mi>s</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>2</mn></mrow></msup><mo>+</mo><mo>‚ãØ</mo><mo>+</mo><msub><mi>x</mi><mn>0</mn></msub><mspace width="1em"></mspace><mo stretchy="false">(</mo>‚Ää<mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow>‚Ää<mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">
s^{d}+x_{d-1} s^{d-1}+x_{d-2} s^{d-2}+\cdots+x_{0} \quad(\bmod p)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.982438em; vertical-align: -0.08333em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.10744em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.10744em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.66666em; vertical-align: -0.08333em;"></span><span class="minner">‚ãØ</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mopen">(</span><span class="mspace" style="margin-right: 0.0555556em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right: 0.0555556em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></span></span><br>
This is the result of evaluating a polynomial with coefficients <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>2</mn></mrow></msub><mo separator="true">,</mo><mo>‚Ä¶</mo><mo separator="true">,</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(1, x_{d-1}, x_{d-2}, \ldots, x_{0}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> at the point <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span>. A convenient way to evaluate this polynomial is by using <strong>Horner‚Äôs rule</strong>:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>‚ãØ</mo><mi>s</mi><mo>‚ãÖ</mo><mrow><mo fence="true">(</mo><mi>s</mi><mo>‚ãÖ</mo><mrow><mo fence="true">(</mo><mi>s</mi><mo>+</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>2</mn></mrow></msub><mo fence="true">)</mo></mrow><mo>+</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>3</mn></mrow></msub><mo>‚ãØ</mo></mrow><annotation encoding="application/x-tex">
\cdots s \cdot\left(s \cdot\left(s+x_{d-1}\right)+x_{d-2}\right)+x_{d-3} \cdots
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.44445em; vertical-align: 0em;"></span><span class="minner">‚ãØ</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.638891em; vertical-align: -0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">‚ãØ</span></span></span></span></span></span><br>
Horner‚Äôs rule can be expressed visually as follows:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="red"><mtext>Image&nbsp;screenshot&nbsp;here</mtext></mstyle></mrow><annotation encoding="application/x-tex">
\textcolor{red}{{\text{Image screenshot here}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord" style="color: red;"><span class="mord text" style="color: red;"><span class="mord" style="color: red;">Image&nbsp;screenshot&nbsp;here</span></span></span></span></span></span></span></span><br>
The UHF construction is described formally below.</p>
<p><strong>Construction 12.9 (Poly-UHF)</strong></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>p</mi><mo>=</mo><mi>a</mi><mtext>&nbsp;</mtext><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mtext>&nbsp;</mtext><mo>&gt;</mo><msup><mn>2</mn><mi>Œª</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>S</mi><mo>=</mo><msub><mi mathvariant="double-struck">Z</mi><mi>p</mi></msub></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>write&nbsp;</mtext><mi>x</mi><mo>=</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">‚à•</mi><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>2</mn></mrow></msub><mi mathvariant="normal">‚à•</mi><mo>‚ãØ</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator="true">,</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>where&nbsp;each&nbsp;</mtext><mi mathvariant="normal">‚à£</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">‚à£</mi><mo>=</mo><mi>Œª</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>for&nbsp;</mtext><mi>i</mi><mo>=</mo><mi>d</mi><mo>‚àí</mo><mn>11</mn><mtext>&nbsp;down&nbsp;to&nbsp;</mtext><mn>0</mn><mo>:</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msub><mi>y</mi><mi>i</mi></msub><mo>:</mo><mo>=</mo><mi>s</mi><mo>‚ãÖ</mo><mi>y</mi><mo>+</mo><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant="normal">%</mi><mi>p</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>y</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|ll|}\hline
\begin{array}{l}
p=a\ prime\ &gt;2^\lambda\\
S=\mathbb{Z}_p
\end{array}&amp;
\begin{array}{l}
\underline{H(s,x):}\\
\quad\text{write}\ x=x_{d-1}\|x_{d-2}\|\cdots x_0,\\
\qquad \text{where each}\ |x_i|=\lambda\\
\quad y:=1\\
\quad \text{for}\ i=d-11\ \text{down to}\ 0:\\
\qquad y_i:=s\cdot y+x_i\% p\\
\quad \text{return}\ y\\
\end{array}\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.65em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.6em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.05em;"><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">a</span><span class="mspace">&nbsp;</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right: 0.02778em;">r</span><span class="mord mathdefault">i</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mspace">&nbsp;</span><span class="mrel">&gt;</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Œª</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 1.55em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">write</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mord">‚à•</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mord">‚à•</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">‚ãØ</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">where&nbsp;each</span></span><span class="mspace">&nbsp;</span><span class="mord">‚à£</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">‚à£</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">Œª</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord">1</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">for</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">down&nbsp;to</span></span><span class="mspace">&nbsp;</span><span class="mord">0</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.03588em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚ãÖ</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathdefault">p</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>Claim 12.10</strong><br>
The Poly-UHF construction is a secure UHF.</p>
<p><strong>Proof</strong><br>
It suffices to show that, for any <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mi mathvariant="normal">‚â†</mi><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x \neq x^{\prime},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.946332em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> the probability that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mrow><mo fence="true">(</mo><mi>s</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(s, x)=H\left(s, x^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> (taken over random choice of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> ) is negligible. Note that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(s, x)=g(s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span></span>, where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span></span></span></span></span> is a polynomial whose coefficients are <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">(</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>d</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>‚Ä¶</mo><mo separator="true">,</mo><msub><mi>x</mi><mn>0</mn></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\left(1, x_{d-1}, \ldots, x_{0}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">d</span><span class="mbin mtight">‚àí</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.208331em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner">‚Ä¶</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.301108em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mrow><mo fence="true">(</mo><mi>s</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo fence="true">)</mo></mrow><mo>=</mo><msup><mi>g</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">H\left(s, x^{\prime}\right)=g^{\prime}(s),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>g</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">g^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.946332em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> is a similar polynomial derived from <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">x^{\prime} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> Note that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> may be split into a different number of blocks, leading to different degrees <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">(</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">\left(d\right.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">d</span><span class="mclose nulldelimiter"></span></span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left.d^{\prime}\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="minner"><span class="mopen nulldelimiter"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span></span></span></span></span> for the two polynomials.</p>
<p>In order to have a collision <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mrow><mo fence="true">(</mo><mi>s</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">H(s, x)=H\left(s, x^{\prime}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> we must have<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><msub><mo>‚â°</mo><mi>p</mi></msub><msup><mi>g</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mo>‚ü∫</mo><mi>g</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>‚àí</mo><msup><mi>g</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><msub><mo>‚â°</mo><mi>p</mi></msub><mn>0</mn></mrow><annotation encoding="application/x-tex">
g(s) \equiv_{p} g^{\prime}(s)\\\Longleftrightarrow g(s)-g^{\prime}(s) \equiv_{p} 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.03611em; vertical-align: -0.286108em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel">‚â°</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.05189em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height: 0.549em; vertical-align: -0.024em;"></span><span class="mrel">‚ü∫</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.088em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.801892em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel">‚â°</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-left: 0em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">0</span></span></span></span></span></span></p>
<p>Note that the left-hand side in this equation is a polynomial of degree at most <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>‚àó</mo></msup><mo>=</mo></mrow><annotation encoding="application/x-tex">d^{*}=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span></span></span></span></span> <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>max</mi><mo>‚Å°</mo><mrow><mo fence="true">{</mo><mi>d</mi><mo separator="true">,</mo><msup><mi>d</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo fence="true">}</mo></mrow><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\max \left\{d, d^{\prime}\right\} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mop">max</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">{</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">}</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord">.</span></span></span></span></span> Furthermore, that polynomial <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>‚àí</mo><msup><mi>g</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">g-g^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.946332em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> is not the zero polynomial because <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>g</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">g^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.946332em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> are different polynomials. Even if the original strings <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> differ only in blocks of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="brown"><mn>0</mn></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{brown}{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord" style="color: brown;">0</span></span></span></span></span> s, the resulting <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>g</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">g^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.946332em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> will be different polynomials because they include an extra leading coefficient of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1.</mn></mrow><annotation encoding="application/x-tex">1 .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.64444em; vertical-align: 0em;"></span><span class="mord">1</span><span class="mord">.</span></span></span></span></span></p>
<p>A collision happens if and only if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> is chosen to be one of the roots of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mo>‚àí</mo><msup><mi>g</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">g-g^{\prime} .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.77777em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.946332em; vertical-align: -0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span> From Claim 12.8 , the polynomial has at most <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>‚àó</mo></msup></mrow><annotation encoding="application/x-tex">d^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span></span></span></span></span> roots, so the probability of choosing one of them is at most:<br>
<span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>‚àó</mo></msup><mi mathvariant="normal">/</mi><mi>p</mi><mo>‚©Ω</mo><msup><mi>d</mi><mo>‚àó</mo></msup><mi mathvariant="normal">/</mi><msup><mn>2</mn><mi>Œª</mi></msup><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">
d^{*} / p \leqslant d^{*} / 2^{\lambda}.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel amsrm">‚©Ω</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.14911em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.738696em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.899108em;"><span class="" style="top: -3.113em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">Œª</span></span></span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></span><br>
This probability is negligible since <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>d</mi><mo>‚àó</mo></msup></mrow><annotation encoding="application/x-tex">d^{*}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.688696em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚àó</span></span></span></span></span></span></span></span></span></span></span></span></span> is polynomial in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Œª</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">Œª</span></span></span></span></span> (it is the number of blocks in a string that was written down by the attacker, who runs in polynomial time in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Œª</mi></mrow><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">Œª</span></span></span></span></span> ).</p>
<p><strong>to-do</strong></p>
<blockquote>
<p>Fine print: this works but modular multiplication is not fast. If you want this to be fast, you would use a binary finite field. It is not so bad to describe what finite fields are, but doing so involves more polynomials. Then when you make polynomials whose coecients are finite field elements, it runs the risk of feeling like polynomials over polynomials (because at some level it is). Not sure how I will eventually deal with this.</p>
</blockquote>
<h3 id="carter-wegman-uhf-based-mac">Carter-Wegman UHF-based MAC</h3>
<p>A UHF by itself is not a good MAC, even when its salt <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">s</span></span></span></span></span> is kept secret. This is because the security of a MAC must hold even when the attacker sees the function‚Äôs outputs, but a UHF provides security (blind collision-resistance) only when the attacker does not see the UHF outputs.</p>
<p>The Carter-Wegman MAC technique augments a UHF by sending its output through a PRF, so the MAC of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">m</span></span></span></span></span> is <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k, H(s, m))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">m</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> is a UHF and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a PRF.</p>
<p><strong>Construction 12.11 (Carter-Wegman)</strong></p>
<p>Let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> be a UHF with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span></span></span></span></span> bits of output, and let <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span></span></span></span></span> be a secure PRF with in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">=n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">n</span></span></span></span></span>. The CarterWegman construction combines them as follows:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>KeyGen</mtext><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>k</mi><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>Œª</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>MAC</mtext><mo fence="false">(</mo><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>x</mi><mo fence="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|ll|}\hline
\begin{array}{l}
\underline{\text{KeyGen}:}\\
\quad  k\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
\quad s\leftarrow S\\
\quad \text{return}\ (k,s)
\end{array}&amp;
\begin{array}{l}
\underline{\text{MAC}\Big((k,s),x\Big):}\\
\quad y:=H(s,x)\\
\quad \text{return}\ F(k,y)\\
\end{array}\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 7.25em; vertical-align: -3.35em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.9em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mtable"><span class="vertical-separator" style="height: 7.2em; vertical-align: -3.35em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.68333em;"><span class="" style="top: -2.64556em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">KeyGen</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.39444em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Œª</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.85em;"><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 5.85em;"></span><span class="mord"><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 3.10501em;"><span class="" style="top: -5.10501em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.15em;"><span class="" style="top: -2.33998em;"><span class="pstrut" style="height: 3.15em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.15em;"></span><span class="mord"><span class="mord text"><span class="mord">MAC</span></span><span class="mord"><span class="delimsizing size2">(</span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mord"><span class="delimsizing size2">)</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.85002em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.99499em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: -1.19499em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.60501em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 7.2em; vertical-align: -3.35em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -9.7em;"><span class="pstrut" style="height: 5.85em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 3.35em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>We will show that the Carter-Wegman construction is a secure PRF. Recall that this implies that the construction is also a secure MAC (Claim 10.4). Note that the Carter-Wegman construction also <em>uses</em> a PRF as a building block. However, it uses a PRF for short messages, to construct a PRF for arbitrary-length messages. Furthermore, it only calls the underlying PRF once, and all other computations involving the UHF are comparatively ‚Äúcheap.‚Äù</p>
<p>To understand the security of Carter-Wegman, we work backwards. The output <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(k, H(s, x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span> comes directly from a PRF. These outputs will look random as long as the inputs to the PRF are distinct. In this construction, the only way for PRF inputs to repeat is for there to be a collision in the UHF <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">H .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mord">.</span></span></span></span></span> However, we have to be careful. We can only reason about the collision-resistance of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> when its salt is secret and its outputs are hidden from the attacker. The salt is indeed hidden in this case (kept as part of the Carter-Wegman key), but its outputs are being used as PRF inputs. Fortunately, the guarantee of a PRF is that its outputs appear unrelated to its inputs. In other words, the PRF outputs leak no information about the PRF inputs (H-outputs). Indeed, this appears to be a situation where the UHF outputs are hidden from the attacker, so we can argue that collisions in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> are negligibly likely.</p>
<p><strong>Claim 12.12</strong><br>
If <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> is a secure UHF and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span></span></span></span></span> is a secure PRF, then the Carter-Wegman construction (Construction 12.11) is a secure PRF, and hence a secure MAC as well.</p>
<p><strong>Proof</strong><br>
We will show that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-real&nbsp;</mtext><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">W</mi></mrow></msubsup><mo>‚âà</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">W</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-real }}^{\mathrm{CW}} \approx \mathcal{L}_{\text {prf-rand }}^{\mathrm{CW}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">C</span><span class="mord mathrm mtight" style="margin-right: 0.01389em;">W</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">C</span><span class="mord mathrm mtight" style="margin-right: 0.01389em;">W</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span> using a standard hybrid technique.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>&nbsp;&nbsp;</mtext><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mtext>CW</mtext></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>k</mi><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mi>Œª</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mo stretchy="false">(</mo><mi>k</mi><mo separator="true">,</mo><mi>s</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>The&nbsp;starting&nbsp;point&nbsp;is&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mtext>CW</mtext></msubsup></mstyle><mtext>.</mtext></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\quad \ \ \mathcal{L}_{\text{prf-real}}^{\text{CW}}\\\hline
k\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^\lambda\\
s\leftarrow S\\
\underline{\text{LOOKUP}(x):}\\
\quad y:=H(s,x)\\
\quad \text{return}\ (k,s)\\\hline
\end{array}
\quad
\begin{array}{l}
\text{The starting point is $\mathcal{L}_{\text{prf-real}}^{\text{CW}}$.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 10.85em; vertical-align: -5.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.7em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mspace">&nbsp;</span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CW</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">Œª</span></span></span></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right: 0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">s</span><span class="mclose">)</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.15em;"><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">The&nbsp;starting&nbsp;point&nbsp;is&nbsp;</span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CW</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.65em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>We&nbsp;have&nbsp;applied&nbsp;the&nbsp;security&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><mi>F</mi></mstyle><mtext>&nbsp;,&nbsp;by&nbsp;factoring&nbsp;out&nbsp;in</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>terms&nbsp;of&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>prf-real</mtext><mtext>F</mtext></msubsup></mstyle><mtext>,&nbsp;replacing&nbsp;it&nbsp;with&nbsp;</mtext><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mtext>F</mtext></msubsup></mstyle><mtext>,&nbsp;and&nbsp;inlining</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>the&nbsp;result.</mtext></mstyle></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
T:=\text{empty assoc. array}\\
s\leftarrow S\\
\underline{\text{LOOKUP}(x):}\\
\quad y:=H(s,x)\\
\quad \text{if}\ T[y]\ \text{undefined:}\\
\qquad T[y]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}\\
\quad \text{return}\ T[y]\\\hline
\end{array}
\quad
\begin{array}{l}
\text{We have applied the security of $F$ , by factoring out in}\\
\text{terms of $\mathcal{L}_{\text{prf-real}}^{\text{F}}$, replacing it with $\mathcal{L}_{\text{prf-rand}}^{\text{F}}$, and inlining}\\
\text{the result.}
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 12.65em; vertical-align: -6.05em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.6em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 8.55em;"></span><span class="mtable"><span class="vertical-separator" style="height: 12.6em; vertical-align: -6.05em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 6.55em;"><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 12.6em; vertical-align: -6.05em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -15.1em;"><span class="pstrut" style="height: 8.55em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 6.05em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 2.95em;"><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">We&nbsp;have&nbsp;applied&nbsp;the&nbsp;security&nbsp;of&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.13889em;">F</span><span class="mord">&nbsp;,&nbsp;by&nbsp;factoring&nbsp;out&nbsp;in</span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">terms&nbsp;of&nbsp;</span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">F</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">,&nbsp;replacing&nbsp;it&nbsp;with&nbsp;</span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">F</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mord">,&nbsp;and&nbsp;inlining</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord text"><span class="mord">the&nbsp;result.</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 2.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span></span></span></span></span></span></span></span></p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
cache := \text{empty assoc. array}\\
T:=\text{empty assoc. array}\\
s\leftarrow S\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{if}\ cache [x]\ \text{undefined:}\\
\qquad y:=H(s,x)\\
\qquad \text{if}\ T[y]\ \text{undefined:}\\
\qquad \quad T[y]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}\\
\quad cache[x]:=T[y]\\
\quad  \text{return}\ cache[x]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 18.05em; vertical-align: -8.75em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.3em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 11.25em;"></span><span class="mtable"><span class="vertical-separator" style="height: 18em; vertical-align: -8.75em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 9.25em;"><span class="" style="top: -11.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span><span class="" style="top: 4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 18em; vertical-align: -8.75em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -20.5em;"><span class="pstrut" style="height: 11.25em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 8.75em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>The lookup subroutine has the property that if it is called on the same <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> twice, it will return the same result. It therefore does no harm to cache the answer every time. The second time lookup is called on the same value <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>, the previous value is loaded from cache rather than recomputed. This change has no effect on the calling program.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;defined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo>:</mo><mo>=</mo><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
cache := \text{empty assoc. array}\\
H_{inv}:=\text{empty assoc. array}\\
T:=\text{empty assoc. array}\\
s\leftarrow S\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{if}\ cache [x]\ \text{undefined:}\\
\qquad y:=H(s,x)\\
\qquad \text{if}\ H_{inv}[y]\ \text{defined:}\\
\qquad \quad x':=H_{inv}[y]\\
\qquad \quad \text{return}\ cache [x']\\
\qquad \text{if}\ T[y]\ \text{undefined:}\\
\qquad \quad T[y]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}\\
\qquad H_{inv}[y]:=x\\
\qquad cache[x]:=T[y]\\
\quad  \text{return}\ cache[x]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 27.05em; vertical-align: -13.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.8em;"><span class="" style="top: -15.75em;"><span class="pstrut" style="height: 15.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 27em; vertical-align: -13.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.75em;"><span class="" style="top: -15.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">defined:</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">x</span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span><span class="" style="top: 9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 13.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 27em; vertical-align: -13.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 15.75em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -29.5em;"><span class="pstrut" style="height: 15.75em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 13.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Note that if LOOKUP is first called on <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> and then later on <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">x,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span></span></span></span></span> where <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mrow><mo fence="true">(</mo><mi>s</mi><mo separator="true">,</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo fence="true">)</mo></mrow><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">H(s, x)=H\left(s, x^{\prime}\right),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.00189em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top: 0em;">)</span></span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mpunct">,</span></span></span></span></span> LOOKUP will return the same result. We therefore modify the library to keep track of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> -outputs and inputs. Whenever the library computes <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">y=H(s, x),</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span></span> it stores <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mtext>inv&nbsp;</mtext></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">H_{\text {inv }}[y]=x .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">inv&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span><span class="mord">.</span></span></span></span></span> However, if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mtext>inv&nbsp;</mtext></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H_{\text {inv }}[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">inv&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> already exists, it means that this <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> and <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo>=</mo><msub><mi>H</mi><mtext>inv&nbsp;</mtext></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x^{\prime}=H_{\text {inv }}[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">inv&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> are a collision under <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">H .</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mord">.</span></span></span></span></span> In that case, the library directly returns whatever it previously returned on input <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span>. This change has no effect on the calling program.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>T</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;defined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo>:</mo><mo>=</mo><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
cache := \text{empty assoc. array}\\
H_{inv}:=\text{empty assoc. array}\\
T:=\text{empty assoc. array}\\
s\leftarrow S\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{if}\ cache [x]\ \text{undefined:}\\
\qquad y:=H(s,x)\\
\qquad \text{if}\ H_{inv}[y]\ \text{defined:}\\
\qquad \quad x':=H_{inv}[y]\\
\qquad \quad \text{return}\ cache [x']\\
\qquad \text{if}\ H_{inv}[y]\ \text{undefined:}\\
\qquad \quad T[y]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}\\
\qquad H_{inv}[y]:=x\\
\qquad cache[x]:=T[y]\\
\quad  \text{return}\ cache[x]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 27.05em; vertical-align: -13.25em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.8em;"><span class="" style="top: -15.75em;"><span class="pstrut" style="height: 15.75em;"></span><span class="mtable"><span class="vertical-separator" style="height: 27em; vertical-align: -13.25em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 13.75em;"><span class="" style="top: -15.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">defined:</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">x</span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span><span class="" style="top: 9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 13.25em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 27em; vertical-align: -13.25em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 15.75em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -29.5em;"><span class="pstrut" style="height: 15.75em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 13.25em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>In the previous hybrid, <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> is set at the same time <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H_{inv}[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> is set ‚Äî on the first call lOOKUP (<span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span>) such that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">H(s, x) = y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span></span></span></span></span>. Therefore, it has no effect on the calling program to check whether <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> is defined or check whether <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H_{inv}[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> is defined.</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;defined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo>:</mo><mo>=</mo><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
cache := \text{empty assoc. array}\\
H_{inv}:=\text{empty assoc. array}\\
s\leftarrow S\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{if}\ cache [x]\ \text{undefined:}\\
\qquad y:=H(s,x)\\
\qquad \text{if}\ H_{inv}[y]\ \text{defined:}\\
\qquad \quad x':=H_{inv}[y]\\
\qquad \quad \text{return}\ cache [x']\\
\qquad \text{if}\ H_{inv}[y]\ \text{undefined:}\\
\qquad \quad cache[x]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}\\
\qquad H_{inv}[y]:=x\\
\quad  \text{return}\ cache[x]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 23.45em; vertical-align: -11.45em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 12em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 13.95em;"></span><span class="mtable"><span class="vertical-separator" style="height: 23.4em; vertical-align: -11.45em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 11.95em;"><span class="" style="top: -13.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -12.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">defined:</span></span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">x</span></span></span><span class="" style="top: 7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 23.4em; vertical-align: -11.45em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -25.9em;"><span class="pstrut" style="height: 13.95em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 11.45em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Note that if <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mtext>inv&nbsp;</mtext></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H_{\text {inv }}[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">inv&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> is defined, then Lookup returns within that if-statement. The line cache <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x]:=T[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span><span class="base"><span class="strut" style="height: 0.36687em; vertical-align: 0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> is therefore only executed in the case that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mtext>inv&nbsp;</mtext></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">H_{\text {inv }}[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">inv&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> was not initially defined. Instead of choosing <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">T[y]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span></span></span> only to immediately assign it to cache <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span></span>, we just assign directly to cache <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span></span>. This change has no effect on the calling program, and it does away with the <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.13889em;">T</span></span></span></span></span> associative array entirely.</p>
<p>The if-statements involving <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>H</mi><mtext>inv&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">H_{\text {inv }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.317502em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">inv&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> in this hybrid are checking whether <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.43056em; vertical-align: 0em;"></span><span class="mord mathdefault">x</span></span></span></span></span> has collided with any previous <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup></mrow><annotation encoding="application/x-tex">x^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.751892em; vertical-align: 0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span></span></span></span></span> under <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span>. All of this logic, including the evaluation of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">H,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.87777em; vertical-align: -0.19444em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mpunct">,</span></span></span></span></span> can be factored out in terms of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>bcr-real&nbsp;</mtext><mi>H</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {bcr-real }}^{H}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bcr-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.08125em;">H</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span></span></span>. At this point in the sequence of hybrids, the output of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> is not needed, except to check whether a collision has been encountered (and if so, what the offending inputs are). Again, this change has no effect on the calling program. The result is:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;TEST</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mi mathvariant="normal">‚â†</mi><mtext>false</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><msup><mi>x</mi><mo mathvariant="normal">‚Ä≤</mo></msup><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>else</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose><mspace width="1em"></mspace><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>bcr-real</mtext><mi>H</mi></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mo>‚Üê</mo><mi>S</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>TEST</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mi>y</mi><mo>:</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>s</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mtext>if&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mtext>&nbsp;defined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><msub><mi>H</mi><mrow><mi>i</mi><mi>n</mi><mi>v</mi></mrow></msub><mo stretchy="false">[</mo><mi>y</mi><mo stretchy="false">]</mo><mo>:</mo><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;false</mtext></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
cache := \text{empty assoc. array}\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{if}\ cache [x]\ \text{undefined:}\\
\qquad \text{if TEST}(x)+x'\neq \text{false}\\
\qquad \quad \text{return} \ cache[x']\\
\qquad\text{else}\\
\qquad \quad cache[x]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}\\
\quad  \text{return}\ cache[x]\\\hline
\end{array}
\quad
\begin{array}{|l|}\hline
\qquad \qquad\mathcal{L}_{\text{bcr-real}}^H\\\hline
s\leftarrow S\\
H_{inv}:=\text{empty assoc. array}\\
\underline{\text{TEST}(x):}\\
\qquad y:=H(s,x)\\
\qquad \text{if}\ H_{inv}[y]\ \text{defined:}\\
\qquad \quad \text{return}\ H_{inv}[y]\\
\qquad H_{inv}[y]:=x\\
\quad  \text{return false}\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 16.25em; vertical-align: -7.85em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.5em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 9.45em;"></span><span class="mtable"><span class="vertical-separator" style="height: 14.4em; vertical-align: -6.95em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 7.45em;"><span class="" style="top: -9.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if&nbsp;TEST</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">false</span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.751892em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">‚Ä≤</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">else</span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 14.4em; vertical-align: -6.95em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -16.9em;"><span class="pstrut" style="height: 9.45em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 6.95em;"><span class=""></span></span></span></span></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.4em;"><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 10.35em;"></span><span class="mtable"><span class="vertical-separator" style="height: 16.2em; vertical-align: -7.85em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 8.35em;"><span class="" style="top: -10.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bcr-real</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right: 0.08125em;">H</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -8.55em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.05764em;">S</span></span></span><span class="" style="top: -6.75em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.95em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">TEST</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -3.15em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span><span class="" style="top: -1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">defined:</span></span></span></span><span class="" style="top: 0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span></span></span><span class="" style="top: 2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.311664em;"><span class="" style="top: -2.55em; margin-left: -0.08125em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right: 0.03588em;">v</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right: 0.03588em;">y</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord mathdefault">x</span></span></span><span class="" style="top: 4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return&nbsp;false</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 7.85em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 16.2em; vertical-align: -7.85em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 10.35em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -16.9em;"><span class="pstrut" style="height: 10.35em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -18.7em;"><span class="pstrut" style="height: 10.35em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 7.85em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>The security of <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.68333em; vertical-align: 0em;"></span><span class="mord mathdefault" style="margin-right: 0.08125em;">H</span></span></span></span></span> is that we can swap <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>bcr-real&nbsp;</mtext><mi>H</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {bcr-real }}^{H}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bcr-real&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.08125em;">H</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span></span></span></span></span> for <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>bcr-fake&nbsp;</mtext><mi>H</mi></msubsup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {bcr-fake }}^{H},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.12444em; vertical-align: -0.283108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bcr-fake&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right: 0.08125em;">H</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.283108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> with negligible effect on the calling program. Note that TEST algorithm in <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>bcr-fake&nbsp;</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {bcr-fake }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.83333em; vertical-align: -0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.336108em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">bcr-fake&nbsp;</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span> always returns false. This leads us to simply remove the ‚Äúif <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">TEST</mi><mo>‚Å°</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mi mathvariant="normal">‚â†</mi></mrow><annotation encoding="application/x-tex">\operatorname{TEST}(x) \neq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mop"><span class="mord mathrm">T</span><span class="mord mathrm">E</span><span class="mord mathrm">S</span><span class="mord mathrm">T</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.69444em;"><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="rlap"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.19444em;"><span class=""></span></span></span></span></span></span><span class="mrel">=</span></span></span></span></span></span> false‚Äù clause, resulting in the following:</p>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><menclose notation="top bottom left right"><mtable rowspacing="0.6599999999999999em" columnalign="left" columnspacing="1em" rowlines="solid none none none none"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="2em"></mspace><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand</mtext><mtext>CW</mtext></msubsup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo>:</mo><mo>=</mo><mtext>empty&nbsp;assoc.&nbsp;array</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><munder accentunder="true"><mrow><mtext>LOOKUP</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>:</mo></mrow><mo stretchy="true">‚Äæ</mo></munder></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>if&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mtext>&nbsp;undefined:</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="2em"></mspace><mspace width="1em"></mspace><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo>‚Üê</mo><mo stretchy="false">{</mo><mstyle mathcolor="brown"><mn>0</mn></mstyle><mo separator="true">,</mo><mstyle mathcolor="brown"><mn>1</mn></mstyle><msup><mo stretchy="false">}</mo><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"></mspace><mtext>return&nbsp;</mtext><mi>c</mi><mi>a</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow></mstyle></mtd></mtr></mtable></menclose></mrow><annotation encoding="application/x-tex">
\def\arraystretch{1.5}
\begin{array}{|l|}\hline
\qquad \qquad \mathcal{L}_{\text{prf-rand}}^{\text{CW}}\\\hline
cache := \text{empty assoc. array}\\
\underline{\text{LOOKUP}(x):}\\
\quad \text{if}\ cache [x]\ \text{undefined:}\\
\qquad \quad cache[x]\leftarrow \{\textcolor{brown}{0},\textcolor{brown}{1}\}^{out}\\
\quad  \text{return}\ cache[x]\\\hline
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 10.85em; vertical-align: -5.15em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.7em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 7.65em;"></span><span class="mtable"><span class="vertical-separator" style="height: 10.8em; vertical-align: -5.15em;"></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 5.65em;"><span class="" style="top: -7.65em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 2em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">CW</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span><span class="" style="top: -5.85em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mord text"><span class="mord">empty&nbsp;assoc.&nbsp;array</span></span></span></span><span class="" style="top: -4.05em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mord underline"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.75em;"><span class="" style="top: -2.59em;"><span class="pstrut" style="height: 3em;"></span><span class="underline-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3em;"><span class="pstrut" style="height: 3em;"></span><span class="mord"><span class="mord text"><span class="mord">LOOKUP</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">:</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.45em;"><span class=""></span></span></span></span></span></span></span><span class="" style="top: -2.25em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">if</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace">&nbsp;</span><span class="mord text"><span class="mord">undefined:</span></span></span></span><span class="" style="top: -0.45em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 2em;"></span><span class="mspace" style="margin-right: 1em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚Üê</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mopen">{</span><span class="mord" style="color: brown;">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="mord" style="color: brown;">1</span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.793556em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span></span></span></span></span></span></span></span><span class="" style="top: 1.35em;"><span class="pstrut" style="height: 3.26em;"></span><span class="mord"><span class="mspace" style="margin-right: 1em;"></span><span class="mord text"><span class="mord">return</span></span><span class="mspace">&nbsp;</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span><span class="arraycolsep" style="width: 0.5em;"></span><span class="vertical-separator" style="height: 10.8em; vertical-align: -5.15em;"></span></span></span><span class="" style="top: -2.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -11.5em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span><span class="" style="top: -13.3em;"><span class="pstrut" style="height: 7.65em;"></span><span class="hline" style="border-bottom-width: 0.05em;"></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 5.15em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<p>Since this is exactly <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">W</mi></mrow></msubsup><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }}^{\mathrm{CW}},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">C</span><span class="mord mathrm mtight" style="margin-right: 0.01389em;">W</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> we are done. We have shown that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">W</mi></mrow></msubsup><mo>‚âà</mo><msubsup><mi mathvariant="script">L</mi><mtext>prf-rand&nbsp;</mtext><mrow><mi mathvariant="normal">C</mi><mi mathvariant="normal">W</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text {prf-rand }}^{\mathrm{CW}} \approx \mathcal{L}_{\text {prf-rand }}^{\mathrm{CW}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">C</span><span class="mord mathrm mtight" style="margin-right: 0.01389em;">W</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">‚âà</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 1.26055em; vertical-align: -0.419216em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.841331em;"><span class="" style="top: -2.41689em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">prf-rand&nbsp;</span></span></span></span></span><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">C</span><span class="mord mathrm mtight" style="margin-right: 0.01389em;">W</span></span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.419216em;"><span class=""></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="galois-counter-mode-for-aead">12.4 Galois Counter Mode for AEAD</h2>
<p>The most common block cipher mode for AEAD is called Galois Counter Mode (GCM). GCM is essentially an instance of encrypt-then-MAC, combining CTR mode for encryption and the polynomial-based Carter-Wegman MAC for authentication. GCM is relatively inexpensive since it requires only one call to the block cipher per plaintext block, plus one multiplication for each block of ciphertext + associated data.</p>
<p>Rather than using polynomials over <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="double-struck">Z</mi><mi>p</mi></msub><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}_{p},</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.974998em; vertical-align: -0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">Z</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 0.151392em;"><span class="" style="top: -2.55em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height: 0.286108em;"><span class=""></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span></span> GCM mode uses polynomials defined over a finite field with <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>Œª</mi></msup></mrow><annotation encoding="application/x-tex">2^{\lambda}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.849108em; vertical-align: 0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height: 0.849108em;"><span class="" style="top: -3.063em; margin-right: 0.05em;"><span class="pstrut" style="height: 2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">Œª</span></span></span></span></span></span></span></span></span></span></span></span></span> elements. Such fields are often called ‚ÄúGalois fields,‚Äù which leads to the name Galois counter mode.</p>
<p><strong>to-do</strong></p>
<blockquote>
<p>More information about GCM will go here. Again, be nice to have a crash co finite fields.</p>
</blockquote>
<p><span class="katex--display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mstyle mathcolor="red"><mtext>Image&nbsp;screenshot&nbsp;here</mtext></mstyle></mrow><annotation encoding="application/x-tex">
\textcolor{red}{{\text{Image screenshot here}}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.88888em; vertical-align: -0.19444em;"></span><span class="mord" style="color: red;"><span class="mord text" style="color: red;"><span class="mord" style="color: red;">Image&nbsp;screenshot&nbsp;here</span></span></span></span></span></span></span></span></p>
<h3 id="exercises">Exercises</h3>
<p><strong>to-do</strong></p>
<blockquote>
<p>‚Ä¶ more on the way ‚Ä¶</p>
</blockquote>
<p>12.1. Suppose Enc-then-MAC+AD is instantiated with CBC mode and any secure MAC, as described in Construction 12.4. The scheme is secure for fixed-length associated data. Show that if variable-length associated data is allowed, then the scheme does not provide AEAD security.</p>
<p>Note: you are not attacking the MAC! Take advantage of the fact that <span class="katex--inline"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi mathvariant="normal">‚à•</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">d\|c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 1em; vertical-align: -0.25em;"></span><span class="mord mathdefault">d</span><span class="mord">‚à•</span><span class="mord mathdefault">c</span></span></span></span></span> is ambiguous when the length of d is not fixed and publicly known.</p>
<p>12.2. Suggest a way to make Construction 12.4 secure for variable-length associated data. Prove that your construction is secure.</p>
<p>12.3. Show that if you know the salt s of the Poly-UHF construction (Construction 12.9), you can efficiently find a collision.</p>
<p>12.4. Show that if you are allowed to see only the output of Poly-UHF (i.e., the salt remains hidden), on chosen inputs then you can compute the salt.</p>
</div>
</body>

</html>